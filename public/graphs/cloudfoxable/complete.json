{
  "directed": true,
  "multigraph": false,
  "graph": {},
  "nodes": [
    {
      "data": {
        "resource_type": "aws_sns_topic",
        "resource_name": "user_updates",
        "resource_service": "sns",
        "resource_icon": "aws/Architecture-Service-Icons_07312025/Arch_App-Integration/48/Arch_Amazon-Simple-Notification-Service_48.svg",
        "name": "user-updates-topic"
      },
      "id": "aws_sns_topic.user_updates"
    },
    {
      "data": {
        "resource_type": "aws_sns_topic",
        "resource_name": "user_updates-fifo",
        "resource_service": "sns",
        "resource_icon": "aws/Architecture-Service-Icons_07312025/Arch_App-Integration/48/Arch_Amazon-Simple-Notification-Service_48.svg",
        "name": "user-updates-topic.fifo",
        "fifo_topic": true,
        "content_based_deduplication": true
      },
      "id": "aws_sns_topic.user_updates-fifo"
    },
    {
      "data": {
        "resource_type": "aws_sns_topic_policy",
        "resource_name": "user_updates",
        "resource_service": "sns",
        "resource_icon": "aws/Architecture-Service-Icons_07312025/Arch_App-Integration/48/Arch_Amazon-Simple-Notification-Service_48.svg",
        "arn": "${aws_sns_topic.user_updates.arn}",
        "policy": {
          "Version": "2012-10-17",
          "Id": "user_updates",
          "Statement": [
            {
              "Sid": "user_updates",
              "Effect": "Allow",
              "Principal": {
                "AWS": "*"
              },
              "Action": "sns:Publish",
              "Resource": "${aws_sns_topic.user_updates.arn}",
              "Condition": {
                "StringEquals": {
                  "AWS:SourceOwner": 111111111111
                }
              }
            },
            {
              "Sid": "user_updates1",
              "Effect": "Allow",
              "Principal": {
                "AWS": "*"
              },
              "Action": "sns:Subscribe",
              "Resource": "${aws_sns_topic.user_updates.arn}",
              "Condition": {
                "StringEquals": {
                  "AWS:SourceOwner": 111111111111
                }
              }
            }
          ]
        }
      },
      "id": "aws_sns_topic_policy.user_updates"
    },
    {
      "data": {
        "resource_type": "aws_sns_topic",
        "resource_name": "important_updates",
        "resource_service": "sns",
        "resource_icon": "aws/Architecture-Service-Icons_07312025/Arch_App-Integration/48/Arch_Amazon-Simple-Notification-Service_48.svg",
        "name": "public"
      },
      "id": "aws_sns_topic.important_updates"
    },
    {
      "data": {
        "resource_type": "aws_sns_topic_policy",
        "resource_name": "important_updates",
        "resource_service": "sns",
        "resource_icon": "aws/Architecture-Service-Icons_07312025/Arch_App-Integration/48/Arch_Amazon-Simple-Notification-Service_48.svg",
        "arn": "${aws_sns_topic.important_updates.arn}",
        "policy": {
          "Version": "2012-10-17",
          "Id": "public",
          "Statement": [
            {
              "Sid": "public",
              "Effect": "Allow",
              "Principal": {
                "AWS": "*"
              },
              "Action": "sns:Publish",
              "Resource": "${aws_sns_topic.important_updates.arn}"
            }
          ]
        }
      },
      "id": "aws_sns_topic_policy.important_updates"
    },
    {
      "data": {
        "resource_type": "aws_iam_policy",
        "resource_name": "CloudFox-policy-perms",
        "resource_service": "iam",
        "resource_icon": "aws/Architecture-Service-Icons_07312025/Arch_Security-Identity-Compliance/48/Arch_AWS-Identity-and-Access-Management_48.svg",
        "name": "CloudFox-policy-perms",
        "path": "/",
        "description": "All CloudFox permissions",
        "policy": "${jsonencode({\"Version\": \"2012-10-17\", \"Statement\": [{\"Action\": [\"apigateway:GET\", \"apprunner:DescribeService\", \"apprunner:ListServices\", \"cloudformation:DescribeStacks\", \"cloudformation:GetTemplate\", \"cloudformation:ListStacks\", \"cloudtrail:LookupEvents\", \"cloudfront:ListDistributions\", \"dynamodb:ListTables\", \"ec2:DescribeInstanceAttribute\", \"ec2:DescribeInstances\", \"ec2:DescribeNetworkInterfaces\", \"ec2:DescribeRegions\", \"ecr:DescribeImages\", \"ecr:DescribeRepositories\", \"ecs:DescribeTaskDefinition\", \"ecs:ListClusters\", \"ecs:ListTaskDefinitions\", \"ecs:ListTasks\", \"eks:DescribeCluster\", \"eks:DescribeNodegroup\", \"eks:ListClusters\", \"eks:ListNodegroups\", \"elasticache:DescribeCacheClusters\", \"elasticache:DescribeCacheSubnetGroups\", \"elasticache:DescribeReplicationGroups\", \"elasticfilesystem:DescribeFileSystemPolicy\", \"elasticfilesystem:DescribeFileSystems\", \"elasticfilesystem:DescribeMountTargets\", \"eks:DescribeCluster\", \"eks:ListClusters\", \"elasticloadbalancing:DescribeLoadBalancers\", \"elasticloadbalancing:DescribeListeners\", \"fsx:DescribeFileSystems\", \"fsx:DescribeVolumes\", \"glue:ListDevEndpoints\", \"glue:ListJobs\", \"grafana:ListWorkspaces\", \"iam:GetAccountAuthorizationDetails\", \"iam:ListAccessKeys\", \"iam:ListUsers\", \"iam:ListRoles\", \"iam:SimulatePrincipalPolicy\", \"lambda:GetFunctionUrlConfig\", \"lambda:ListFunctions\", \"lightsail:GetContainerServices\", \"lightsail:GetInstances\", \"mq:DescribeBroker\", \"mq:ListBrokers\", \"es:DescribeDomain\", \"es:ListDomainNames\", \"ram:GetResourceShares\", \"ram:ListResources\", \"rds:DescribeDBInstances\", \"redshift:DescribeClusters\", \"route53:ListHostedZones\", \"route53:ListResourceRecordSets\", \"s3:GetBucketPolicyStatus\", \"s3:GetBucketWebsite\", \"s3:ListAllMyBuckets\", \"ssm:DescribeParameters\", \"sagemaker:ListProcessingJobs\", \"sagemaker:DescribeProcessingJob\", \"sagemaker:ListTransformJobs\", \"sagemaker:DescribeTransformJob\", \"sagemaker:ListTrainingJobs\", \"sagemaker:DescribeTrainingJob\", \"sagemaker:ListModels\", \"sagemaker:DescribeModel\", \"secretsmanager:ListSecrets\", \"sns:ListTopics\", \"sqs:ListQueues\", \"tag:GetResources\"], \"Effect\": \"Allow\", \"Resource\": \"*\"}]})}"
      },
      "id": "aws_iam_policy.CloudFox-policy-perms"
    },
    {
      "data": {
        "resource_type": "aws_iam_user",
        "resource_name": "ctf-starting-user",
        "resource_service": "iam",
        "resource_icon": "aws/Architecture-Service-Icons_07312025/Arch_Security-Identity-Compliance/48/Arch_AWS-Identity-and-Access-Management_48.svg",
        "name": "ctf-starting-user",
        "path": "/"
      },
      "id": "aws_iam_user.ctf-starting-user"
    },
    {
      "data": {
        "resource_type": "aws_iam_access_key",
        "resource_name": "ctf-starting-user",
        "resource_service": "iam",
        "resource_icon": "aws/Architecture-Service-Icons_07312025/Arch_Security-Identity-Compliance/48/Arch_AWS-Identity-and-Access-Management_48.svg",
        "user": "${aws_iam_user.ctf-starting-user.name}"
      },
      "id": "aws_iam_access_key.ctf-starting-user"
    },
    {
      "data": {
        "resource_type": "aws_iam_user_policy_attachment",
        "resource_name": "ctf-policy1",
        "resource_service": "iam",
        "resource_icon": "aws/Architecture-Service-Icons_07312025/Arch_Security-Identity-Compliance/48/Arch_AWS-Identity-and-Access-Management_48.svg",
        "user": "${aws_iam_user.ctf-starting-user.name}",
        "policy_arn": "arn:aws:iam::aws:policy/SecurityAudit"
      },
      "id": "aws_iam_user_policy_attachment.ctf-policy1"
    },
    {
      "data": {
        "resource_type": "aws_iam_user_policy_attachment",
        "resource_name": "ctf-policy2",
        "resource_service": "iam",
        "resource_icon": "aws/Architecture-Service-Icons_07312025/Arch_Security-Identity-Compliance/48/Arch_AWS-Identity-and-Access-Management_48.svg",
        "user": "${aws_iam_user.ctf-starting-user.name}",
        "policy_arn": "${aws_iam_policy.CloudFox-policy-perms.arn}"
      },
      "id": "aws_iam_user_policy_attachment.ctf-policy2"
    },
    {
      "data": {
        "resource_type": "aws_s3_bucket",
        "resource_name": "cloudfoxable-bucket1",
        "resource_service": "s3",
        "resource_icon": "aws/Architecture-Service-Icons_07312025/Arch_Storage/48/Arch_Amazon-Simple-Storage-Service_48.svg",
        "bucket": "cloudfoxable-bucket1-${random_string.resource-suffix.result}",
        "force_destroy": true,
        "tags": {
          "Name": "bucket1-${random_string.resource-suffix.result}"
        }
      },
      "id": "aws_s3_bucket.cloudfoxable-bucket1"
    },
    {
      "data": {
        "resource_type": "aws_s3_bucket",
        "resource_name": "cloudfoxable-bucket2",
        "resource_service": "s3",
        "resource_icon": "aws/Architecture-Service-Icons_07312025/Arch_Storage/48/Arch_Amazon-Simple-Storage-Service_48.svg",
        "bucket": "cloudfoxable-bucket2-${random_string.resource-suffix.result}",
        "force_destroy": true,
        "tags": {
          "Name": "bucket2-${random_string.resource-suffix.result}"
        }
      },
      "id": "aws_s3_bucket.cloudfoxable-bucket2"
    },
    {
      "data": {
        "resource_type": "aws_s3_bucket",
        "resource_name": "cloudfoxable-bucket3",
        "resource_service": "s3",
        "resource_icon": "aws/Architecture-Service-Icons_07312025/Arch_Storage/48/Arch_Amazon-Simple-Storage-Service_48.svg",
        "bucket": "cloudfoxable-bucket3-${random_string.resource-suffix.result}",
        "force_destroy": true,
        "tags": {
          "Name": "bucket3-${random_string.resource-suffix.result}"
        }
      },
      "id": "aws_s3_bucket.cloudfoxable-bucket3"
    },
    {
      "data": {
        "resource_type": "random_password",
        "resource_name": "database-secret",
        "resource_service": "terraform/terraform-logo.svg",
        "resource_icon": "terraform/terraform-logo.svg",
        "length": 31,
        "special": true,
        "min_special": 5,
        "override_special": "!#$%^&*()-_=+[]{}<>:?",
        "keepers": {
          "pass_version": 1
        }
      },
      "id": "random_password.database-secret"
    },
    {
      "data": {
        "resource_type": "random_password",
        "resource_name": "app-secret",
        "resource_service": "terraform/terraform-logo.svg",
        "resource_icon": "terraform/terraform-logo.svg",
        "length": 31,
        "special": true,
        "min_special": 5,
        "override_special": "!#$%^&*()-_=+[]{}<>:?",
        "keepers": {
          "pass_version": 1
        }
      },
      "id": "random_password.app-secret"
    },
    {
      "data": {
        "resource_type": "random_string",
        "resource_name": "resource-suffix",
        "resource_service": "terraform/terraform-logo.svg",
        "resource_icon": "terraform/terraform-logo.svg",
        "length": 5,
        "upper": false,
        "special": false
      },
      "id": "random_string.resource-suffix"
    },
    {
      "data": {
        "resource_type": "aws_sqs_queue",
        "resource_name": "queue",
        "resource_service": "sqs",
        "resource_icon": "aws/Architecture-Service-Icons_07312025/Arch_App-Integration/48/Arch_Amazon-Simple-Queue-Service_48.svg",
        "name": "queue",
        "delay_seconds": 90,
        "max_message_size": 2048,
        "message_retention_seconds": 86400,
        "receive_wait_time_seconds": 10,
        "tags": {
          "Environment": "production"
        }
      },
      "id": "aws_sqs_queue.queue"
    },
    {
      "data": {
        "resource_type": "aws_sqs_queue",
        "resource_name": "fifo",
        "resource_service": "sqs",
        "resource_icon": "aws/Architecture-Service-Icons_07312025/Arch_App-Integration/48/Arch_Amazon-Simple-Queue-Service_48.svg",
        "name": "fefifofum.fifo",
        "fifo_queue": true,
        "content_based_deduplication": true
      },
      "id": "aws_sqs_queue.fifo"
    },
    {
      "data": {
        "resource_type": "aws_sqs_queue",
        "resource_name": "process_orders",
        "resource_service": "sqs",
        "resource_icon": "aws/Architecture-Service-Icons_07312025/Arch_App-Integration/48/Arch_Amazon-Simple-Queue-Service_48.svg",
        "name": "process_orders",
        "delay_seconds": 90,
        "max_message_size": 2048,
        "message_retention_seconds": 86400,
        "receive_wait_time_seconds": 10,
        "tags": {
          "Environment": "production"
        }
      },
      "id": "aws_sqs_queue.process_orders"
    },
    {
      "data": {
        "resource_type": "aws_sqs_queue_policy",
        "resource_name": "public_queue_policy",
        "resource_service": "sqs",
        "resource_icon": "aws/Architecture-Service-Icons_07312025/Arch_App-Integration/48/Arch_Amazon-Simple-Queue-Service_48.svg",
        "queue_url": "${aws_sqs_queue.process_orders.id}",
        "policy": {
          "Version": "2012-10-17",
          "Id": "terraform_queue",
          "Statement": [
            {
              "Sid": "terraform_queue",
              "Effect": "Allow",
              "Principal": {
                "AWS": "*"
              },
              "Action": "sqs:SendMessage",
              "Resource": "${aws_sqs_queue.process_orders.arn}"
            }
          ]
        }
      },
      "id": "aws_sqs_queue_policy.public_queue_policy"
    },
    {
      "data": {
        "resource_type": "aws_vpc",
        "resource_name": "cloudfox",
        "resource_service": "vpc",
        "resource_icon": "aws/Architecture-Group-Icons_07312025/Virtual-private-cloud-VPC_32.svg",
        "cidr_block": "10.0.0.0/16",
        "enable_dns_support": "true",
        "enable_dns_hostnames": "true",
        "instance_tenancy": "default",
        "tags": {
          "Name": "cloudfox"
        }
      },
      "id": "aws_vpc.cloudfox"
    },
    {
      "data": {
        "resource_type": "aws_internet_gateway",
        "resource_name": "cloudfox-igw",
        "resource_service": "vpc",
        "resource_icon": "aws/Resource-Icons_07312025/Res_Networking-Content-Delivery/Res_Amazon-VPC_Internet-Gateway_48.svg",
        "vpc_id": "${aws_vpc.cloudfox.id}",
        "tags": {
          "Name": "cloudfox Internet Gateway"
        }
      },
      "id": "aws_internet_gateway.cloudfox-igw"
    },
    {
      "data": {
        "resource_type": "aws_route_table",
        "resource_name": "cloudfox-public",
        "resource_service": "route",
        "resource_icon": "aws/Architecture-Service-Icons_07312025/Arch_Networking-Content-Delivery/48/Arch_Amazon-Route-53_48.svg",
        "vpc_id": "${aws_vpc.cloudfox.id}",
        "route": [
          {
            "cidr_block": "0.0.0.0/0",
            "gateway_id": "${aws_internet_gateway.cloudfox-igw.id}"
          }
        ],
        "tags": {
          "Name": "cloudfox Public Route Table"
        }
      },
      "id": "aws_route_table.cloudfox-public"
    },
    {
      "data": {
        "resource_type": "aws_subnet",
        "resource_name": "cloudfox-operational",
        "resource_service": "subnet",
        "resource_icon": "aws/Category-Icons_07312025/Arch-Category_48/Arch-Category_Networking-Content-Delivery_48.svg",
        "count": "${length(data.aws_availability_zones.available.names)}",
        "vpc_id": "${aws_vpc.cloudfox.id}",
        "cidr_block": "${cidrsubnet(\"10.0.0.0/16\", 8, count.index)}",
        "map_public_ip_on_launch": "true",
        "availability_zone": "${element(data.aws_availability_zones.available.names, count.index)}",
        "tags": {
          "Name": "cloudfox Operational Subnet ${count.index}"
        }
      },
      "id": "aws_subnet.cloudfox-operational"
    },
    {
      "data": {
        "resource_type": "aws_route_table_association",
        "resource_name": "cloudfox-operational",
        "resource_service": "route",
        "resource_icon": "aws/Architecture-Service-Icons_07312025/Arch_Networking-Content-Delivery/48/Arch_Amazon-Route-53_48.svg",
        "count": "${length(data.aws_availability_zones.available.names)}",
        "subnet_id": "${element(aws_subnet.cloudfox-operational.*.id, count.index)}",
        "route_table_id": "${aws_route_table.cloudfox-public.id}"
      },
      "id": "aws_route_table_association.cloudfox-operational"
    },
    {
      "data": {
        "resource_type": "aws_ssm_parameter",
        "resource_name": "secret1",
        "resource_service": "ssm",
        "resource_icon": "aws/Architecture-Service-Icons_07312025/Arch_Management-Governance/48/Arch_AWS-Systems-Manager_48.svg",
        "name": "/production/CICD/root",
        "type": "SecureString",
        "value": "FLAG{root::ExploitingRoleTrustsIsFun}"
      },
      "id": "aws_ssm_parameter.secret1"
    },
    {
      "data": {
        "resource_type": "aws_ssm_parameter",
        "resource_name": "secret2",
        "resource_service": "ssm",
        "resource_icon": "aws/Architecture-Service-Icons_07312025/Arch_Management-Governance/48/Arch_AWS-Systems-Manager_48.svg",
        "name": "/production/database/password",
        "type": "SecureString",
        "value": "USMNT2023"
      },
      "id": "aws_ssm_parameter.secret2"
    },
    {
      "data": {
        "resource_type": "aws_ssm_parameter",
        "resource_name": "secret3",
        "resource_service": "ssm",
        "resource_icon": "aws/Architecture-Service-Icons_07312025/Arch_Management-Governance/48/Arch_AWS-Systems-Manager_48.svg",
        "name": "/staging/database/user",
        "type": "String",
        "value": "admin"
      },
      "id": "aws_ssm_parameter.secret3"
    },
    {
      "data": {
        "resource_type": "aws_ssm_parameter",
        "resource_name": "secret4",
        "resource_service": "ssm",
        "resource_icon": "aws/Architecture-Service-Icons_07312025/Arch_Management-Governance/48/Arch_AWS-Systems-Manager_48.svg",
        "name": "/staging/database/password",
        "type": "String",
        "value": "USMNT2023"
      },
      "id": "aws_ssm_parameter.secret4"
    },
    {
      "data": {
        "resource_type": "aws_ssm_parameter",
        "resource_name": "flag",
        "resource_service": "ssm",
        "resource_icon": "aws/Architecture-Service-Icons_07312025/Arch_Management-Governance/48/Arch_AWS-Systems-Manager_48.svg",
        "name": "/cloudfoxable/flag/its-a-secret",
        "type": "SecureString",
        "value": "FLAG{ItsASecret::IsASecretASecretIfTooManyPeopleHaveAccessToIt?}"
      },
      "id": "aws_ssm_parameter.flag"
    },
    {
      "data": {
        "resource_type": "aws_iam_policy",
        "resource_name": "its-a-secret-policy",
        "resource_service": "iam",
        "resource_icon": "aws/Architecture-Service-Icons_07312025/Arch_Security-Identity-Compliance/48/Arch_AWS-Identity-and-Access-Management_48.svg",
        "name": "its-a-secret-policy",
        "path": "/",
        "description": "policy that only allows access to the its-a-secret flag",
        "policy": "${jsonencode({\"Version\": \"2012-10-17\", \"Statement\": [{\"Effect\": \"Allow\", \"Action\": [\"ssm:GetParameter\"], \"Resource\": [\"${aws_ssm_parameter.flag.arn}\"]}]})}"
      },
      "id": "aws_iam_policy.its-a-secret-policy"
    },
    {
      "data": {
        "resource_type": "aws_iam_user_policy_attachment",
        "resource_name": "its-a-secret-policy-attachment",
        "resource_service": "iam",
        "resource_icon": "aws/Architecture-Service-Icons_07312025/Arch_Security-Identity-Compliance/48/Arch_AWS-Identity-and-Access-Management_48.svg",
        "user": "${module.enabled.ctf_starting_user_name}",
        "policy_arn": "${aws_iam_policy.its-a-secret-policy.arn}"
      },
      "id": "aws_iam_user_policy_attachment.its-a-secret-policy-attachment"
    },
    {
      "data": {
        "resource_type": "aws_ssm_parameter",
        "resource_name": "flag2",
        "resource_service": "ssm",
        "resource_icon": "aws/Architecture-Service-Icons_07312025/Arch_Management-Governance/48/Arch_AWS-Systems-Manager_48.svg",
        "name": "/cloudfoxable/flag/its-another-secret",
        "type": "SecureString",
        "value": "FLAG{ItsAnotherSecret::ThereWillBeALotOfAssumingRolesInThisCTF}"
      },
      "id": "aws_ssm_parameter.flag2"
    },
    {
      "data": {
        "resource_type": "aws_iam_policy",
        "resource_name": "its-another-secret-policy",
        "resource_service": "iam",
        "resource_icon": "aws/Architecture-Service-Icons_07312025/Arch_Security-Identity-Compliance/48/Arch_AWS-Identity-and-Access-Management_48.svg",
        "name": "its-another-secret-policy",
        "path": "/",
        "description": "policy that only allows access to the its-another-secret flag",
        "policy": "${jsonencode({\"Version\": \"2012-10-17\", \"Statement\": [{\"Effect\": \"Allow\", \"Action\": [\"ssm:GetParameter\"], \"Resource\": [\"${aws_ssm_parameter.flag2.arn}\"]}]})}"
      },
      "id": "aws_iam_policy.its-another-secret-policy"
    },
    {
      "data": {
        "resource_type": "aws_iam_role",
        "resource_name": "its-another-secret-role",
        "resource_service": "iam",
        "resource_icon": "aws/Architecture-Service-Icons_07312025/Arch_Security-Identity-Compliance/48/Arch_AWS-Identity-and-Access-Management_48.svg",
        "name": "Ertz",
        "assume_role_policy": "${jsonencode({\"Version\": \"2012-10-17\", \"Statement\": [{\"Effect\": \"Allow\", \"Principal\": {\"AWS\": [\"arn:aws:iam:::user/${module.enabled.ctf_starting_user_name}\"]}, \"Action\": [\"sts:AssumeRole\"]}]})}"
      },
      "id": "aws_iam_role.its-another-secret-role"
    },
    {
      "data": {
        "resource_type": "aws_iam_role_policy_attachment",
        "resource_name": "its-a-secret-policy-attachment",
        "resource_service": "iam",
        "resource_icon": "aws/Architecture-Service-Icons_07312025/Arch_Security-Identity-Compliance/48/Arch_AWS-Identity-and-Access-Management_48.svg",
        "role": "${aws_iam_role.its-another-secret-role.name}",
        "policy_arn": "${aws_iam_policy.its-another-secret-policy.arn}"
      },
      "id": "aws_iam_role_policy_attachment.its-a-secret-policy-attachment"
    },
    {
      "data": {
        "resource_type": "aws_secretsmanager_secret",
        "resource_name": "database-secret",
        "resource_service": "secretsmanager",
        "resource_icon": "aws/Architecture-Service-Icons_07312025/Arch_Security-Identity-Compliance/48/Arch_AWS-Secrets-Manager_48.svg",
        "name": "database-secret",
        "recovery_window_in_days": 0,
        "tags": {
          "Name": "Database Secret"
        }
      },
      "id": "aws_secretsmanager_secret.database-secret"
    },
    {
      "data": {
        "resource_type": "aws_secretsmanager_secret_version",
        "resource_name": "database-secret",
        "resource_service": "secretsmanager",
        "resource_icon": "aws/Architecture-Service-Icons_07312025/Arch_Security-Identity-Compliance/48/Arch_AWS-Secrets-Manager_48.svg",
        "secret_id": "${aws_secretsmanager_secret.database-secret.id}",
        "secret_string": "${random_password.database-secret.result}"
      },
      "id": "aws_secretsmanager_secret_version.database-secret"
    },
    {
      "data": {
        "resource_type": "aws_secretsmanager_secret",
        "resource_name": "corporate-domain-admin-password",
        "resource_service": "secretsmanager",
        "resource_icon": "aws/Architecture-Service-Icons_07312025/Arch_Security-Identity-Compliance/48/Arch_AWS-Secrets-Manager_48.svg",
        "name": "DomainAdministrator-Credentials",
        "recovery_window_in_days": 0,
        "tags": {
          "Name": "Corporate Domain Admin Password"
        }
      },
      "id": "aws_secretsmanager_secret.corporate-domain-admin-password"
    },
    {
      "data": {
        "resource_type": "aws_secretsmanager_secret_version",
        "resource_name": "corporate-domain-admin-password",
        "resource_service": "secretsmanager",
        "resource_icon": "aws/Architecture-Service-Icons_07312025/Arch_Security-Identity-Compliance/48/Arch_AWS-Secrets-Manager_48.svg",
        "secret_id": "${aws_secretsmanager_secret.corporate-domain-admin-password.id}",
        "secret_string": "FLAG{backwards::IfYouFindSomethingInterstingFindWhoHasAccessToIt}"
      },
      "id": "aws_secretsmanager_secret_version.corporate-domain-admin-password"
    },
    {
      "data": {
        "resource_type": "aws_iam_policy",
        "resource_name": "corporate-domain-admin-password-policy",
        "resource_service": "iam",
        "resource_icon": "aws/Architecture-Service-Icons_07312025/Arch_Security-Identity-Compliance/48/Arch_AWS-Identity-and-Access-Management_48.svg",
        "name": "corporate-domain-admin-password-policy",
        "path": "/",
        "description": "policy that only allows access to the corporate-domain-admin-password secret",
        "policy": "${jsonencode({\"Version\": \"2012-10-17\", \"Statement\": [{\"Effect\": \"Allow\", \"Action\": [\"secretsmanager:GetSecretValue\"], \"Resource\": [\"${aws_secretsmanager_secret.corporate-domain-admin-password.arn}\"]}]})}"
      },
      "id": "aws_iam_policy.corporate-domain-admin-password-policy"
    },
    {
      "data": {
        "resource_type": "aws_iam_role",
        "resource_name": "Alexander-Arnold",
        "resource_service": "iam",
        "resource_icon": "aws/Architecture-Service-Icons_07312025/Arch_Security-Identity-Compliance/48/Arch_AWS-Identity-and-Access-Management_48.svg",
        "name": "Alexander-Arnold",
        "assume_role_policy": "${jsonencode({\"Version\": \"2012-10-17\", \"Statement\": [{\"Effect\": \"Allow\", \"Principal\": {\"AWS\": [\"arn:aws:iam:::user/${module.enabled.ctf_starting_user_name}\"]}, \"Action\": [\"sts:AssumeRole\"]}]})}"
      },
      "id": "aws_iam_role.Alexander-Arnold"
    },
    {
      "data": {
        "resource_type": "aws_iam_role_policy_attachment",
        "resource_name": "corporate-domain-admin-password-policy-attachment",
        "resource_service": "iam",
        "resource_icon": "aws/Architecture-Service-Icons_07312025/Arch_Security-Identity-Compliance/48/Arch_AWS-Identity-and-Access-Management_48.svg",
        "role": "${aws_iam_role.Alexander-Arnold.name}",
        "policy_arn": "${aws_iam_policy.corporate-domain-admin-password-policy.arn}"
      },
      "id": "aws_iam_role_policy_attachment.corporate-domain-admin-password-policy-attachment"
    },
    {
      "data": {
        "resource_type": "aws_iam_role",
        "resource_name": "execution",
        "resource_service": "iam",
        "resource_icon": "aws/Architecture-Service-Icons_07312025/Arch_Security-Identity-Compliance/48/Arch_AWS-Identity-and-Access-Management_48.svg",
        "name": "viniciusjr",
        "assume_role_policy": "${jsonencode({\"Version\": \"2012-10-17\", \"Statement\": [{\"Effect\": \"Allow\", \"Principal\": {\"AWS\": [\"${module.enabled.ctf_starting_user_arn}\"]}, \"Action\": [\"sts:AssumeRole\"]}]})}"
      },
      "id": "aws_iam_role.execution"
    },
    {
      "data": {
        "resource_type": "aws_iam_role_policy_attachment",
        "resource_name": "execution",
        "resource_service": "iam",
        "resource_icon": "aws/Architecture-Service-Icons_07312025/Arch_Security-Identity-Compliance/48/Arch_AWS-Identity-and-Access-Management_48.svg",
        "role": "${aws_iam_role.execution.name}",
        "policy_arn": "arn:aws:iam::aws:policy/AmazonSNSReadOnlyAccess"
      },
      "id": "aws_iam_role_policy_attachment.execution"
    },
    {
      "data": {
        "resource_type": "aws_iam_role",
        "resource_name": "executioner-role",
        "resource_service": "iam",
        "resource_icon": "aws/Architecture-Service-Icons_07312025/Arch_Security-Identity-Compliance/48/Arch_AWS-Identity-and-Access-Management_48.svg",
        "name": "ream",
        "assume_role_policy": "${jsonencode({\"Version\": \"2012-10-17\", \"Statement\": [{\"Action\": \"sts:AssumeRole\", \"Effect\": \"Allow\", \"Sid\": \"\", \"Principal\": {\"Service\": \"lambda.amazonaws.com\"}}]})}",
        "managed_policy_arns": [
          "${aws_iam_policy.executioner-policy.arn}",
          "${aws_iam_policy.executioner-secret-policy.arn}"
        ]
      },
      "id": "aws_iam_role.executioner-role"
    },
    {
      "data": {
        "resource_type": "aws_iam_policy",
        "resource_name": "executioner-policy",
        "resource_service": "iam",
        "resource_icon": "aws/Architecture-Service-Icons_07312025/Arch_Security-Identity-Compliance/48/Arch_AWS-Identity-and-Access-Management_48.svg",
        "name": "executioner-policy",
        "path": "/",
        "description": "Low priv policy used by lambdas",
        "policy": "${jsonencode({\"Version\": \"2012-10-17\", \"Statement\": [{\"Action\": [\"logs:CreateLogGroup\", \"logs:CreateLogStream\", \"logs:PutLogEvents\", \"sns:Subscribe\", \"sns:ListSubscriptionsByTopic\", \"sns:ListTopics\", \"sns:ListSubscriptions\", \"sns:GetTopicAttributes\", \"sns:Receive\", \"ssm:DescribeParameters\"], \"Effect\": \"Allow\", \"Resource\": \"*\"}]})}"
      },
      "id": "aws_iam_policy.executioner-policy"
    },
    {
      "data": {
        "resource_type": "aws_iam_policy",
        "resource_name": "executioner-secret-policy",
        "resource_service": "iam",
        "resource_icon": "aws/Architecture-Service-Icons_07312025/Arch_Security-Identity-Compliance/48/Arch_AWS-Identity-and-Access-Management_48.svg",
        "name": "executioner-secret-policy",
        "path": "/",
        "description": "",
        "policy": "${jsonencode({\"Version\": \"2012-10-17\", \"Statement\": [{\"Effect\": \"Allow\", \"Action\": \"ssm:GetParameter\", \"Resource\": \"${aws_ssm_parameter.executioner-secret.arn}\"}]})}"
      },
      "id": "aws_iam_policy.executioner-secret-policy"
    },
    {
      "data": {
        "resource_type": "aws_lambda_function",
        "resource_name": "executioner",
        "resource_service": "lambda",
        "resource_icon": "aws/Architecture-Service-Icons_07312025/Arch_Compute/48/Arch_AWS-Lambda_48.svg",
        "filename": "challenges/The topic is execution/data/lambda/lambda_function.zip",
        "function_name": "executioner",
        "role": "${aws_iam_role.executioner-role.arn}",
        "handler": "index.handler",
        "source_code_hash": null,
        "runtime": "nodejs18.x"
      },
      "id": "aws_lambda_function.executioner"
    },
    {
      "data": {
        "resource_type": "aws_sns_topic",
        "resource_name": "test_sns",
        "resource_service": "sns",
        "resource_icon": "aws/Architecture-Service-Icons_07312025/Arch_App-Integration/48/Arch_Amazon-Simple-Notification-Service_48.svg",
        "name": "executioner"
      },
      "id": "aws_sns_topic.test_sns"
    },
    {
      "data": {
        "resource_type": "aws_sns_topic_policy",
        "resource_name": "executioner",
        "resource_service": "sns",
        "resource_icon": "aws/Architecture-Service-Icons_07312025/Arch_App-Integration/48/Arch_Amazon-Simple-Notification-Service_48.svg",
        "arn": "${aws_sns_topic.test_sns.arn}",
        "policy": {
          "Version": "2012-10-17",
          "Id": "snspolicy",
          "Statement": [
            {
              "Sid": "First",
              "Effect": "Allow",
              "Principal": "*",
              "Action": [
                "sns:Subscribe",
                "sns:Publish"
              ],
              "Resource": "${aws_sns_topic.test_sns.arn}",
              "Condition": {
                "StringEquals": {
                  "aws:PrincipalAccount": null
                }
              }
            }
          ]
        }
      },
      "id": "aws_sns_topic_policy.executioner"
    },
    {
      "data": {
        "resource_type": "aws_sns_topic_subscription",
        "resource_name": "test_sns_subscription",
        "resource_service": "sns",
        "resource_icon": "aws/Architecture-Service-Icons_07312025/Arch_App-Integration/48/Arch_Amazon-Simple-Notification-Service_48.svg",
        "topic_arn": "${aws_sns_topic.test_sns.arn}",
        "protocol": "lambda",
        "endpoint": "${aws_lambda_function.executioner.arn}"
      },
      "id": "aws_sns_topic_subscription.test_sns_subscription"
    },
    {
      "data": {
        "resource_type": "aws_lambda_permission",
        "resource_name": "allow_sns",
        "resource_service": "lambda",
        "resource_icon": "aws/Architecture-Service-Icons_07312025/Arch_Compute/48/Arch_AWS-Lambda_48.svg",
        "statement_id": "AllowExecutionFromSNS",
        "action": "lambda:InvokeFunction",
        "function_name": "${aws_lambda_function.executioner.function_name}",
        "principal": "sns.amazonaws.com",
        "source_arn": "${aws_sns_topic.test_sns.arn}"
      },
      "id": "aws_lambda_permission.allow_sns"
    },
    {
      "data": {
        "resource_type": "aws_ssm_parameter",
        "resource_name": "executioner-secret",
        "resource_service": "ssm",
        "resource_icon": "aws/Architecture-Service-Icons_07312025/Arch_Management-Governance/48/Arch_AWS-Systems-Manager_48.svg",
        "name": "/cloudfoxable/flag/executioner",
        "type": "SecureString",
        "value": "FLAG{theTopicIsExecution::WeJustPoppedALambdaByInjectingAnEvilSNSmessage}"
      },
      "id": "aws_ssm_parameter.executioner-secret"
    },
    {
      "data": {
        "resource_type": "aws_iam_role",
        "resource_name": "event_bridge_sns_rce_role",
        "resource_service": "iam",
        "resource_icon": "aws/Architecture-Service-Icons_07312025/Arch_Security-Identity-Compliance/48/Arch_AWS-Identity-and-Access-Management_48.svg",
        "name": "event_bridge_sns_rce_role",
        "assume_role_policy": "${jsonencode({\"Version\": \"2012-10-17\", \"Statement\": [{\"Effect\": \"Allow\", \"Principal\": {\"Service\": \"scheduler.amazonaws.com\"}, \"Action\": \"sts:AssumeRole\"}]})}",
        "tags": {
          "Name": "event_bridge_sns_rce_role",
          "Environment": "cloudfox"
        }
      },
      "id": "aws_iam_role.event_bridge_sns_rce_role"
    },
    {
      "data": {
        "resource_type": "aws_iam_policy",
        "resource_name": "event_bridge_sns_rce_policy",
        "resource_service": "iam",
        "resource_icon": "aws/Architecture-Service-Icons_07312025/Arch_Security-Identity-Compliance/48/Arch_AWS-Identity-and-Access-Management_48.svg",
        "name": "event_bridge_sns_rce_policy",
        "path": "/",
        "description": "Low priv policy used by lambdas",
        "policy": "${jsonencode({\"Version\": \"2012-10-17\", \"Statement\": [{\"Action\": [\"logs:CreateLogGroup\", \"logs:CreateLogStream\", \"logs:PutLogEvents\", \"sns:Subscribe\", \"sns:ListSubscriptionsByTopic\", \"sns:ListTopics\", \"sns:ListSubscriptions\", \"sns:GetTopicAttributes\", \"sns:Receive\", \"sns:Publish\"], \"Effect\": \"Allow\", \"Resource\": \"${aws_sns_topic.test_sns.arn}\"}]})}"
      },
      "id": "aws_iam_policy.event_bridge_sns_rce_policy"
    },
    {
      "data": {
        "resource_type": "aws_iam_role_policy_attachment",
        "resource_name": "event_bridge_sns_rce_policy_attachment",
        "resource_service": "iam",
        "resource_icon": "aws/Architecture-Service-Icons_07312025/Arch_Security-Identity-Compliance/48/Arch_AWS-Identity-and-Access-Management_48.svg",
        "role": "${aws_iam_role.event_bridge_sns_rce_role.name}",
        "policy_arn": "${aws_iam_policy.event_bridge_sns_rce_policy.arn}"
      },
      "id": "aws_iam_role_policy_attachment.event_bridge_sns_rce_policy_attachment"
    },
    {
      "data": {
        "resource_type": "aws_scheduler_schedule",
        "resource_name": "eventbridge_sns_rce",
        "resource_service": "eventbridge",
        "resource_icon": "aws/Resource-Icons_07312025/Res_Application-Integration/Res_Amazon-EventBridge_Scheduler_48.svg",
        "name": "eventbridge_sns_rce",
        "description": "sends sns message to topic",
        "flexible_time_window": [
          {
            "mode": "OFF"
          }
        ],
        "schedule_expression": "rate(1 minutes)",
        "target": [
          {
            "arn": "${aws_sns_topic.test_sns.arn}",
            "role_arn": "${aws_iam_role.event_bridge_sns_rce_role.arn}",
            "input": "echo \"hello world\" > /tmp/hello.txt"
          }
        ]
      },
      "id": "aws_scheduler_schedule.eventbridge_sns_rce"
    },
    {
      "data": {
        "resource_type": "aws_iam_role",
        "resource_name": "root-role",
        "resource_service": "iam",
        "resource_icon": "aws/Architecture-Service-Icons_07312025/Arch_Security-Identity-Compliance/48/Arch_AWS-Identity-and-Access-Management_48.svg",
        "name": "Kent",
        "assume_role_policy": "${jsonencode({\"Version\": \"2012-10-17\", \"Statement\": [{\"Effect\": \"Allow\", \"Principal\": {\"AWS\": [\"${module.enabled.ctf_starting_user_arn}\"]}, \"Action\": [\"sts:AssumeRole\"]}]})}"
      },
      "id": "aws_iam_role.root-role"
    },
    {
      "data": {
        "resource_type": "aws_iam_policy",
        "resource_name": "root-policy1",
        "resource_service": "iam",
        "resource_icon": "aws/Architecture-Service-Icons_07312025/Arch_Security-Identity-Compliance/48/Arch_AWS-Identity-and-Access-Management_48.svg",
        "name": "root-policy1",
        "path": "/",
        "description": "",
        "policy": "${jsonencode({\"Version\": \"2012-10-17\", \"Statement\": [{\"Action\": [\"sts:AssumeRole\"], \"Effect\": \"Allow\", \"Resource\": \"*\"}]})}"
      },
      "id": "aws_iam_policy.root-policy1"
    },
    {
      "data": {
        "resource_type": "aws_iam_role_policy_attachment",
        "resource_name": "root-policy1-role-attach-policy",
        "resource_service": "iam",
        "resource_icon": "aws/Architecture-Service-Icons_07312025/Arch_Security-Identity-Compliance/48/Arch_AWS-Identity-and-Access-Management_48.svg",
        "role": "${aws_iam_role.root-role.name}",
        "policy_arn": "${aws_iam_policy.root-policy1.arn}"
      },
      "id": "aws_iam_role_policy_attachment.root-policy1-role-attach-policy"
    },
    {
      "data": {
        "resource_type": "aws_iam_role",
        "resource_name": "privesc-AssumeRole-intermediate-role",
        "resource_service": "iam",
        "resource_icon": "aws/Architecture-Service-Icons_07312025/Arch_Security-Identity-Compliance/48/Arch_AWS-Identity-and-Access-Management_48.svg",
        "name": "Beard",
        "assume_role_policy": "${jsonencode({\"Version\": \"2012-10-17\", \"Statement\": [{\"Action\": \"sts:AssumeRole\", \"Effect\": \"Allow\", \"Sid\": \"\", \"Principal\": {\"AWS\": \"${format(\"arn:aws:iam::%s:root\", None)}\"}}]})}"
      },
      "id": "aws_iam_role.privesc-AssumeRole-intermediate-role"
    },
    {
      "data": {
        "resource_type": "aws_iam_role",
        "resource_name": "privesc-AssumeRole-ending-role",
        "resource_service": "iam",
        "resource_icon": "aws/Architecture-Service-Icons_07312025/Arch_Security-Identity-Compliance/48/Arch_AWS-Identity-and-Access-Management_48.svg",
        "name": "Lasso",
        "assume_role_policy": "${jsonencode({\"Version\": \"2012-10-17\", \"Statement\": [{\"Action\": \"sts:AssumeRole\", \"Effect\": \"Allow\", \"Sid\": \"\", \"Principal\": {\"AWS\": \"${aws_iam_role.privesc-AssumeRole-intermediate-role.arn}\"}}]})}"
      },
      "id": "aws_iam_role.privesc-AssumeRole-ending-role"
    },
    {
      "data": {
        "resource_type": "aws_iam_policy",
        "resource_name": "privesc-AssumeRole-high-priv-policy",
        "resource_service": "iam",
        "resource_icon": "aws/Architecture-Service-Icons_07312025/Arch_Security-Identity-Compliance/48/Arch_AWS-Identity-and-Access-Management_48.svg",
        "name": "important-policy",
        "path": "/",
        "description": "",
        "policy": "${jsonencode({\"Version\": \"2012-10-17\", \"Statement\": [{\"Effect\": \"Allow\", \"Action\": \"ssm:GetParameter\", \"Resource\": \"${aws_ssm_parameter.secret1.arn}\"}]})}"
      },
      "id": "aws_iam_policy.privesc-AssumeRole-high-priv-policy"
    },
    {
      "data": {
        "resource_type": "aws_iam_role_policy_attachment",
        "resource_name": "privesc-AssumeRole-high-priv-policy-role-attach-policy",
        "resource_service": "iam",
        "resource_icon": "aws/Architecture-Service-Icons_07312025/Arch_Security-Identity-Compliance/48/Arch_AWS-Identity-and-Access-Management_48.svg",
        "role": "${aws_iam_role.privesc-AssumeRole-ending-role.name}",
        "policy_arn": "${aws_iam_policy.privesc-AssumeRole-high-priv-policy.arn}"
      },
      "id": "aws_iam_role_policy_attachment.privesc-AssumeRole-high-priv-policy-role-attach-policy"
    },
    {
      "data": {
        "resource_type": "aws_security_group",
        "resource_name": "instance_sg",
        "resource_service": "security",
        "resource_icon": "aws/Architecture-Service-Icons_07312025/Arch_Security-Identity-Compliance/48/Arch_AWS-Security-Hub_48.svg",
        "name": "instance_sg",
        "description": "Security group for EC2 instance",
        "ingress": [
          {
            "from_port": 22,
            "to_port": 22,
            "protocol": "tcp",
            "cidr_blocks": [
              "0.0.0.0/0"
            ]
          }
        ],
        "egress": [
          {
            "from_port": 0,
            "to_port": 0,
            "protocol": -1,
            "cidr_blocks": [
              "0.0.0.0/0"
            ]
          }
        ]
      },
      "id": "aws_security_group.instance_sg"
    },
    {
      "data": {
        "resource_type": "aws_secretsmanager_secret",
        "resource_name": "double_tap_flag_secret",
        "resource_service": "secretsmanager",
        "resource_icon": "aws/Architecture-Service-Icons_07312025/Arch_Security-Identity-Compliance/48/Arch_AWS-Secrets-Manager_48.svg",
        "name": "DT_flag",
        "recovery_window_in_days": 0
      },
      "id": "aws_secretsmanager_secret.double_tap_flag_secret"
    },
    {
      "data": {
        "resource_type": "aws_secretsmanager_secret_version",
        "resource_name": "double_tap_flag_secret_version",
        "resource_service": "secretsmanager",
        "resource_icon": "aws/Architecture-Service-Icons_07312025/Arch_Security-Identity-Compliance/48/Arch_AWS-Secrets-Manager_48.svg",
        "secret_id": "${aws_secretsmanager_secret.double_tap_flag_secret.id}",
        "secret_string": "FLAG{double_tap::ExploitChainsAreFun}"
      },
      "id": "aws_secretsmanager_secret_version.double_tap_flag_secret_version"
    },
    {
      "data": {
        "resource_type": "aws_iam_policy",
        "resource_name": "double_tap_secret_policy",
        "resource_service": "iam",
        "resource_icon": "aws/Architecture-Service-Icons_07312025/Arch_Security-Identity-Compliance/48/Arch_AWS-Identity-and-Access-Management_48.svg",
        "name": "double_tap_secret_policy",
        "policy": "${jsonencode({\"Version\": \"2012-10-17\", \"Statement\": [{\"Action\": [\"secretsmanager:GetSecretValue\", \"secretsmanager:DescribeSecret\", \"secretsmanager:ListSecretVersionIds\", \"secretsmanager:ListSecrets\"], \"Effect\": \"Allow\", \"Resource\": [\"${aws_secretsmanager_secret.double_tap_flag_secret.arn}\"]}]})}"
      },
      "id": "aws_iam_policy.double_tap_secret_policy"
    },
    {
      "data": {
        "resource_type": "aws_iam_role",
        "resource_name": "double_tap_secret",
        "resource_service": "iam",
        "resource_icon": "aws/Architecture-Service-Icons_07312025/Arch_Security-Identity-Compliance/48/Arch_AWS-Identity-and-Access-Management_48.svg",
        "name": "double_tap_secret",
        "assume_role_policy": "${jsonencode({\"Version\": \"2012-10-17\", \"Statement\": [{\"Effect\": \"Allow\", \"Principal\": {\"Service\": \"ec2.amazonaws.com\"}, \"Action\": \"sts:AssumeRole\"}]})}"
      },
      "id": "aws_iam_role.double_tap_secret"
    },
    {
      "data": {
        "resource_type": "aws_iam_role_policy_attachment",
        "resource_name": "double_tap_secret_policy",
        "resource_service": "iam",
        "resource_icon": "aws/Architecture-Service-Icons_07312025/Arch_Security-Identity-Compliance/48/Arch_AWS-Identity-and-Access-Management_48.svg",
        "policy_arn": "${aws_iam_policy.double_tap_secret_policy.arn}",
        "role": "${aws_iam_role.double_tap_secret.name}"
      },
      "id": "aws_iam_role_policy_attachment.double_tap_secret_policy"
    },
    {
      "data": {
        "resource_type": "aws_iam_role_policy_attachment",
        "resource_name": "ssm_ec2_secret_policy_attachment",
        "resource_service": "iam",
        "resource_icon": "aws/Architecture-Service-Icons_07312025/Arch_Security-Identity-Compliance/48/Arch_AWS-Identity-and-Access-Management_48.svg",
        "policy_arn": "arn:aws:iam::aws:policy/AmazonSSMManagedInstanceCore",
        "role": "${aws_iam_role.double_tap_secret.name}"
      },
      "id": "aws_iam_role_policy_attachment.ssm_ec2_secret_policy_attachment"
    },
    {
      "data": {
        "resource_type": "aws_iam_policy",
        "resource_name": "double_tap_deny_ssm_parameter_access",
        "resource_service": "iam",
        "resource_icon": "aws/Architecture-Service-Icons_07312025/Arch_Security-Identity-Compliance/48/Arch_AWS-Identity-and-Access-Management_48.svg",
        "name": "double_tap_deny_ssm_parameter_access-bastion",
        "path": "/",
        "description": "IAM policy to deny access to certain SSM permissions",
        "policy": "${jsonencode({\"Version\": \"2012-10-17\", \"Statement\": [{\"Effect\": \"Deny\", \"Action\": [\"ssm:GetParameter\", \"ssm:GetParameters\"], \"Resource\": \"*\"}]})}"
      },
      "id": "aws_iam_policy.double_tap_deny_ssm_parameter_access"
    },
    {
      "data": {
        "resource_type": "aws_iam_role_policy_attachment",
        "resource_name": "double-tap-deny",
        "resource_service": "iam",
        "resource_icon": "aws/Architecture-Service-Icons_07312025/Arch_Security-Identity-Compliance/48/Arch_AWS-Identity-and-Access-Management_48.svg",
        "role": "${aws_iam_role.double_tap_secret.name}",
        "policy_arn": "${aws_iam_policy.double_tap_deny_ssm_parameter_access.arn}"
      },
      "id": "aws_iam_role_policy_attachment.double-tap-deny"
    },
    {
      "data": {
        "resource_type": "aws_instance",
        "resource_name": "flag",
        "resource_service": "ec2",
        "resource_icon": "aws/Architecture-Service-Icons_07312025/Arch_Compute/48/Arch_Amazon-EC2_48.svg",
        "ami": null,
        "instance_type": "t3a.nano",
        "iam_instance_profile": "${aws_iam_instance_profile.double_tap_secret_profile.name}",
        "security_groups": [
          "instance_sg"
        ],
        "tags": {
          "double_tap2": "true",
          "Name": "double_tap"
        }
      },
      "id": "aws_instance.flag"
    },
    {
      "data": {
        "resource_type": "aws_iam_instance_profile",
        "resource_name": "double_tap_secret_profile",
        "resource_service": "iam",
        "resource_icon": "aws/Architecture-Service-Icons_07312025/Arch_Security-Identity-Compliance/48/Arch_AWS-Identity-and-Access-Management_48.svg",
        "name": "double_tap_secret_profile",
        "role": "${aws_iam_role.double_tap_secret.name}"
      },
      "id": "aws_iam_instance_profile.double_tap_secret_profile"
    },
    {
      "data": {
        "resource_type": "aws_iam_policy",
        "resource_name": "ec2_privileged_policy",
        "resource_service": "iam",
        "resource_icon": "aws/Architecture-Service-Icons_07312025/Arch_Security-Identity-Compliance/48/Arch_AWS-Identity-and-Access-Management_48.svg",
        "name": "ec2_privileged_policy",
        "policy": "${jsonencode({\"Version\": \"2012-10-17\", \"Statement\": [{\"Effect\": \"Allow\", \"Action\": [\"ssm:StartSession\"], \"Resource\": \"*\", \"Condition\": {\"StringEquals\": {\"aws:ResourceTag/double_tap2\": \"true\"}}}, {\"Effect\": \"Deny\", \"Action\": [\"ec2:DeleteTags\", \"ec2:CreateTags\"], \"Resource\": \"*\"}, {\"Effect\": \"Allow\", \"Action\": \"ssm:*\", \"Resource\": \"arn:aws:ssm:*:*:*\"}, {\"Effect\": \"Allow\", \"Action\": [\"ssm:SendCommand\"], \"Resource\": [\"arn:aws:ec2:*:*:instance/*\"], \"Condition\": {\"StringEquals\": {\"aws:ResourceTag/double_tap2\": \"true\"}}}]})}"
      },
      "id": "aws_iam_policy.ec2_privileged_policy"
    },
    {
      "data": {
        "resource_type": "aws_iam_role",
        "resource_name": "ec2_privileged",
        "resource_service": "iam",
        "resource_icon": "aws/Architecture-Service-Icons_07312025/Arch_Security-Identity-Compliance/48/Arch_AWS-Identity-and-Access-Management_48.svg",
        "name": "ec2_privileged",
        "assume_role_policy": "${jsonencode({\"Version\": \"2012-10-17\", \"Statement\": [{\"Effect\": \"Allow\", \"Principal\": {\"Service\": \"ec2.amazonaws.com\"}, \"Action\": \"sts:AssumeRole\"}]})}"
      },
      "id": "aws_iam_role.ec2_privileged"
    },
    {
      "data": {
        "resource_type": "aws_iam_role_policy_attachment",
        "resource_name": "ec2_privileged_policy",
        "resource_service": "iam",
        "resource_icon": "aws/Architecture-Service-Icons_07312025/Arch_Security-Identity-Compliance/48/Arch_AWS-Identity-and-Access-Management_48.svg",
        "policy_arn": "${aws_iam_policy.ec2_privileged_policy.arn}",
        "role": "${aws_iam_role.ec2_privileged.name}"
      },
      "id": "aws_iam_role_policy_attachment.ec2_privileged_policy"
    },
    {
      "data": {
        "resource_type": "aws_instance",
        "resource_name": "ec2",
        "resource_service": "ec2",
        "resource_icon": "aws/Architecture-Service-Icons_07312025/Arch_Compute/48/Arch_Amazon-EC2_48.svg",
        "ami": null,
        "instance_type": "t3a.nano",
        "iam_instance_profile": "${aws_iam_instance_profile.ec2_privileged_profile.name}",
        "security_groups": [
          "instance_sg"
        ],
        "tags": {
          "double_tap1": "true",
          "Name": "double_tap"
        }
      },
      "id": "aws_instance.ec2"
    },
    {
      "data": {
        "resource_type": "aws_iam_instance_profile",
        "resource_name": "ec2_privileged_profile",
        "resource_service": "iam",
        "resource_icon": "aws/Architecture-Service-Icons_07312025/Arch_Security-Identity-Compliance/48/Arch_AWS-Identity-and-Access-Management_48.svg",
        "name": "ec2_privileged_profile",
        "role": "${aws_iam_role.ec2_privileged.name}"
      },
      "id": "aws_iam_instance_profile.ec2_privileged_profile"
    },
    {
      "data": {
        "resource_type": "aws_iam_role",
        "resource_name": "double_tap_xsdf",
        "resource_service": "iam",
        "resource_icon": "aws/Architecture-Service-Icons_07312025/Arch_Security-Identity-Compliance/48/Arch_AWS-Identity-and-Access-Management_48.svg",
        "name": "double_tap_xsdf",
        "assume_role_policy": "${jsonencode({\"Version\": \"2012-10-17\", \"Statement\": [{\"Effect\": \"Allow\", \"Principal\": {\"AWS\": \"${module.enabled.ctf_starting_user_arn}\"}, \"Action\": \"sts:AssumeRole\"}]})}"
      },
      "id": "aws_iam_role.double_tap_xsdf"
    },
    {
      "data": {
        "resource_type": "aws_iam_policy",
        "resource_name": "double_tap_iam_policy",
        "resource_service": "iam",
        "resource_icon": "aws/Architecture-Service-Icons_07312025/Arch_Security-Identity-Compliance/48/Arch_AWS-Identity-and-Access-Management_48.svg",
        "name": "double_tap_iam_policy",
        "policy": "${jsonencode({\"Version\": \"2012-10-17\", \"Statement\": [{\"Effect\": \"Allow\", \"Action\": [\"lambda:CreateFunction\", \"lambda:InvokeFunction\"], \"Resource\": \"*\"}, {\"Effect\": \"Allow\", \"Action\": [\"iam:PassRole\"], \"Resource\": \"arn:aws:iam:::role/lambda_*\"}]})}"
      },
      "id": "aws_iam_policy.double_tap_iam_policy"
    },
    {
      "data": {
        "resource_type": "aws_iam_role_policy_attachment",
        "resource_name": "double_tap_iam_policy_attachment",
        "resource_service": "iam",
        "resource_icon": "aws/Architecture-Service-Icons_07312025/Arch_Security-Identity-Compliance/48/Arch_AWS-Identity-and-Access-Management_48.svg",
        "policy_arn": "${aws_iam_policy.double_tap_iam_policy.arn}",
        "role": "${aws_iam_role.double_tap_xsdf.name}"
      },
      "id": "aws_iam_role_policy_attachment.double_tap_iam_policy_attachment"
    },
    {
      "data": {
        "resource_type": "aws_iam_policy",
        "resource_name": "lambda_ec2_policy",
        "resource_service": "iam",
        "resource_icon": "aws/Architecture-Service-Icons_07312025/Arch_Security-Identity-Compliance/48/Arch_AWS-Identity-and-Access-Management_48.svg",
        "name": "lambda_ec2_policy",
        "policy": "${jsonencode({\"Version\": \"2012-10-17\", \"Statement\": [{\"Effect\": \"Allow\", \"Action\": \"ec2:*\", \"Resource\": \"*\", \"Condition\": {\"StringEquals\": {\"aws:ResourceTag/double_tap1\": \"true\"}}}]})}"
      },
      "id": "aws_iam_policy.lambda_ec2_policy"
    },
    {
      "data": {
        "resource_type": "aws_iam_role",
        "resource_name": "lambda_ec2",
        "resource_service": "iam",
        "resource_icon": "aws/Architecture-Service-Icons_07312025/Arch_Security-Identity-Compliance/48/Arch_AWS-Identity-and-Access-Management_48.svg",
        "name": "lambda_ec2",
        "assume_role_policy": "${jsonencode({\"Version\": \"2012-10-17\", \"Statement\": [{\"Effect\": \"Allow\", \"Principal\": {\"Service\": \"lambda.amazonaws.com\"}, \"Action\": \"sts:AssumeRole\"}]})}"
      },
      "id": "aws_iam_role.lambda_ec2"
    },
    {
      "data": {
        "resource_type": "aws_iam_role_policy_attachment",
        "resource_name": "lambda_ec2_policy",
        "resource_service": "iam",
        "resource_icon": "aws/Architecture-Service-Icons_07312025/Arch_Security-Identity-Compliance/48/Arch_AWS-Identity-and-Access-Management_48.svg",
        "policy_arn": "${aws_iam_policy.lambda_ec2_policy.arn}",
        "role": "${aws_iam_role.lambda_ec2.name}"
      },
      "id": "aws_iam_role_policy_attachment.lambda_ec2_policy"
    },
    {
      "data": {
        "resource_type": "aws_iam_role_policy_attachment",
        "resource_name": "lambda_ec2_read_policy",
        "resource_service": "iam",
        "resource_icon": "aws/Architecture-Service-Icons_07312025/Arch_Security-Identity-Compliance/48/Arch_AWS-Identity-and-Access-Management_48.svg",
        "policy_arn": "arn:aws:iam::aws:policy/AmazonEC2ReadOnlyAccess",
        "role": "${aws_iam_role.lambda_ec2.name}"
      },
      "id": "aws_iam_role_policy_attachment.lambda_ec2_read_policy"
    },
    {
      "data": {
        "resource_type": "aws_iam_role",
        "resource_name": "double_tap_asdf",
        "resource_service": "iam",
        "resource_icon": "aws/Architecture-Service-Icons_07312025/Arch_Security-Identity-Compliance/48/Arch_AWS-Identity-and-Access-Management_48.svg",
        "name": "double_tap_asdf",
        "assume_role_policy": "${jsonencode({\"Version\": \"2012-10-17\", \"Statement\": [{\"Effect\": \"Allow\", \"Principal\": {\"AWS\": \"${module.enabled.ctf_starting_user_arn}\"}, \"Action\": \"sts:AssumeRole\"}]})}"
      },
      "id": "aws_iam_role.double_tap_asdf"
    },
    {
      "data": {
        "resource_type": "aws_iam_role",
        "resource_name": "double_tap_esdf",
        "resource_service": "iam",
        "resource_icon": "aws/Architecture-Service-Icons_07312025/Arch_Security-Identity-Compliance/48/Arch_AWS-Identity-and-Access-Management_48.svg",
        "name": "double_tap_esdf",
        "assume_role_policy": "${jsonencode({\"Version\": \"2012-10-17\", \"Statement\": [{\"Effect\": \"Allow\", \"Principal\": {\"AWS\": \"${module.enabled.ctf_starting_user_arn}\"}, \"Action\": \"sts:AssumeRole\"}]})}"
      },
      "id": "aws_iam_role.double_tap_esdf"
    },
    {
      "data": {
        "resource_type": "aws_iam_role",
        "resource_name": "double_tap_qsdf",
        "resource_service": "iam",
        "resource_icon": "aws/Architecture-Service-Icons_07312025/Arch_Security-Identity-Compliance/48/Arch_AWS-Identity-and-Access-Management_48.svg",
        "name": "double_tap_qsdf",
        "assume_role_policy": "${jsonencode({\"Version\": \"2012-10-17\", \"Statement\": [{\"Effect\": \"Allow\", \"Principal\": {\"AWS\": \"${module.enabled.ctf_starting_user_arn}\"}, \"Action\": \"sts:AssumeRole\"}]})}"
      },
      "id": "aws_iam_role.double_tap_qsdf"
    },
    {
      "data": {
        "resource_type": "aws_iam_role",
        "resource_name": "double_tap_zsdf",
        "resource_service": "iam",
        "resource_icon": "aws/Architecture-Service-Icons_07312025/Arch_Security-Identity-Compliance/48/Arch_AWS-Identity-and-Access-Management_48.svg",
        "name": "double_tap_zsdf",
        "assume_role_policy": "${jsonencode({\"Version\": \"2012-10-17\", \"Statement\": [{\"Effect\": \"Allow\", \"Principal\": {\"AWS\": \"${module.enabled.ctf_starting_user_arn}\"}, \"Action\": \"sts:AssumeRole\"}]})}"
      },
      "id": "aws_iam_role.double_tap_zsdf"
    },
    {
      "data": {
        "resource_type": "aws_cloudformation_stack",
        "resource_name": "cloudformationStack",
        "resource_service": "cloudformation",
        "resource_icon": "aws/Architecture-Service-Icons_07312025/Arch_Management-Governance/48/Arch_AWS-CloudFormation_48.svg",
        "name": "cloudformationStack",
        "capabilities": [
          "CAPABILITY_NAMED_IAM"
        ],
        "template_body": {
          "Resources": {
            "Bucket1": {
              "Type": "AWS::S3::Bucket",
              "Properties": {
                "BucketName": "my-production-bucket-${random_string.resource-suffix.result}"
              }
            },
            "IAMRole1": {
              "Type": "AWS::IAM::Role",
              "Properties": {
                "RoleName": "my-app-role",
                "AssumeRolePolicyDocument": {
                  "Version": "2012-10-17",
                  "Statement": [
                    {
                      "Effect": "Allow",
                      "Principal": {
                        "Service": "lambda.amazonaws.com"
                      },
                      "Action": "sts:AssumeRole"
                    }
                  ]
                }
              }
            },
            "DynamoDBTable1": {
              "Type": "AWS::DynamoDB::Table",
              "Properties": {
                "TableName": "my-user-profiles",
                "AttributeDefinitions": [
                  {
                    "AttributeName": "ID",
                    "AttributeType": "N"
                  }
                ],
                "KeySchema": [
                  {
                    "AttributeName": "ID",
                    "KeyType": "HASH"
                  }
                ],
                "ProvisionedThroughput": {
                  "ReadCapacityUnits": 5,
                  "WriteCapacityUnits": 5
                }
              }
            },
            "DemoIAMGroup": {
              "Type": "AWS::IAM::Group",
              "Properties": {
                "GroupName": "USWNT"
              }
            },
            "DemoIAMRole": {
              "Type": "AWS::IAM::Role",
              "Properties": {
                "RoleName": "fox",
                "AssumeRolePolicyDocument": {
                  "Version": "2012-10-17",
                  "Statement": [
                    {
                      "Effect": "Allow",
                      "Principal": {
                        "Service": "ec2.amazonaws.com"
                      },
                      "Action": "sts:AssumeRole"
                    }
                  ]
                }
              }
            },
            "NotImportant": {
              "Type": "AWS::SecretsManager::Secret",
              "Properties": {
                "Description": "Secure secret for sensitive data",
                "Name": "my-app-secret",
                "SecretString": "FLAG{needles::hardcoded_secret_in_cloudformation}"
              }
            },
            "DemoIAMUser": {
              "Type": "AWS::IAM::User",
              "Properties": {
                "UserName": "demo-iam-user"
              }
            },
            "DemoIAMPolicy": {
              "Type": "AWS::IAM::Policy",
              "Properties": {
                "PolicyName": "demo-iam-policy",
                "PolicyDocument": {
                  "Version": "2012-10-17",
                  "Statement": [
                    {
                      "Effect": "Allow",
                      "Action": [
                        "s3:ListBucket"
                      ],
                      "Resource": [
                        "arn:aws:s3:::demo-${random_string.resource-suffix.result}"
                      ]
                    }
                  ]
                },
                "Roles": [
                  {
                    "Ref": "DemoIAMRole"
                  }
                ]
              }
            }
          }
        }
      },
      "id": "aws_cloudformation_stack.cloudformationStack"
    },
    {
      "data": {
        "resource_type": "aws_iam_role",
        "resource_name": "ramos",
        "resource_service": "iam",
        "resource_icon": "aws/Architecture-Service-Icons_07312025/Arch_Security-Identity-Compliance/48/Arch_AWS-Identity-and-Access-Management_48.svg",
        "name": "ramos",
        "assume_role_policy": {
          "Version": "2012-10-17",
          "Statement": [
            {
              "Action": "sts:AssumeRole",
              "Principal": {
                "AWS": "${module.enabled.ctf_starting_user_arn}"
              },
              "Effect": "Allow",
              "Sid": ""
            }
          ]
        }
      },
      "id": "aws_iam_role.ramos"
    },
    {
      "data": {
        "resource_type": "aws_iam_role_policy_attachment",
        "resource_name": "role-policy-attachment3",
        "resource_service": "iam",
        "resource_icon": "aws/Architecture-Service-Icons_07312025/Arch_Security-Identity-Compliance/48/Arch_AWS-Identity-and-Access-Management_48.svg",
        "role": "${aws_iam_role.ramos.name}",
        "policy_arn": "arn:aws:iam::aws:policy/AWSWAFReadOnlyAccess"
      },
      "id": "aws_iam_role_policy_attachment.role-policy-attachment3"
    },
    {
      "data": {
        "resource_type": "aws_iam_role_policy_attachment",
        "resource_name": "role-policy-attachment2",
        "resource_service": "iam",
        "resource_icon": "aws/Architecture-Service-Icons_07312025/Arch_Security-Identity-Compliance/48/Arch_AWS-Identity-and-Access-Management_48.svg",
        "role": "${aws_iam_role.ramos.name}",
        "policy_arn": "arn:aws:iam::aws:policy/AWSBudgetsReadOnlyAccess"
      },
      "id": "aws_iam_role_policy_attachment.role-policy-attachment2"
    },
    {
      "data": {
        "resource_type": "aws_iam_role_policy_attachment",
        "resource_name": "role-policy-attachment1",
        "resource_service": "iam",
        "resource_icon": "aws/Architecture-Service-Icons_07312025/Arch_Security-Identity-Compliance/48/Arch_AWS-Identity-and-Access-Management_48.svg",
        "role": "${aws_iam_role.ramos.name}",
        "policy_arn": "arn:aws:iam::aws:policy/AWSCloudFormationReadOnlyAccess"
      },
      "id": "aws_iam_role_policy_attachment.role-policy-attachment1"
    },
    {
      "data": {
        "resource_type": "aws_iam_role",
        "resource_name": "pain",
        "resource_service": "iam",
        "resource_icon": "aws/Architecture-Service-Icons_07312025/Arch_Security-Identity-Compliance/48/Arch_AWS-Identity-and-Access-Management_48.svg",
        "name": "christian_pulisic",
        "assume_role_policy": "${jsonencode({\"Version\": \"2012-10-17\", \"Statement\": [{\"Effect\": \"Allow\", \"Principal\": {\"AWS\": [\"arn:aws:iam:::user/${module.enabled.ctf_starting_user_name}\"]}, \"Action\": [\"sts:AssumeRole\"]}]})}"
      },
      "id": "aws_iam_role.pain"
    },
    {
      "data": {
        "resource_type": "aws_iam_policy",
        "resource_name": "pain-policy",
        "resource_service": "iam",
        "resource_icon": "aws/Architecture-Service-Icons_07312025/Arch_Security-Identity-Compliance/48/Arch_AWS-Identity-and-Access-Management_48.svg",
        "name": "pain-policy",
        "policy": "${jsonencode({\"Version\": \"2012-10-17\", \"Statement\": [{\"Effect\": \"Allow\", \"Action\": [\"cloudformation:CreateStack\", \"cloudformation:DescribeStacks\", \"cloudformation:DeleteStack\", \"cloudformation:DescribeStackEvents\", \"cloudformation:DescribeStackResource\", \"cloudformation:DescribeStackResources\", \"cloudformation:DescribeStacks\"], \"Resource\": \"*\"}, {\"Effect\": \"Allow\", \"Action\": [\"iam:PassRole\"], \"Resource\": [\"*\"]}]})}"
      },
      "id": "aws_iam_policy.pain-policy"
    },
    {
      "data": {
        "resource_type": "aws_iam_role_policy_attachment",
        "resource_name": "pain-policy-attachment",
        "resource_service": "iam",
        "resource_icon": "aws/Architecture-Service-Icons_07312025/Arch_Security-Identity-Compliance/48/Arch_AWS-Identity-and-Access-Management_48.svg",
        "role": "${aws_iam_role.pain.name}",
        "policy_arn": "${aws_iam_policy.pain-policy.arn}"
      },
      "id": "aws_iam_role_policy_attachment.pain-policy-attachment"
    },
    {
      "data": {
        "resource_type": "aws_iam_role_policy_attachment",
        "resource_name": "pulisic-ec2-policy-attachment",
        "resource_service": "iam",
        "resource_icon": "aws/Architecture-Service-Icons_07312025/Arch_Security-Identity-Compliance/48/Arch_AWS-Identity-and-Access-Management_48.svg",
        "role": "${aws_iam_role.pain.name}",
        "policy_arn": "arn:aws:iam::aws:policy/AmazonEC2ReadOnlyAccess"
      },
      "id": "aws_iam_role_policy_attachment.pulisic-ec2-policy-attachment"
    },
    {
      "data": {
        "resource_type": "aws_iam_role_policy_attachment",
        "resource_name": "pulisic-cloudformation-policy-attachment",
        "resource_service": "iam",
        "resource_icon": "aws/Architecture-Service-Icons_07312025/Arch_Security-Identity-Compliance/48/Arch_AWS-Identity-and-Access-Management_48.svg",
        "role": "${aws_iam_role.pain.name}",
        "policy_arn": "arn:aws:iam::aws:policy/AWSCloudFormationReadOnlyAccess"
      },
      "id": "aws_iam_role_policy_attachment.pulisic-cloudformation-policy-attachment"
    },
    {
      "data": {
        "resource_type": "aws_iam_role_policy_attachment",
        "resource_name": "pulisic-opsworks-policy-attachment",
        "resource_service": "iam",
        "resource_icon": "aws/Architecture-Service-Icons_07312025/Arch_Security-Identity-Compliance/48/Arch_AWS-Identity-and-Access-Management_48.svg",
        "role": "${aws_iam_role.pain.name}",
        "policy_arn": "arn:aws:iam::aws:policy/AWSOpsWorksCMInstanceProfileRole"
      },
      "id": "aws_iam_role_policy_attachment.pulisic-opsworks-policy-attachment"
    },
    {
      "data": {
        "resource_type": "aws_iam_role",
        "resource_name": "pain2",
        "resource_service": "iam",
        "resource_icon": "aws/Architecture-Service-Icons_07312025/Arch_Security-Identity-Compliance/48/Arch_AWS-Identity-and-Access-Management_48.svg",
        "name": "tab_ramos",
        "assume_role_policy": "${jsonencode({\"Version\": \"2012-10-17\", \"Statement\": [{\"Effect\": \"Allow\", \"Principal\": {\"Service\": [\"cloudformation.amazonaws.com\"]}, \"Action\": [\"sts:AssumeRole\"]}]})}"
      },
      "id": "aws_iam_role.pain2"
    },
    {
      "data": {
        "resource_type": "aws_iam_role_policy_attachment",
        "resource_name": "pain2-policy-attachment",
        "resource_service": "iam",
        "resource_icon": "aws/Architecture-Service-Icons_07312025/Arch_Security-Identity-Compliance/48/Arch_AWS-Identity-and-Access-Management_48.svg",
        "role": "${aws_iam_role.pain2.name}",
        "policy_arn": "arn:aws:iam::aws:policy/AWSLambda_FullAccess"
      },
      "id": "aws_iam_role_policy_attachment.pain2-policy-attachment"
    },
    {
      "data": {
        "resource_type": "aws_iam_policy",
        "resource_name": "pain2-deny-policy",
        "resource_service": "iam",
        "resource_icon": "aws/Architecture-Service-Icons_07312025/Arch_Security-Identity-Compliance/48/Arch_AWS-Identity-and-Access-Management_48.svg",
        "name": "pain2-policy",
        "policy": "${jsonencode({\"Version\": \"2012-10-17\", \"Statement\": [{\"Effect\": \"Deny\", \"Action\": [\"iam:PassRole\"], \"Resource\": [\"arn:aws:iam::*:role/aaronson\", \"arn:aws:iam::*:role/my-app-role\", \"arn:aws:iam::*:role/producer\", \"arn:aws:iam::*:role/ream\", \"arn:aws:iam::*:role/sauerbrunn\", \"arn:aws:iam::*:role/swanson\", \"arn:aws:iam::*:role/lambda_*\"]}]})}"
      },
      "id": "aws_iam_policy.pain2-deny-policy"
    },
    {
      "data": {
        "resource_type": "aws_iam_role_policy_attachment",
        "resource_name": "pain2-deny-policy-attachment",
        "resource_service": "iam",
        "resource_icon": "aws/Architecture-Service-Icons_07312025/Arch_Security-Identity-Compliance/48/Arch_AWS-Identity-and-Access-Management_48.svg",
        "role": "${aws_iam_role.pain2.name}",
        "policy_arn": "${aws_iam_policy.pain2-deny-policy.arn}"
      },
      "id": "aws_iam_role_policy_attachment.pain2-deny-policy-attachment"
    },
    {
      "data": {
        "resource_type": "aws_iam_role",
        "resource_name": "pain3",
        "resource_service": "iam",
        "resource_icon": "aws/Architecture-Service-Icons_07312025/Arch_Security-Identity-Compliance/48/Arch_AWS-Identity-and-Access-Management_48.svg",
        "name": "brian_mcbride",
        "assume_role_policy": "${jsonencode({\"Version\": \"2012-10-17\", \"Statement\": [{\"Effect\": \"Allow\", \"Principal\": {\"Service\": [\"lambda.amazonaws.com\"]}, \"Action\": [\"sts:AssumeRole\"]}]})}"
      },
      "id": "aws_iam_role.pain3"
    },
    {
      "data": {
        "resource_type": "aws_iam_policy",
        "resource_name": "pain3-ec2-policy",
        "resource_service": "iam",
        "resource_icon": "aws/Architecture-Service-Icons_07312025/Arch_Security-Identity-Compliance/48/Arch_AWS-Identity-and-Access-Management_48.svg",
        "name": "pain3-ec2-policy",
        "policy": "${jsonencode({\"Version\": \"2012-10-17\", \"Statement\": [{\"Effect\": \"Allow\", \"Action\": [\"ec2:RunInstances\", \"ec2:DescribeInstances\", \"ec2:TerminateInstances\", \"ec2:Describe*\"], \"Resource\": \"*\"}, {\"Effect\": \"Allow\", \"Action\": [\"iam:PassRole\"], \"Resource\": \"*\"}, {\"Effect\": \"Deny\", \"Action\": [\"iam:PassRole\"], \"Resource\": [\"arn:aws:iam::*:role/double_*\", \"arn:aws:iam::*:role/ec2_privileged\", \"arn:aws:iam::*:role/fox\", \"arn:aws:iam::*:role/wyatt\", \"arn:aws:iam::*:role/reyna\"]}]})}"
      },
      "id": "aws_iam_policy.pain3-ec2-policy"
    },
    {
      "data": {
        "resource_type": "aws_iam_role_policy_attachment",
        "resource_name": "pain3-policy-attachment",
        "resource_service": "iam",
        "resource_icon": "aws/Architecture-Service-Icons_07312025/Arch_Security-Identity-Compliance/48/Arch_AWS-Identity-and-Access-Management_48.svg",
        "role": "${aws_iam_role.pain3.name}",
        "policy_arn": "${aws_iam_policy.pain3-ec2-policy.arn}"
      },
      "id": "aws_iam_role_policy_attachment.pain3-policy-attachment"
    },
    {
      "data": {
        "resource_type": "aws_iam_role_policy_attachment",
        "resource_name": "pain3-lambda-policy-attachment",
        "resource_service": "iam",
        "resource_icon": "aws/Architecture-Service-Icons_07312025/Arch_Security-Identity-Compliance/48/Arch_AWS-Identity-and-Access-Management_48.svg",
        "role": "${aws_iam_role.pain3.name}",
        "policy_arn": "arn:aws:iam::aws:policy/service-role/AWSLambdaBasicExecutionRole"
      },
      "id": "aws_iam_role_policy_attachment.pain3-lambda-policy-attachment"
    },
    {
      "data": {
        "resource_type": "aws_iam_role",
        "resource_name": "pain4",
        "resource_service": "iam",
        "resource_icon": "aws/Architecture-Service-Icons_07312025/Arch_Security-Identity-Compliance/48/Arch_AWS-Identity-and-Access-Management_48.svg",
        "name": "landon_donovan",
        "assume_role_policy": "${jsonencode({\"Version\": \"2012-10-17\", \"Statement\": [{\"Effect\": \"Allow\", \"Principal\": {\"Service\": [\"ec2.amazonaws.com\"]}, \"Action\": [\"sts:AssumeRole\"]}]})}"
      },
      "id": "aws_iam_role.pain4"
    },
    {
      "data": {
        "resource_type": "aws_iam_instance_profile",
        "resource_name": "pain4-instance-profile",
        "resource_service": "iam",
        "resource_icon": "aws/Architecture-Service-Icons_07312025/Arch_Security-Identity-Compliance/48/Arch_AWS-Identity-and-Access-Management_48.svg",
        "name": "landon_donovan",
        "role": "${aws_iam_role.pain4.name}"
      },
      "id": "aws_iam_instance_profile.pain4-instance-profile"
    },
    {
      "data": {
        "resource_type": "aws_s3_bucket",
        "resource_name": "pain-s3",
        "resource_service": "s3",
        "resource_icon": "aws/Architecture-Service-Icons_07312025/Arch_Storage/48/Arch_Amazon-Simple-Storage-Service_48.svg",
        "bucket": "pain-s3-${random_string.resource-suffix.result}"
      },
      "id": "aws_s3_bucket.pain-s3"
    },
    {
      "data": {
        "resource_type": "aws_iam_policy",
        "resource_name": "pain4-policy",
        "resource_service": "iam",
        "resource_icon": "aws/Architecture-Service-Icons_07312025/Arch_Security-Identity-Compliance/48/Arch_AWS-Identity-and-Access-Management_48.svg",
        "name": "pain4-policy",
        "policy": "${jsonencode({\"Version\": \"2012-10-17\", \"Statement\": [{\"Effect\": \"Allow\", \"Action\": [\"s3:GetObject\", \"s3:ListBucket\"], \"Resource\": [\"${aws_s3_bucket.pain-s3.arn}\", \"${aws_s3_bucket.pain-s3.arn}/*\"]}, {\"Effect\": \"Allow\", \"Action\": [\"s3:ListAllMyBuckets\"], \"Resource\": [\"*\"]}]})}"
      },
      "id": "aws_iam_policy.pain4-policy"
    },
    {
      "data": {
        "resource_type": "aws_iam_role_policy_attachment",
        "resource_name": "pain4-policy-attachment",
        "resource_service": "iam",
        "resource_icon": "aws/Architecture-Service-Icons_07312025/Arch_Security-Identity-Compliance/48/Arch_AWS-Identity-and-Access-Management_48.svg",
        "role": "${aws_iam_role.pain4.name}",
        "policy_arn": "${aws_iam_policy.pain4-policy.arn}"
      },
      "id": "aws_iam_role_policy_attachment.pain4-policy-attachment"
    },
    {
      "data": {
        "resource_type": "aws_s3_object",
        "resource_name": "pain-s3-object",
        "resource_service": "s3",
        "resource_icon": "aws/Architecture-Service-Icons_07312025/Arch_Storage/48/Arch_Amazon-S3-on-Outposts_48.svg",
        "bucket": "${aws_s3_bucket.pain-s3.id}",
        "key": "flag.txt",
        "source": "challenges/Pain/data/flag.txt"
      },
      "id": "aws_s3_object.pain-s3-object"
    },
    {
      "data": {
        "resource_type": "aws_iam_policy",
        "resource_name": "authorized_deployers",
        "resource_service": "iam",
        "resource_icon": "aws/Architecture-Service-Icons_07312025/Arch_Security-Identity-Compliance/48/Arch_AWS-Identity-and-Access-Management_48.svg",
        "name": "authorized_deployers",
        "path": "/",
        "description": "policy for authorized deployers in the organization",
        "policy": "${jsonencode({\"Version\": \"2012-10-17\", \"Statement\": [{\"Effect\": \"Allow\", \"Action\": [\"sts:AssumeRole\"], \"Resource\": [\"arn:aws:iam:::role/deployment_automation\", \"arn:aws:iam::992382614597:role/*\"]}, {\"Effect\": \"Allow\", \"Action\": [\"s3:GetObject\", \"s3:ListBucket\"], \"Resource\": [\"${aws_s3_bucket.deployment-automation.arn}\", \"${aws_s3_bucket.deployment-automation.arn}/*\"]}]})}"
      },
      "id": "aws_iam_policy.authorized_deployers"
    },
    {
      "data": {
        "resource_type": "aws_iam_role",
        "resource_name": "reinier",
        "resource_service": "iam",
        "resource_icon": "aws/Architecture-Service-Icons_07312025/Arch_Security-Identity-Compliance/48/Arch_AWS-Identity-and-Access-Management_48.svg",
        "name": "reinier",
        "assume_role_policy": "${jsonencode({\"Version\": \"2012-10-17\", \"Statement\": [{\"Action\": \"sts:AssumeRole\", \"Effect\": \"Allow\", \"Sid\": \"\", \"Principal\": {\"AWS\": [\"arn:aws:iam:::user/${module.enabled.ctf_starting_user_name}\"]}}]})}"
      },
      "id": "aws_iam_role.reinier"
    },
    {
      "data": {
        "resource_type": "aws_iam_role_policy_attachment",
        "resource_name": "authorized_deployers-attachment",
        "resource_service": "iam",
        "resource_icon": "aws/Architecture-Service-Icons_07312025/Arch_Security-Identity-Compliance/48/Arch_AWS-Identity-and-Access-Management_48.svg",
        "role": "${aws_iam_role.reinier.name}",
        "policy_arn": "${aws_iam_policy.authorized_deployers.arn}"
      },
      "id": "aws_iam_role_policy_attachment.authorized_deployers-attachment"
    },
    {
      "data": {
        "resource_type": "aws_iam_role_policy_attachment",
        "resource_name": "security_audit-attachment",
        "resource_service": "iam",
        "resource_icon": "aws/Architecture-Service-Icons_07312025/Arch_Security-Identity-Compliance/48/Arch_AWS-Identity-and-Access-Management_48.svg",
        "role": "${aws_iam_role.reinier.name}",
        "policy_arn": "arn:aws:iam::aws:policy/SecurityAudit"
      },
      "id": "aws_iam_role_policy_attachment.security_audit-attachment"
    },
    {
      "data": {
        "resource_type": "aws_secretsmanager_secret",
        "resource_name": "SegueFlag",
        "resource_service": "secretsmanager",
        "resource_icon": "aws/Architecture-Service-Icons_07312025/Arch_Security-Identity-Compliance/48/Arch_AWS-Secrets-Manager_48.svg",
        "name": "SegueFlag",
        "recovery_window_in_days": 0,
        "tags": {
          "Name": "Segue flag"
        }
      },
      "id": "aws_secretsmanager_secret.SegueFlag"
    },
    {
      "data": {
        "resource_type": "aws_secretsmanager_secret_version",
        "resource_name": "SegueFlag",
        "resource_service": "secretsmanager",
        "resource_icon": "aws/Architecture-Service-Icons_07312025/Arch_Security-Identity-Compliance/48/Arch_AWS-Secrets-Manager_48.svg",
        "secret_id": "${aws_secretsmanager_secret.SegueFlag.id}",
        "secret_string": "Thank you, but your flag is in another castle"
      },
      "id": "aws_secretsmanager_secret_version.SegueFlag"
    },
    {
      "data": {
        "resource_type": "aws_iam_policy",
        "resource_name": "deployment_automation",
        "resource_service": "iam",
        "resource_icon": "aws/Architecture-Service-Icons_07312025/Arch_Security-Identity-Compliance/48/Arch_AWS-Identity-and-Access-Management_48.svg",
        "name": "deployment_automation",
        "path": "/",
        "description": "policy for automated deployment",
        "policy": "${jsonencode({\"Version\": \"2012-10-17\", \"Statement\": [{\"Effect\": \"Allow\", \"Action\": [\"sts:AssumeRole\"], \"Resource\": \"arn:aws:iam:::role/secret_reader\"}]})}"
      },
      "id": "aws_iam_policy.deployment_automation"
    },
    {
      "data": {
        "resource_type": "aws_iam_role",
        "resource_name": "deployment_automation",
        "resource_service": "iam",
        "resource_icon": "aws/Architecture-Service-Icons_07312025/Arch_Security-Identity-Compliance/48/Arch_AWS-Identity-and-Access-Management_48.svg",
        "name": "deployment_automation",
        "assume_role_policy": "${jsonencode({\"Version\": \"2012-10-17\", \"Statement\": [{\"Action\": \"sts:AssumeRole\", \"Effect\": \"Allow\", \"Sid\": \"\", \"Principal\": {\"AWS\": [\"arn:aws:iam:::role/reinier\"]}}]})}"
      },
      "id": "aws_iam_role.deployment_automation"
    },
    {
      "data": {
        "resource_type": "aws_iam_role_policy_attachment",
        "resource_name": "deployment_automation-attachment",
        "resource_service": "iam",
        "resource_icon": "aws/Architecture-Service-Icons_07312025/Arch_Security-Identity-Compliance/48/Arch_AWS-Identity-and-Access-Management_48.svg",
        "role": "${aws_iam_role.deployment_automation.name}",
        "policy_arn": "${aws_iam_policy.deployment_automation.arn}"
      },
      "id": "aws_iam_role_policy_attachment.deployment_automation-attachment"
    },
    {
      "data": {
        "resource_type": "aws_iam_policy",
        "resource_name": "secret_reader",
        "resource_service": "iam",
        "resource_icon": "aws/Architecture-Service-Icons_07312025/Arch_Security-Identity-Compliance/48/Arch_AWS-Identity-and-Access-Management_48.svg",
        "name": "secret_reader",
        "path": "/",
        "description": "policy for reading secrets",
        "policy": "${jsonencode({\"Version\": \"2012-10-17\", \"Statement\": [{\"Effect\": \"Allow\", \"Action\": [\"secretsmanager:ListSecrets\"], \"Resource\": \"*\"}, {\"Effect\": \"Allow\", \"Action\": [\"secretsmanager:GetSecretValue\"], \"Resource\": \"${aws_secretsmanager_secret.SegueFlag.arn}\"}]})}"
      },
      "id": "aws_iam_policy.secret_reader"
    },
    {
      "data": {
        "resource_type": "aws_iam_role",
        "resource_name": "secret_reader",
        "resource_service": "iam",
        "resource_icon": "aws/Architecture-Service-Icons_07312025/Arch_Security-Identity-Compliance/48/Arch_AWS-Identity-and-Access-Management_48.svg",
        "name": "secret_reader",
        "assume_role_policy": "${jsonencode({\"Version\": \"2012-10-17\", \"Statement\": [{\"Action\": \"sts:AssumeRole\", \"Effect\": \"Allow\", \"Sid\": \"\", \"Principal\": {\"AWS\": [\"arn:aws:iam:::role/deployment_automation\"]}}]})}"
      },
      "id": "aws_iam_role.secret_reader"
    },
    {
      "data": {
        "resource_type": "aws_iam_role_policy_attachment",
        "resource_name": "secret_reader-attachment",
        "resource_service": "iam",
        "resource_icon": "aws/Architecture-Service-Icons_07312025/Arch_Security-Identity-Compliance/48/Arch_AWS-Identity-and-Access-Management_48.svg",
        "role": "${aws_iam_role.secret_reader.name}",
        "policy_arn": "${aws_iam_policy.secret_reader.arn}"
      },
      "id": "aws_iam_role_policy_attachment.secret_reader-attachment"
    },
    {
      "data": {
        "resource_type": "aws_s3_bucket",
        "resource_name": "deployment-automation",
        "resource_service": "s3",
        "resource_icon": "aws/Architecture-Service-Icons_07312025/Arch_Storage/48/Arch_Amazon-Simple-Storage-Service_48.svg",
        "bucket": "deployment-automation-${random_string.resource-suffix.result}",
        "force_destroy": true,
        "tags": {
          "Name": "deployment-automation-${random_string.resource-suffix.result}"
        }
      },
      "id": "aws_s3_bucket.deployment-automation"
    },
    {
      "data": {
        "resource_type": "aws_s3_bucket_public_access_block",
        "resource_name": "deployment-automation-public-access-block",
        "resource_service": "s3",
        "resource_icon": "aws/Architecture-Service-Icons_07312025/Arch_Storage/48/Arch_Amazon-S3-on-Outposts_48.svg",
        "bucket": "${aws_s3_bucket.deployment-automation.id}",
        "block_public_acls": true,
        "block_public_policy": true,
        "ignore_public_acls": true,
        "restrict_public_buckets": true
      },
      "id": "aws_s3_bucket_public_access_block.deployment-automation-public-access-block"
    },
    {
      "data": {
        "resource_type": "aws_s3_object",
        "resource_name": "deployment-automation-object",
        "resource_service": "s3",
        "resource_icon": "aws/Architecture-Service-Icons_07312025/Arch_Storage/48/Arch_Amazon-S3-on-Outposts_48.svg",
        "bucket": "${aws_s3_bucket.deployment-automation.id}",
        "key": "Security Review Process.pdf",
        "source": "challenges/Segue/data/s3/Security Review Process.pdf"
      },
      "id": "aws_s3_object.deployment-automation-object"
    },
    {
      "data": {
        "resource_type": "aws_s3_object",
        "resource_name": "deployment-automation-object-2",
        "resource_service": "s3",
        "resource_icon": "aws/Architecture-Service-Icons_07312025/Arch_Storage/48/Arch_Amazon-S3-on-Outposts_48.svg",
        "bucket": "${aws_s3_bucket.deployment-automation.id}",
        "key": "Deployment Process Description.pdf",
        "source": "challenges/Segue/data/s3/Deployment Process Description.pdf"
      },
      "id": "aws_s3_object.deployment-automation-object-2"
    },
    {
      "data": {
        "resource_type": "aws_elasticsearch_domain",
        "resource_name": "pat",
        "resource_service": "elasticsearch",
        "resource_icon": "aws/Architecture-Service-Icons_07312025/Arch_Analytics/48/Arch_Amazon-OpenSearch-Service_48.svg",
        "domain_name": "pat",
        "elasticsearch_version": 7.9,
        "cluster_config": [
          {
            "instance_type": "t2.small.elasticsearch",
            "instance_count": 1
          }
        ],
        "ebs_options": [
          {
            "ebs_enabled": true,
            "volume_size": 10
          }
        ],
        "snapshot_options": [
          {
            "automated_snapshot_start_hour": 23
          }
        ],
        "access_policies": "${jsonencode({\"Version\": \"2012-10-17\", \"Statement\": [{\"Effect\": \"Allow\", \"Principal\": {\"AWS\": \"*\"}, \"Action\": [\"es:ESHttpGet\", \"es:ESHttpHead\", \"es:ESHttpPost\"], \"Resource\": \"*\", \"Condition\": {\"IpAddress\": {\"aws:SourceIp\": \"'' != \"\" ? chomp('') : chomp(None)/32\"}}}]})}"
      },
      "id": "aws_elasticsearch_domain.pat"
    },
    {
      "data": {
        "resource_type": "null_resource",
        "resource_name": "upload_logs",
        "resource_service": "terraform/terraform-logo.svg",
        "resource_icon": "terraform/terraform-logo.svg",
        "triggers": {
          "pat_domain_endpoint": "${aws_elasticsearch_domain.pat.endpoint}"
        },
        "provisioner": [
          {
            "local-exec": {
              "command": "curl -X POST \"${aws_elasticsearch_domain.pat.endpoint}/webserver-logs/_doc/\" -H 'Content-Type: application/json' -d '{\"timestamp\": \"2023-04-25T01:02:00Z\", \"log\": \"192.0.2.44 - - [25/Apr/2023:01:02:00 +0000] \"GET /app/database HTTP/1.1\" 200 7189\", \"source_ip\": \"192.0.2.44\"}' && \\\ncurl -X POST \"${aws_elasticsearch_domain.pat.endpoint}/webserver-logs/_doc/\" -H 'Content-Type: application/json' -d '{\"timestamp\": \"2023-04-25T01:00:00Z\", \"log\": \"192.0.2.42 - - [25/Apr/2023:01:04:00 +0000] \"GET /app/login?session_id=abc123&ctf_flag=FLAG{search1::You_will_find_the_craziest_stuff_in_elasticsearch_sometimes} HTTP/1.1\" 200 5123\", \"source_ip\": \"192.0.2.4\"}' && \\\ncurl -X POST \"${aws_elasticsearch_domain.pat.endpoint}/webserver-logs/_doc/\" -H 'Content-Type: application/json' -d '{\"timestamp\": \"2023-04-25T01:01:00Z\", \"log\": \"192.0.2.43 - - [25/Apr/2023:01:01:00 +0000] \"GET /app/data?token=Z2l0aHViX3BhdF8xMUE3UEdORVEwUHhZTFNNNm1MWnplXzlTZnBDeFVZV0ZycXJEMlp0V2NZZjRySmFEYkNKMXQ5S0VCUWNOUUM5VjNSUElZT1VST0sxQzl5WTdKCg== HTTP/1.1\" 200 6145\", \"source_ip\": \"192.0.2.43\"}' && \\\ncurl -X POST \"${aws_elasticsearch_domain.pat.endpoint}/webserver-logs/_doc/\" -H 'Content-Type: application/json' -d '{\"timestamp\": \"2023-04-25T01:02:00Z\", \"log\": \"192.0.2.44 - - [25/Apr/2023:01:02:00 +0000] \"GET /app/profile HTTP/1.1\" 200 7189\", \"source_ip\": \"192.0.2.44\"}'"
            }
          }
        ]
      },
      "id": "null_resource.upload_logs"
    },
    {
      "data": {
        "resource_type": "aws_lambda_function",
        "resource_name": "furls1",
        "resource_service": "lambda",
        "resource_icon": "aws/Architecture-Service-Icons_07312025/Arch_Compute/48/Arch_AWS-Lambda_48.svg",
        "filename": "challenges/Furls 1/data/lambda/lambda_function.zip",
        "function_name": "furls1",
        "role": "${aws_iam_role.furls1.arn}",
        "handler": "index.handler",
        "source_code_hash": null,
        "runtime": "nodejs18.x"
      },
      "id": "aws_lambda_function.furls1"
    },
    {
      "data": {
        "resource_type": "aws_iam_policy",
        "resource_name": "furls1",
        "resource_service": "iam",
        "resource_icon": "aws/Architecture-Service-Icons_07312025/Arch_Security-Identity-Compliance/48/Arch_AWS-Identity-and-Access-Management_48.svg",
        "name": "furls1",
        "path": "/",
        "description": "Low priv policy used by lambdas",
        "policy": "${jsonencode({\"Version\": \"2012-10-17\", \"Statement\": [{\"Action\": [\"logs:CreateLogGroup\", \"logs:CreateLogStream\", \"logs:PutLogEvents\"], \"Effect\": \"Allow\", \"Resource\": \"*\"}]})}"
      },
      "id": "aws_iam_policy.furls1"
    },
    {
      "data": {
        "resource_type": "aws_iam_role",
        "resource_name": "furls1",
        "resource_service": "iam",
        "resource_icon": "aws/Architecture-Service-Icons_07312025/Arch_Security-Identity-Compliance/48/Arch_AWS-Identity-and-Access-Management_48.svg",
        "name": "aaronson",
        "assume_role_policy": "${jsonencode({\"Version\": \"2012-10-17\", \"Statement\": [{\"Action\": \"sts:AssumeRole\", \"Effect\": \"Allow\", \"Sid\": \"\", \"Principal\": {\"Service\": \"lambda.amazonaws.com\"}}]})}",
        "managed_policy_arns": [
          "${aws_iam_policy.furls1.arn}"
        ]
      },
      "id": "aws_iam_role.furls1"
    },
    {
      "data": {
        "resource_type": "aws_lambda_function_url",
        "resource_name": "furls1",
        "resource_service": "lambda",
        "resource_icon": "aws/Architecture-Service-Icons_07312025/Arch_Compute/48/Arch_AWS-Lambda_48.svg",
        "function_name": "${aws_lambda_function.furls1.function_name}",
        "authorization_type": "NONE"
      },
      "id": "aws_lambda_function_url.furls1"
    },
    {
      "data": {
        "resource_type": "aws_lambda_function",
        "resource_name": "auth-me",
        "resource_service": "lambda",
        "resource_icon": "aws/Architecture-Service-Icons_07312025/Arch_Compute/48/Arch_AWS-Lambda_48.svg",
        "filename": "challenges/Furls 2/data/lambda/lambda_function.zip",
        "function_name": "auth-me",
        "role": "${aws_iam_role.furls2.arn}",
        "handler": "index.handler",
        "source_code_hash": null,
        "runtime": "nodejs18.x",
        "environment": [
          {
            "variables": {
              "lambda_http_user": "admin",
              "lambda_http_password": "NotSummer2023"
            }
          }
        ]
      },
      "id": "aws_lambda_function.auth-me"
    },
    {
      "data": {
        "resource_type": "aws_iam_policy",
        "resource_name": "furls2",
        "resource_service": "iam",
        "resource_icon": "aws/Architecture-Service-Icons_07312025/Arch_Security-Identity-Compliance/48/Arch_AWS-Identity-and-Access-Management_48.svg",
        "name": "furls2",
        "path": "/",
        "description": "Low priv policy used by lambdas",
        "policy": "${jsonencode({\"Version\": \"2012-10-17\", \"Statement\": [{\"Action\": [\"logs:CreateLogGroup\", \"logs:CreateLogStream\", \"logs:PutLogEvents\"], \"Effect\": \"Allow\", \"Resource\": \"*\"}]})}"
      },
      "id": "aws_iam_policy.furls2"
    },
    {
      "data": {
        "resource_type": "aws_iam_role",
        "resource_name": "furls2",
        "resource_service": "iam",
        "resource_icon": "aws/Architecture-Service-Icons_07312025/Arch_Security-Identity-Compliance/48/Arch_AWS-Identity-and-Access-Management_48.svg",
        "name": "sauerbrunn",
        "assume_role_policy": "${jsonencode({\"Version\": \"2012-10-17\", \"Statement\": [{\"Action\": \"sts:AssumeRole\", \"Effect\": \"Allow\", \"Sid\": \"\", \"Principal\": {\"Service\": \"lambda.amazonaws.com\"}}]})}",
        "managed_policy_arns": [
          "${aws_iam_policy.furls2.arn}"
        ]
      },
      "id": "aws_iam_role.furls2"
    },
    {
      "data": {
        "resource_type": "aws_lambda_function_url",
        "resource_name": "furls2",
        "resource_service": "lambda",
        "resource_icon": "aws/Architecture-Service-Icons_07312025/Arch_Compute/48/Arch_AWS-Lambda_48.svg",
        "function_name": "${aws_lambda_function.auth-me.function_name}",
        "authorization_type": "NONE"
      },
      "id": "aws_lambda_function_url.furls2"
    },
    {
      "data": {
        "resource_type": "aws_iam_role",
        "resource_name": "mewis",
        "resource_service": "iam",
        "resource_icon": "aws/Architecture-Service-Icons_07312025/Arch_Security-Identity-Compliance/48/Arch_AWS-Identity-and-Access-Management_48.svg",
        "name": "mewis",
        "assume_role_policy": "${jsonencode({\"Version\": \"2012-10-17\", \"Statement\": [{\"Action\": \"sts:AssumeRole\", \"Effect\": \"Allow\", \"Sid\": \"\", \"Principal\": {\"AWS\": \"${module.enabled.ctf_starting_user_arn}\"}}]})}"
      },
      "id": "aws_iam_role.mewis"
    },
    {
      "data": {
        "resource_type": "aws_iam_policy",
        "resource_name": "mewis",
        "resource_service": "iam",
        "resource_icon": "aws/Architecture-Service-Icons_07312025/Arch_Security-Identity-Compliance/48/Arch_AWS-Identity-and-Access-Management_48.svg",
        "name": "mewis",
        "path": "/",
        "description": "Low priv policy used by lambdas",
        "policy": "${jsonencode({\"Version\": \"2012-10-17\", \"Statement\": [{\"Action\": [\"lambda:ListFunctions\"], \"Effect\": \"Allow\", \"Resource\": \"*\"}]})}"
      },
      "id": "aws_iam_policy.mewis"
    },
    {
      "data": {
        "resource_type": "aws_iam_role_policy_attachment",
        "resource_name": "mewis",
        "resource_service": "iam",
        "resource_icon": "aws/Architecture-Service-Icons_07312025/Arch_Security-Identity-Compliance/48/Arch_AWS-Identity-and-Access-Management_48.svg",
        "role": "${aws_iam_role.mewis.name}",
        "policy_arn": "${aws_iam_policy.mewis.arn}"
      },
      "id": "aws_iam_role_policy_attachment.mewis"
    },
    {
      "data": {
        "resource_type": "aws_iam_role",
        "resource_name": "event_bridge_sns_role",
        "resource_service": "iam",
        "resource_icon": "aws/Architecture-Service-Icons_07312025/Arch_Security-Identity-Compliance/48/Arch_AWS-Identity-and-Access-Management_48.svg",
        "name": "spy-sns-role",
        "assume_role_policy": "${jsonencode({\"Version\": \"2012-10-17\", \"Statement\": [{\"Effect\": \"Allow\", \"Principal\": {\"Service\": \"scheduler.amazonaws.com\"}, \"Action\": \"sts:AssumeRole\"}]})}",
        "tags": {
          "Name": "event_bridge_sns_role",
          "Environment": "cloudfox"
        }
      },
      "id": "aws_iam_role.event_bridge_sns_role"
    },
    {
      "data": {
        "resource_type": "aws_iam_policy",
        "resource_name": "sns_publish_policy",
        "resource_service": "iam",
        "resource_icon": "aws/Architecture-Service-Icons_07312025/Arch_Security-Identity-Compliance/48/Arch_AWS-Identity-and-Access-Management_48.svg",
        "name": "sns-publish-policy",
        "path": "/",
        "description": "Allow sns:Publish",
        "policy": "${jsonencode({\"Version\": \"2012-10-17\", \"Statement\": [{\"Effect\": \"Allow\", \"Action\": \"sns:Publish\", \"Resource\": \"${aws_sns_topic.eventbridge_sns.arn}\"}]})}"
      },
      "id": "aws_iam_policy.sns_publish_policy"
    },
    {
      "data": {
        "resource_type": "aws_iam_role_policy_attachment",
        "resource_name": "sns_publish_policy_attachment",
        "resource_service": "iam",
        "resource_icon": "aws/Architecture-Service-Icons_07312025/Arch_Security-Identity-Compliance/48/Arch_AWS-Identity-and-Access-Management_48.svg",
        "role": "${aws_iam_role.event_bridge_sns_role.name}",
        "policy_arn": "${aws_iam_policy.sns_publish_policy.arn}"
      },
      "id": "aws_iam_role_policy_attachment.sns_publish_policy_attachment"
    },
    {
      "data": {
        "resource_type": "aws_sns_topic_policy",
        "resource_name": "schedule-event-policy",
        "resource_service": "sns",
        "resource_icon": "aws/Architecture-Service-Icons_07312025/Arch_App-Integration/48/Arch_Amazon-Simple-Notification-Service_48.svg",
        "arn": "${aws_sns_topic.eventbridge_sns.arn}",
        "policy": "${jsonencode({\"Version\": \"2012-10-17\", \"Id\": \"snspolicy\", \"Statement\": [{\"Sid\": \"First\", \"Effect\": \"Allow\", \"Principal\": \"*\", \"Action\": [\"sns:Subscribe\", \"sns:Publish\"], \"Resource\": \"${aws_sns_topic.eventbridge_sns.arn}\", \"Condition\": {\"IpAddress\": {\"aws:SourceIp\": \"'' != \"\" ? chomp('') : chomp(None)/32\"}}}]})}"
      },
      "id": "aws_sns_topic_policy.schedule-event-policy"
    },
    {
      "data": {
        "resource_type": "aws_sns_topic",
        "resource_name": "eventbridge_sns",
        "resource_service": "sns",
        "resource_icon": "aws/Architecture-Service-Icons_07312025/Arch_App-Integration/48/Arch_Amazon-Simple-Notification-Service_48.svg",
        "name": "eventbridge-sns",
        "tags": {
          "Environment": "production"
        }
      },
      "id": "aws_sns_topic.eventbridge_sns"
    },
    {
      "data": {
        "resource_type": "aws_scheduler_schedule",
        "resource_name": "test_eventbridge-sns",
        "resource_service": "eventbridge",
        "resource_icon": "aws/Resource-Icons_07312025/Res_Application-Integration/Res_Amazon-EventBridge_Scheduler_48.svg",
        "name": "test-eventbridge-sns",
        "description": "sends sns message to topic",
        "flexible_time_window": [
          {
            "mode": "OFF"
          }
        ],
        "schedule_expression": "rate(1 minutes)",
        "target": [
          {
            "arn": "${aws_sns_topic.eventbridge_sns.arn}",
            "role_arn": "${aws_iam_role.event_bridge_sns_role.arn}",
            "input": "{\n     \"firstName\": \"John\",\n     \"lastName\": \"Smith\",\n     \"age\": 25,\n     \"address\":\n     {\n         \"streetAddress\": \"21 2nd Street\",\n         \"city\": \"New York\",\n         \"state\": \"NY\",\n         \"postalCode\": \"10021\"\n     },\n     \"phoneNumber\":\n     [\n         {\n           \"type\": \"home\",\n           \"number\": \"212 555-1234\"\n         },\n         {\n           \"type\": \"fax\",\n           \"number\": \"646 555-4567\"\n         }\n     ],\n     \"ssn\": FLAG{the-topic-is-exposure::IveBeenReadingUpOnTopics},\n }"
          }
        ]
      },
      "id": "aws_scheduler_schedule.test_eventbridge-sns"
    },
    {
      "data": {
        "resource_type": "aws_lambda_function",
        "resource_name": "producer",
        "resource_service": "lambda",
        "resource_icon": "aws/Architecture-Service-Icons_07312025/Arch_Compute/48/Arch_AWS-Lambda_48.svg",
        "filename": "challenges/Middle/data/lambda/producer/lambda_function.zip",
        "function_name": "producer",
        "role": "${aws_iam_role.producer.arn}",
        "handler": "lambda_function.lambda_handler",
        "source_code_hash": null,
        "runtime": "python3.10",
        "environment": [
          {
            "variables": {
              "TARGET_SQS_QUEUE_NAME": "${aws_sqs_queue.internal_message_bus.id}"
            }
          }
        ]
      },
      "id": "aws_lambda_function.producer"
    },
    {
      "data": {
        "resource_type": "aws_iam_role",
        "resource_name": "producer",
        "resource_service": "iam",
        "resource_icon": "aws/Architecture-Service-Icons_07312025/Arch_Security-Identity-Compliance/48/Arch_AWS-Identity-and-Access-Management_48.svg",
        "name": "producer",
        "assume_role_policy": "${jsonencode({\"Version\": \"2012-10-17\", \"Statement\": [{\"Action\": \"sts:AssumeRole\", \"Effect\": \"Allow\", \"Sid\": \"\", \"Principal\": {\"Service\": \"lambda.amazonaws.com\"}}]})}"
      },
      "id": "aws_iam_role.producer"
    },
    {
      "data": {
        "resource_type": "aws_iam_policy",
        "resource_name": "producer",
        "resource_service": "iam",
        "resource_icon": "aws/Architecture-Service-Icons_07312025/Arch_Security-Identity-Compliance/48/Arch_AWS-Identity-and-Access-Management_48.svg",
        "name": "producer",
        "path": "/",
        "description": "Low priv policy used by lambdas",
        "policy": "${jsonencode({\"Version\": \"2012-10-17\", \"Statement\": [{\"Action\": [\"logs:CreateLogGroup\", \"logs:CreateLogStream\", \"logs:PutLogEvents\"], \"Effect\": \"Allow\", \"Resource\": \"*\"}]})}"
      },
      "id": "aws_iam_policy.producer"
    },
    {
      "data": {
        "resource_type": "aws_iam_role_policy_attachment",
        "resource_name": "producer",
        "resource_service": "iam",
        "resource_icon": "aws/Architecture-Service-Icons_07312025/Arch_Security-Identity-Compliance/48/Arch_AWS-Identity-and-Access-Management_48.svg",
        "role": "${aws_iam_role.producer.name}",
        "policy_arn": "${aws_iam_policy.producer.arn}"
      },
      "id": "aws_iam_role_policy_attachment.producer"
    },
    {
      "data": {
        "resource_type": "aws_iam_policy",
        "resource_name": "lambda-viewer",
        "resource_service": "iam",
        "resource_icon": "aws/Architecture-Service-Icons_07312025/Arch_Security-Identity-Compliance/48/Arch_AWS-Identity-and-Access-Management_48.svg",
        "name": "lambda-viewer",
        "path": "/",
        "description": "this guy can read a lambda function",
        "policy": "${jsonencode({\"Version\": \"2012-10-17\", \"Statement\": [{\"Action\": [\"lambda:GetFunction\"], \"Effect\": \"Allow\", \"Resource\": \"${aws_lambda_function.producer.arn}\"}]})}"
      },
      "id": "aws_iam_policy.lambda-viewer"
    },
    {
      "data": {
        "resource_type": "aws_iam_role",
        "resource_name": "pepi",
        "resource_service": "iam",
        "resource_icon": "aws/Architecture-Service-Icons_07312025/Arch_Security-Identity-Compliance/48/Arch_AWS-Identity-and-Access-Management_48.svg",
        "name": "pepi",
        "assume_role_policy": {
          "Version": "2012-10-17",
          "Statement": [
            {
              "Sid": "AllowCTFStartingUserAssumeRole",
              "Effect": "Allow",
              "Principal": {
                "AWS": "${module.enabled.ctf_starting_user_arn}"
              },
              "Action": "sts:AssumeRole"
            }
          ]
        }
      },
      "id": "aws_iam_role.pepi"
    },
    {
      "data": {
        "resource_type": "aws_iam_role_policy_attachment",
        "resource_name": "lambda-viewer",
        "resource_service": "iam",
        "resource_icon": "aws/Architecture-Service-Icons_07312025/Arch_Security-Identity-Compliance/48/Arch_AWS-Identity-and-Access-Management_48.svg",
        "role": "${aws_iam_role.pepi.name}",
        "policy_arn": "${aws_iam_policy.lambda-viewer.arn}"
      },
      "id": "aws_iam_role_policy_attachment.lambda-viewer"
    },
    {
      "data": {
        "resource_type": "aws_sqs_queue",
        "resource_name": "internal_message_bus",
        "resource_service": "sqs",
        "resource_icon": "aws/Architecture-Service-Icons_07312025/Arch_App-Integration/48/Arch_Amazon-Simple-Queue-Service_48.svg",
        "name": "internal_message_bus",
        "delay_seconds": 90,
        "max_message_size": 2048,
        "message_retention_seconds": 86400,
        "receive_wait_time_seconds": 10,
        "redrive_policy": "${jsonencode({\"deadLetterTargetArn\": \"${aws_sqs_queue.terraform_queue_deadletter.arn}\", \"maxReceiveCount\": 4})}",
        "tags": {
          "Environment": "production"
        }
      },
      "id": "aws_sqs_queue.internal_message_bus"
    },
    {
      "data": {
        "resource_type": "aws_sqs_queue",
        "resource_name": "terraform_queue_deadletter",
        "resource_service": "sqs",
        "resource_icon": "aws/Architecture-Service-Icons_07312025/Arch_App-Integration/48/Arch_Amazon-Simple-Queue-Service_48.svg",
        "name": "terraform-example-queue-deadletter",
        "delay_seconds": 90,
        "max_message_size": 2048,
        "message_retention_seconds": 86400,
        "receive_wait_time_seconds": 10,
        "tags": {
          "Environment": "production"
        }
      },
      "id": "aws_sqs_queue.terraform_queue_deadletter"
    },
    {
      "data": {
        "resource_type": "aws_sqs_queue_policy",
        "resource_name": "schedule-event-rce-policy",
        "resource_service": "sqs",
        "resource_icon": "aws/Architecture-Service-Icons_07312025/Arch_App-Integration/48/Arch_Amazon-Simple-Queue-Service_48.svg",
        "queue_url": "${aws_sqs_queue.internal_message_bus.id}",
        "policy": "${jsonencode({\"Version\": \"2012-10-17\", \"Id\": \"sqspolicy\", \"Statement\": [{\"Sid\": \"First\", \"Effect\": \"Allow\", \"Principal\": \"*\", \"Action\": [\"sqs:SendMessage\", \"sqs:ReceiveMessage\"], \"Resource\": \"${aws_sqs_queue.internal_message_bus.arn}\", \"Condition\": {\"IpAddress\": {\"aws:SourceIp\": \"'' != \"\" ? chomp('') : chomp(None)/32\"}}}]})}"
      },
      "id": "aws_sqs_queue_policy.schedule-event-rce-policy"
    },
    {
      "data": {
        "resource_type": "aws_iam_role",
        "resource_name": "consumer",
        "resource_service": "iam",
        "resource_icon": "aws/Architecture-Service-Icons_07312025/Arch_Security-Identity-Compliance/48/Arch_AWS-Identity-and-Access-Management_48.svg",
        "name": "swanson",
        "assume_role_policy": "${jsonencode({\"Version\": \"2012-10-17\", \"Statement\": [{\"Action\": \"sts:AssumeRole\", \"Effect\": \"Allow\", \"Sid\": \"\", \"Principal\": {\"Service\": \"lambda.amazonaws.com\"}}]})}",
        "managed_policy_arns": [
          "${aws_iam_policy.lambda-sqs-secret-policy.arn}"
        ]
      },
      "id": "aws_iam_role.consumer"
    },
    {
      "data": {
        "resource_type": "aws_iam_policy",
        "resource_name": "lambda-sqs-secret-policy",
        "resource_service": "iam",
        "resource_icon": "aws/Architecture-Service-Icons_07312025/Arch_Security-Identity-Compliance/48/Arch_AWS-Identity-and-Access-Management_48.svg",
        "name": "lambda-sqs-secret-policy",
        "path": "/",
        "description": "",
        "policy": "${jsonencode({\"Version\": \"2012-10-17\", \"Statement\": [{\"Effect\": \"Allow\", \"Action\": \"ssm:GetParameter\", \"Resource\": \"${aws_ssm_parameter.lambda-sqs-secret.arn}\"}, {\"Effect\": \"Allow\", \"Action\": [\"sqs:ReceiveMessage\", \"sqs:DeleteMessage\", \"sqs:GetQueueUrl\", \"sqs:GetQueueAttributes\", \"sqs:ChangeMessageVisibility\", \"sqs:ChangeMessageVisibilityBatch\", \"sqs:DeleteMessageBatch\"], \"Resource\": \"${aws_sqs_queue.internal_message_bus.arn}\"}, {\"Effect\": \"Allow\", \"Action\": [\"logs:CreateLogGroup\", \"logs:CreateLogStream\", \"logs:PutLogEvents\"], \"Resource\": \"*\"}]})}"
      },
      "id": "aws_iam_policy.lambda-sqs-secret-policy"
    },
    {
      "data": {
        "resource_type": "aws_lambda_function",
        "resource_name": "consumer",
        "resource_service": "lambda",
        "resource_icon": "aws/Architecture-Service-Icons_07312025/Arch_Compute/48/Arch_AWS-Lambda_48.svg",
        "filename": "challenges/Middle/data/lambda/consumer/lambda_function.zip",
        "function_name": "consumer",
        "role": "${aws_iam_role.consumer.arn}",
        "handler": "lambda_function.lambda_handler",
        "source_code_hash": null,
        "runtime": "python3.10",
        "environment": [
          {
            "variables": {
              "TARGET_SQS_QUEUE_NAME": "${aws_sqs_queue.internal_message_bus.id}"
            }
          }
        ]
      },
      "id": "aws_lambda_function.consumer"
    },
    {
      "data": {
        "resource_type": "aws_lambda_event_source_mapping",
        "resource_name": "consumer_mapping",
        "resource_service": "lambda",
        "resource_icon": "aws/Architecture-Service-Icons_07312025/Arch_Compute/48/Arch_AWS-Lambda_48.svg",
        "event_source_arn": "${aws_sqs_queue.internal_message_bus.arn}",
        "function_name": "${aws_lambda_function.consumer.arn}",
        "batch_size": 1,
        "enabled": true
      },
      "id": "aws_lambda_event_source_mapping.consumer_mapping"
    },
    {
      "data": {
        "resource_type": "aws_ssm_parameter",
        "resource_name": "lambda-sqs-secret",
        "resource_service": "ssm",
        "resource_icon": "aws/Architecture-Service-Icons_07312025/Arch_Management-Governance/48/Arch_AWS-Systems-Manager_48.svg",
        "name": "/cloudfoxable/flag/lambda-sqs",
        "type": "SecureString",
        "value": "{FLAG:middle::queuesCanBeInterestingToo}"
      },
      "id": "aws_ssm_parameter.lambda-sqs-secret"
    },
    {
      "data": {
        "resource_type": "aws_instance",
        "resource_name": "wyatt",
        "resource_service": "ec2",
        "resource_icon": "aws/Architecture-Service-Icons_07312025/Arch_Compute/48/Arch_Amazon-EC2_48.svg",
        "ami": null,
        "vpc_security_group_ids": [
          "${aws_security_group.wyatt.id}"
        ],
        "iam_instance_profile": "${aws_iam_instance_profile.wyatt.name}",
        "instance_type": "t3a.nano",
        "subnet_id": "'${module.enabled.subnet_ids}'[0]",
        "user_data": "#!/bin/bash\nyum update -y\namazon-linux-extras install docker -y\nservice docker start\nusermod -a -G docker ec2-user\nchkconfig docker on\nyum install -y git\ndocker pull sethsec/nodejs-ssrf-app\ndocker run -d -p 12380:12380 sethsec/nodejs-ssrf-app 12380",
        "tags": {
          "Name": "wyatt"
        }
      },
      "id": "aws_instance.wyatt"
    },
    {
      "data": {
        "resource_type": "aws_security_group",
        "resource_name": "wyatt",
        "resource_service": "security",
        "resource_icon": "aws/Architecture-Service-Icons_07312025/Arch_Security-Identity-Compliance/48/Arch_AWS-Security-Hub_48.svg",
        "name": "wyatt",
        "description": "Cloudfox Security Group for ecs",
        "vpc_id": "${module.enabled.vpc_id}",
        "ingress": [
          {
            "from_port": 12380,
            "to_port": 12380,
            "protocol": "tcp",
            "cidr_blocks": [
              "${module.enabled.vpc_cidr}"
            ]
          }
        ],
        "egress": [
          {
            "from_port": 0,
            "to_port": 65535,
            "protocol": "tcp",
            "cidr_blocks": [
              "0.0.0.0/0"
            ]
          }
        ],
        "tags": {
          "Name": "wyatt-http",
          "Stack": "CloudFox"
        }
      },
      "id": "aws_security_group.wyatt"
    },
    {
      "data": {
        "resource_type": "aws_iam_role",
        "resource_name": "wyatt",
        "resource_service": "iam",
        "resource_icon": "aws/Architecture-Service-Icons_07312025/Arch_Security-Identity-Compliance/48/Arch_AWS-Identity-and-Access-Management_48.svg",
        "name": "wyatt",
        "assume_role_policy": "${jsonencode({\"Version\": \"2012-10-17\", \"Statement\": [{\"Action\": \"sts:AssumeRole\", \"Effect\": \"Allow\", \"Sid\": \"\", \"Principal\": {\"Service\": \"ec2.amazonaws.com\"}}]})}"
      },
      "id": "aws_iam_role.wyatt"
    },
    {
      "data": {
        "resource_type": "aws_iam_instance_profile",
        "resource_name": "wyatt",
        "resource_service": "iam",
        "resource_icon": "aws/Architecture-Service-Icons_07312025/Arch_Security-Identity-Compliance/48/Arch_AWS-Identity-and-Access-Management_48.svg",
        "name": "wyatt",
        "role": "${aws_iam_role.wyatt.name}"
      },
      "id": "aws_iam_instance_profile.wyatt"
    },
    {
      "data": {
        "resource_type": "aws_iam_policy",
        "resource_name": "wyatt",
        "resource_service": "iam",
        "resource_icon": "aws/Architecture-Service-Icons_07312025/Arch_Security-Identity-Compliance/48/Arch_AWS-Identity-and-Access-Management_48.svg",
        "name": "wyatt",
        "policy": "${jsonencode({\"Version\": \"2012-10-17\", \"Statement\": [{\"Effect\": \"Allow\", \"Action\": [\"dynamodb:GetItem\", \"dynamodb:BatchGetItem\", \"dynamodb:Query\", \"dynamodb:Scan\"], \"Resource\": [\"${aws_dynamodb_table.wyatt.arn}\"]}]})}"
      },
      "id": "aws_iam_policy.wyatt"
    },
    {
      "data": {
        "resource_type": "aws_iam_role_policy_attachment",
        "resource_name": "wyatt",
        "resource_service": "iam",
        "resource_icon": "aws/Architecture-Service-Icons_07312025/Arch_Security-Identity-Compliance/48/Arch_AWS-Identity-and-Access-Management_48.svg",
        "role": "${aws_iam_role.wyatt.name}",
        "policy_arn": "${aws_iam_policy.wyatt.arn}"
      },
      "id": "aws_iam_role_policy_attachment.wyatt"
    },
    {
      "data": {
        "resource_type": "aws_dynamodb_table",
        "resource_name": "wyatt",
        "resource_service": "dynamodb",
        "resource_icon": "aws/Architecture-Service-Icons_07312025/Arch_Database/48/Arch_Amazon-DynamoDB_48.svg",
        "name": "wyatt-table",
        "billing_mode": "PAY_PER_REQUEST",
        "hash_key": "id",
        "attribute": [
          {
            "name": "id",
            "type": "S"
          }
        ]
      },
      "id": "aws_dynamodb_table.wyatt"
    },
    {
      "data": {
        "resource_type": "null_resource",
        "resource_name": "insert_records",
        "resource_service": "terraform/terraform-logo.svg",
        "resource_icon": "terraform/terraform-logo.svg",
        "depends_on": [
          "${aws_dynamodb_table.wyatt}"
        ],
        "provisioner": [
          {
            "local-exec": {
              "command": "aws --region \"us-west-2\" --profile \"default\" dynamodb put-item --table-name ${aws_dynamodb_table.wyatt.name} --item '{\"id\": {\"S\": \"record1\"}, \"data\": {\"S\": \"Sample data 1\"}}' && \\\naws --region \"us-west-2\" --profile \"default\" dynamodb put-item --table-name ${aws_dynamodb_table.wyatt.name} --item '{\"id\": {\"S\": \"record2\"}, \"data\": {\"S\": \"Sample data 2\"}, \"ctf_flag\": {\"S\": \"FLAG{wyatt::So_Many_DBs_To_Look_Through}\"}}' && \\\naws --region \"us-west-2\" --profile \"default\" dynamodb put-item --table-name ${aws_dynamodb_table.wyatt.name} --item '{\"id\": {\"S\": \"record3\"}, \"data\": {\"S\": \"Sample data 3\"}}'"
            }
          }
        ]
      },
      "id": "null_resource.insert_records"
    },
    {
      "data": {
        "resource_type": "aws_security_group",
        "resource_name": "intra-sg-access",
        "resource_service": "security",
        "resource_icon": "aws/Architecture-Service-Icons_07312025/Arch_Security-Identity-Compliance/48/Arch_AWS-Security-Hub_48.svg",
        "name": "intra-sg-access",
        "description": "intra-sg-access",
        "vpc_id": "${module.enabled.vpc_id}",
        "egress": [
          {
            "from_port": 0,
            "to_port": 65535,
            "protocol": "tcp",
            "cidr_blocks": [
              "0.0.0.0/0"
            ]
          }
        ],
        "tags": {
          "Name": "intra-sg-access"
        }
      },
      "id": "aws_security_group.intra-sg-access"
    },
    {
      "data": {
        "resource_type": "aws_security_group_rule",
        "resource_name": "intra-sg-access-ingress",
        "resource_service": "security",
        "resource_icon": "aws/Architecture-Service-Icons_07312025/Arch_Security-Identity-Compliance/48/Arch_AWS-Security-Hub_48.svg",
        "security_group_id": "${aws_security_group.intra-sg-access.id}",
        "type": "ingress",
        "from_port": 0,
        "to_port": 65535,
        "protocol": "tcp",
        "self": true
      },
      "id": "aws_security_group_rule.intra-sg-access-ingress"
    },
    {
      "data": {
        "resource_type": "aws_instance",
        "resource_name": "bastion",
        "resource_service": "ec2",
        "resource_icon": "aws/Architecture-Service-Icons_07312025/Arch_Compute/48/Arch_Amazon-EC2_48.svg",
        "ami": null,
        "instance_type": "t3a.nano",
        "subnet_id": "'${module.enabled.subnet_ids}'[0]",
        "iam_instance_profile": "${aws_iam_instance_profile.bastion.name}",
        "associate_public_ip_address": true,
        "vpc_security_group_ids": [
          "${aws_security_group.intra-sg-access.id}"
        ],
        "tags": {
          "Name": "bastion"
        }
      },
      "id": "aws_instance.bastion"
    },
    {
      "data": {
        "resource_type": "aws_iam_role",
        "resource_name": "bastion",
        "resource_service": "iam",
        "resource_icon": "aws/Architecture-Service-Icons_07312025/Arch_Security-Identity-Compliance/48/Arch_AWS-Identity-and-Access-Management_48.svg",
        "name": "reyna",
        "assume_role_policy": "${jsonencode({\"Version\": \"2012-10-17\", \"Statement\": [{\"Action\": \"sts:AssumeRole\", \"Effect\": \"Allow\", \"Sid\": \"\", \"Principal\": {\"Service\": \"ec2.amazonaws.com\"}}]})}"
      },
      "id": "aws_iam_role.bastion"
    },
    {
      "data": {
        "resource_type": "aws_iam_role_policy_attachment",
        "resource_name": "ssmcore",
        "resource_service": "iam",
        "resource_icon": "aws/Architecture-Service-Icons_07312025/Arch_Security-Identity-Compliance/48/Arch_AWS-Identity-and-Access-Management_48.svg",
        "role": "${aws_iam_role.bastion.name}",
        "policy_arn": "arn:aws:iam::aws:policy/AmazonSSMManagedInstanceCore"
      },
      "id": "aws_iam_role_policy_attachment.ssmcore"
    },
    {
      "data": {
        "resource_type": "aws_iam_policy",
        "resource_name": "rootdeny_ssm_parameter_access",
        "resource_service": "iam",
        "resource_icon": "aws/Architecture-Service-Icons_07312025/Arch_Security-Identity-Compliance/48/Arch_AWS-Identity-and-Access-Management_48.svg",
        "name": "rootdeny_ssm_parameter_access-bastion",
        "path": "/",
        "description": "IAM policy to deny access to certain SSM permissions",
        "policy": "${jsonencode({\"Version\": \"2012-10-17\", \"Statement\": [{\"Effect\": \"Deny\", \"Action\": [\"ssm:GetParameter\", \"ssm:GetParameters\"], \"Resource\": \"*\"}]})}"
      },
      "id": "aws_iam_policy.rootdeny_ssm_parameter_access"
    },
    {
      "data": {
        "resource_type": "aws_iam_role_policy_attachment",
        "resource_name": "bastion-deny",
        "resource_service": "iam",
        "resource_icon": "aws/Architecture-Service-Icons_07312025/Arch_Security-Identity-Compliance/48/Arch_AWS-Identity-and-Access-Management_48.svg",
        "role": "${aws_iam_role.bastion.name}",
        "policy_arn": "${aws_iam_policy.rootdeny_ssm_parameter_access.arn}"
      },
      "id": "aws_iam_role_policy_attachment.bastion-deny"
    },
    {
      "data": {
        "resource_type": "aws_iam_instance_profile",
        "resource_name": "bastion",
        "resource_service": "iam",
        "resource_icon": "aws/Architecture-Service-Icons_07312025/Arch_Security-Identity-Compliance/48/Arch_AWS-Identity-and-Access-Management_48.svg",
        "name": "bastion-cloudfoxable",
        "role": "${aws_iam_role.bastion.name}"
      },
      "id": "aws_iam_instance_profile.bastion"
    },
    {
      "data": {
        "resource_type": "aws_iam_policy",
        "resource_name": "bastion-s3",
        "resource_service": "iam",
        "resource_icon": "aws/Architecture-Service-Icons_07312025/Arch_Security-Identity-Compliance/48/Arch_AWS-Identity-and-Access-Management_48.svg",
        "name": "bastion-cloudfoxable-s3",
        "description": "Allows the bastion to list and download the contents of the S3 bucket with flag",
        "policy": "${jsonencode({\"Version\": \"2012-10-17\", \"Statement\": [{\"Action\": [\"s3:ListBucket\", \"s3:GetObject\"], \"Effect\": \"Allow\", \"Resource\": [\"arn:aws:s3:::cloudfoxable-bastion-${random_string.resource-suffix.result}\", \"arn:aws:s3:::cloudfoxable-bastion-${random_string.resource-suffix.result}/*\"]}, {\"Action\": [\"s3:ListAllMyBuckets\"], \"Effect\": \"Allow\", \"Resource\": [\"arn:aws:s3:::*\"]}]})}"
      },
      "id": "aws_iam_policy.bastion-s3"
    },
    {
      "data": {
        "resource_type": "aws_iam_role_policy_attachment",
        "resource_name": "bastion-s3",
        "resource_service": "iam",
        "resource_icon": "aws/Architecture-Service-Icons_07312025/Arch_Security-Identity-Compliance/48/Arch_AWS-Identity-and-Access-Management_48.svg",
        "role": "${aws_iam_role.bastion.name}",
        "policy_arn": "${aws_iam_policy.bastion-s3.arn}"
      },
      "id": "aws_iam_role_policy_attachment.bastion-s3"
    },
    {
      "data": {
        "resource_type": "aws_s3_bucket",
        "resource_name": "cloudfoxable-bastion",
        "resource_service": "s3",
        "resource_icon": "aws/Architecture-Service-Icons_07312025/Arch_Storage/48/Arch_Amazon-Simple-Storage-Service_48.svg",
        "bucket": "cloudfoxable-bastion-${random_string.resource-suffix.result}",
        "force_destroy": true,
        "tags": {
          "Name": "cloudfoxable-bastion-${random_string.resource-suffix.result}"
        }
      },
      "id": "aws_s3_bucket.cloudfoxable-bastion"
    },
    {
      "data": {
        "resource_type": "aws_s3_bucket_public_access_block",
        "resource_name": "cloudfoxable-bastion-public-access-block",
        "resource_service": "s3",
        "resource_icon": "aws/Architecture-Service-Icons_07312025/Arch_Storage/48/Arch_Amazon-S3-on-Outposts_48.svg",
        "bucket": "${aws_s3_bucket.cloudfoxable-bastion.id}",
        "block_public_acls": true,
        "block_public_policy": true,
        "ignore_public_acls": true,
        "restrict_public_buckets": true
      },
      "id": "aws_s3_bucket_public_access_block.cloudfoxable-bastion-public-access-block"
    },
    {
      "data": {
        "resource_type": "aws_s3_object",
        "resource_name": "cloudfoxable-bastion-object",
        "resource_service": "s3",
        "resource_icon": "aws/Architecture-Service-Icons_07312025/Arch_Storage/48/Arch_Amazon-S3-on-Outposts_48.svg",
        "bucket": "${aws_s3_bucket.cloudfoxable-bastion.id}",
        "key": "flag.txt",
        "source": "./challenges/Bastion/data/flag.txt"
      },
      "id": "aws_s3_object.cloudfoxable-bastion-object"
    },
    {
      "data": {
        "resource_type": "aws_iam_policy",
        "resource_name": "bastion-ssm",
        "resource_service": "iam",
        "resource_icon": "aws/Architecture-Service-Icons_07312025/Arch_Security-Identity-Compliance/48/Arch_AWS-Identity-and-Access-Management_48.svg",
        "name": "bastion-ssm",
        "description": "Allows the ctf starting user to ssm:startsession to the bastion",
        "policy": "${jsonencode({\"Version\": \"2012-10-17\", \"Statement\": [{\"Action\": [\"ssm:StartSession\", \"ssm:SendCommand\", \"ssm:ListCommandInvocations\", \"ssm:TerminateSession\"], \"Effect\": \"Allow\", \"Resource\": [\"${aws_instance.bastion.arn}\", \"arn:aws:ssm:us-west-2::document/SSM-SessionManagerRunShell\", \"arn:aws:ssm:us-west-2::session/ctf-starting-user-*\"]}]})}"
      },
      "id": "aws_iam_policy.bastion-ssm"
    },
    {
      "data": {
        "resource_type": "aws_iam_user_policy_attachment",
        "resource_name": "bastion-ssm",
        "resource_service": "iam",
        "resource_icon": "aws/Architecture-Service-Icons_07312025/Arch_Security-Identity-Compliance/48/Arch_AWS-Identity-and-Access-Management_48.svg",
        "user": "${module.enabled.ctf_starting_user_name}",
        "policy_arn": "${aws_iam_policy.bastion-ssm.arn}"
      },
      "id": "aws_iam_user_policy_attachment.bastion-ssm"
    },
    {
      "data": {
        "resource_type": "random_password",
        "resource_name": "rds-password",
        "resource_service": "terraform/terraform-logo.svg",
        "resource_icon": "terraform/terraform-logo.svg",
        "length": 31,
        "special": true,
        "min_special": 5,
        "override_special": "!#$%^&*()-_=+[]{}<>:?",
        "keepers": {
          "pass_version": 1
        }
      },
      "id": "random_password.rds-password"
    },
    {
      "data": {
        "resource_type": "aws_db_subnet_group",
        "resource_name": "default",
        "resource_service": "rds",
        "resource_icon": "aws/Architecture-Service-Icons_07312025/Arch_Database/48/Arch_Amazon-RDS_48.svg",
        "name": "rds-subnet-group",
        "description": "Terraform example RDS subnet group",
        "subnet_ids": "${module.enabled.subnet_ids}"
      },
      "id": "aws_db_subnet_group.default"
    },
    {
      "data": {
        "resource_type": "aws_db_instance",
        "resource_name": "default",
        "resource_service": "rds",
        "resource_icon": "aws/Architecture-Service-Icons_07312025/Arch_Database/48/Arch_Amazon-RDS_48.svg",
        "allocated_storage": 5,
        "engine": "mysql",
        "engine_version": 8.0,
        "instance_class": "db.t3.micro",
        "db_name": "cloudfox${random_string.resource-suffix.result}",
        "identifier": "cloudfox-rds-${random_string.resource-suffix.result}",
        "username": "admin",
        "password": "${random_password.rds-password.result}",
        "parameter_group_name": "default.mysql8.0",
        "skip_final_snapshot": true,
        "publicly_accessible": false,
        "vpc_security_group_ids": [
          "${module.challenge_bastion[0].intra-sg-access-id}"
        ],
        "db_subnet_group_name": "${aws_db_subnet_group.default.id}"
      },
      "id": "aws_db_instance.default"
    },
    {
      "data": {
        "resource_type": "aws_lambda_function",
        "resource_name": "rds_sql_executor",
        "resource_service": "lambda",
        "resource_icon": "aws/Architecture-Service-Icons_07312025/Arch_Compute/48/Arch_AWS-Lambda_48.svg",
        "filename": "challenges/Variable/data/lambda_function.zip",
        "function_name": "rds-sql-executor",
        "runtime": "python3.9",
        "handler": "lambda_function.lambda_handler",
        "source_code_hash": "None-rds_zip.output_base64sha256",
        "role": "${aws_iam_role.lambda_execution_role.arn}",
        "timeout": 60,
        "vpc_config": [
          {
            "subnet_ids": "${module.enabled.subnet_ids}",
            "security_group_ids": [
              "${module.challenge_bastion[0].intra-sg-access-id}"
            ]
          }
        ],
        "environment": [
          {
            "variables": {
              "RDS_HOST": "${aws_db_instance.default.address}",
              "RDS_USER": "${aws_db_instance.default.username}",
              "RDS_PASSWORD": "${aws_db_instance.default.password}",
              "RDS_DB_NAME": "${aws_db_instance.default.db_name}"
            }
          }
        ]
      },
      "id": "aws_lambda_function.rds_sql_executor"
    },
    {
      "data": {
        "resource_type": "aws_iam_role",
        "resource_name": "lambda_execution_role",
        "resource_service": "iam",
        "resource_icon": "aws/Architecture-Service-Icons_07312025/Arch_Security-Identity-Compliance/48/Arch_AWS-Identity-and-Access-Management_48.svg",
        "name": "lambda_execution_role",
        "assume_role_policy": {
          "Version": "2012-10-17",
          "Statement": [
            {
              "Action": "sts:AssumeRole",
              "Principal": {
                "Service": "lambda.amazonaws.com"
              },
              "Effect": "Allow",
              "Sid": ""
            }
          ]
        }
      },
      "id": "aws_iam_role.lambda_execution_role"
    },
    {
      "data": {
        "resource_type": "aws_iam_policy",
        "resource_name": "lambda_policy",
        "resource_service": "iam",
        "resource_icon": "aws/Architecture-Service-Icons_07312025/Arch_Security-Identity-Compliance/48/Arch_AWS-Identity-and-Access-Management_48.svg",
        "name": "lambda_policy",
        "path": "/",
        "description": "Low priv policy used by lambdas",
        "policy": "${jsonencode({\"Version\": \"2012-10-17\", \"Statement\": [{\"Action\": [\"logs:CreateLogGroup\", \"logs:CreateLogStream\", \"logs:PutLogEvents\", \"ec2:CreateNetworkInterface\", \"ec2:DescribeNetworkInterfaces\", \"ec2:DeleteNetworkInterface\"], \"Effect\": \"Allow\", \"Resource\": \"*\"}]})}"
      },
      "id": "aws_iam_policy.lambda_policy"
    },
    {
      "data": {
        "resource_type": "aws_iam_role_policy_attachment",
        "resource_name": "lambda_policy_attach",
        "resource_service": "iam",
        "resource_icon": "aws/Architecture-Service-Icons_07312025/Arch_Security-Identity-Compliance/48/Arch_AWS-Identity-and-Access-Management_48.svg",
        "role": "${aws_iam_role.lambda_execution_role.name}",
        "policy_arn": "${aws_iam_policy.lambda_policy.arn}"
      },
      "id": "aws_iam_role_policy_attachment.lambda_policy_attach"
    },
    {
      "data": {
        "resource_type": "null_resource",
        "resource_name": "invoke_lambda",
        "resource_service": "terraform/terraform-logo.svg",
        "resource_icon": "terraform/terraform-logo.svg",
        "triggers": {
          "db": "${aws_db_instance.default.address}"
        },
        "provisioner": [
          {
            "local-exec": {
              "command": "aws --region us-west-2 --profile default lambda invoke --function-name ${aws_lambda_function.rds_sql_executor.function_name} response.json"
            }
          }
        ]
      },
      "id": "null_resource.invoke_lambda"
    }
  ],
  "edges": [
    {
      "id": "aws_sns_topic_policy.user_updates-aws_sns_topic.user_updates-['policy', 'Statement', '1', 'Resource']",
      "data": {
        "json_path": "policy.Statement.1.Resource",
        "raw_value": "${aws_sns_topic.user_updates.arn}"
      },
      "source": "aws_sns_topic_policy.user_updates",
      "target": "aws_sns_topic.user_updates"
    },
    {
      "id": "aws_sns_topic_policy.important_updates-aws_sns_topic.important_updates-['policy', 'Statement', '0', 'Resource']",
      "data": {
        "json_path": "policy.Statement.0.Resource",
        "raw_value": "${aws_sns_topic.important_updates.arn}"
      },
      "source": "aws_sns_topic_policy.important_updates",
      "target": "aws_sns_topic.important_updates"
    },
    {
      "id": "aws_iam_access_key.ctf-starting-user-aws_iam_user.ctf-starting-user-['user']",
      "data": {
        "json_path": "user",
        "raw_value": "${aws_iam_user.ctf-starting-user.name}"
      },
      "source": "aws_iam_access_key.ctf-starting-user",
      "target": "aws_iam_user.ctf-starting-user"
    },
    {
      "id": "aws_iam_user_policy_attachment.ctf-policy1-aws_iam_user.ctf-starting-user-['user']",
      "data": {
        "json_path": "user",
        "raw_value": "${aws_iam_user.ctf-starting-user.name}"
      },
      "source": "aws_iam_user_policy_attachment.ctf-policy1",
      "target": "aws_iam_user.ctf-starting-user"
    },
    {
      "id": "aws_iam_user_policy_attachment.ctf-policy2-aws_iam_user.ctf-starting-user-['user']",
      "data": {
        "json_path": "user",
        "raw_value": "${aws_iam_user.ctf-starting-user.name}"
      },
      "source": "aws_iam_user_policy_attachment.ctf-policy2",
      "target": "aws_iam_user.ctf-starting-user"
    },
    {
      "id": "aws_iam_user_policy_attachment.ctf-policy2-aws_iam_policy.CloudFox-policy-perms-['policy_arn']",
      "data": {
        "json_path": "policy_arn",
        "raw_value": "${aws_iam_policy.CloudFox-policy-perms.arn}"
      },
      "source": "aws_iam_user_policy_attachment.ctf-policy2",
      "target": "aws_iam_policy.CloudFox-policy-perms"
    },
    {
      "id": "aws_sqs_queue_policy.public_queue_policy-aws_sqs_queue.process_orders-['policy', 'Statement', '0', 'Resource']",
      "data": {
        "json_path": "policy.Statement.0.Resource",
        "raw_value": "${aws_sqs_queue.process_orders.arn}"
      },
      "source": "aws_sqs_queue_policy.public_queue_policy",
      "target": "aws_sqs_queue.process_orders"
    },
    {
      "id": "aws_internet_gateway.cloudfox-igw-aws_vpc.cloudfox-['vpc_id']",
      "data": {
        "json_path": "vpc_id",
        "raw_value": "${aws_vpc.cloudfox.id}"
      },
      "source": "aws_internet_gateway.cloudfox-igw",
      "target": "aws_vpc.cloudfox"
    },
    {
      "id": "aws_route_table.cloudfox-public-aws_vpc.cloudfox-['vpc_id']",
      "data": {
        "json_path": "vpc_id",
        "raw_value": "${aws_vpc.cloudfox.id}"
      },
      "source": "aws_route_table.cloudfox-public",
      "target": "aws_vpc.cloudfox"
    },
    {
      "id": "aws_route_table.cloudfox-public-aws_internet_gateway.cloudfox-igw-['route', '0', 'gateway_id']",
      "data": {
        "json_path": "route.0.gateway_id",
        "raw_value": "${aws_internet_gateway.cloudfox-igw.id}"
      },
      "source": "aws_route_table.cloudfox-public",
      "target": "aws_internet_gateway.cloudfox-igw"
    },
    {
      "id": "aws_subnet.cloudfox-operational-aws_vpc.cloudfox-['vpc_id']",
      "data": {
        "json_path": "vpc_id",
        "raw_value": "${aws_vpc.cloudfox.id}"
      },
      "source": "aws_subnet.cloudfox-operational",
      "target": "aws_vpc.cloudfox"
    },
    {
      "id": "aws_route_table_association.cloudfox-operational-aws_subnet.cloudfox-operational-['subnet_id']",
      "data": {
        "json_path": "subnet_id",
        "raw_value": "${element(aws_subnet.cloudfox-operational.*.id, count.index)}"
      },
      "source": "aws_route_table_association.cloudfox-operational",
      "target": "aws_subnet.cloudfox-operational"
    },
    {
      "id": "aws_route_table_association.cloudfox-operational-aws_route_table.cloudfox-public-['route_table_id']",
      "data": {
        "json_path": "route_table_id",
        "raw_value": "${aws_route_table.cloudfox-public.id}"
      },
      "source": "aws_route_table_association.cloudfox-operational",
      "target": "aws_route_table.cloudfox-public"
    },
    {
      "id": "aws_iam_policy.its-a-secret-policy-aws_ssm_parameter.flag-['policy']",
      "data": {
        "json_path": "policy",
        "raw_value": "${jsonencode({\"Version\": \"2012-10-17\", \"Statement\": [{\"Effect\": \"Allow\", \"Action\": [\"ssm:GetParameter\"], \"Resource\": [\"${aws_ssm_parameter.flag.arn}\"]}]})}"
      },
      "source": "aws_iam_policy.its-a-secret-policy",
      "target": "aws_ssm_parameter.flag"
    },
    {
      "id": "aws_iam_user_policy_attachment.its-a-secret-policy-attachment-aws_iam_policy.its-a-secret-policy-['policy_arn']",
      "data": {
        "json_path": "policy_arn",
        "raw_value": "${aws_iam_policy.its-a-secret-policy.arn}"
      },
      "source": "aws_iam_user_policy_attachment.its-a-secret-policy-attachment",
      "target": "aws_iam_policy.its-a-secret-policy"
    },
    {
      "id": "aws_iam_policy.its-another-secret-policy-aws_ssm_parameter.flag2-['policy']",
      "data": {
        "json_path": "policy",
        "raw_value": "${jsonencode({\"Version\": \"2012-10-17\", \"Statement\": [{\"Effect\": \"Allow\", \"Action\": [\"ssm:GetParameter\"], \"Resource\": [\"${aws_ssm_parameter.flag2.arn}\"]}]})}"
      },
      "source": "aws_iam_policy.its-another-secret-policy",
      "target": "aws_ssm_parameter.flag2"
    },
    {
      "id": "aws_iam_role_policy_attachment.its-a-secret-policy-attachment-aws_iam_role.its-another-secret-role-['role']",
      "data": {
        "json_path": "role",
        "raw_value": "${aws_iam_role.its-another-secret-role.name}"
      },
      "source": "aws_iam_role_policy_attachment.its-a-secret-policy-attachment",
      "target": "aws_iam_role.its-another-secret-role"
    },
    {
      "id": "aws_iam_role_policy_attachment.its-a-secret-policy-attachment-aws_iam_policy.its-another-secret-policy-['policy_arn']",
      "data": {
        "json_path": "policy_arn",
        "raw_value": "${aws_iam_policy.its-another-secret-policy.arn}"
      },
      "source": "aws_iam_role_policy_attachment.its-a-secret-policy-attachment",
      "target": "aws_iam_policy.its-another-secret-policy"
    },
    {
      "id": "aws_secretsmanager_secret_version.database-secret-aws_secretsmanager_secret.database-secret-['secret_id']",
      "data": {
        "json_path": "secret_id",
        "raw_value": "${aws_secretsmanager_secret.database-secret.id}"
      },
      "source": "aws_secretsmanager_secret_version.database-secret",
      "target": "aws_secretsmanager_secret.database-secret"
    },
    {
      "id": "aws_secretsmanager_secret_version.corporate-domain-admin-password-aws_secretsmanager_secret.corporate-domain-admin-password-['secret_id']",
      "data": {
        "json_path": "secret_id",
        "raw_value": "${aws_secretsmanager_secret.corporate-domain-admin-password.id}"
      },
      "source": "aws_secretsmanager_secret_version.corporate-domain-admin-password",
      "target": "aws_secretsmanager_secret.corporate-domain-admin-password"
    },
    {
      "id": "aws_iam_policy.corporate-domain-admin-password-policy-aws_secretsmanager_secret.corporate-domain-admin-password-['policy']",
      "data": {
        "json_path": "policy",
        "raw_value": "${jsonencode({\"Version\": \"2012-10-17\", \"Statement\": [{\"Effect\": \"Allow\", \"Action\": [\"secretsmanager:GetSecretValue\"], \"Resource\": [\"${aws_secretsmanager_secret.corporate-domain-admin-password.arn}\"]}]})}"
      },
      "source": "aws_iam_policy.corporate-domain-admin-password-policy",
      "target": "aws_secretsmanager_secret.corporate-domain-admin-password"
    },
    {
      "id": "aws_iam_role_policy_attachment.corporate-domain-admin-password-policy-attachment-aws_iam_role.Alexander-Arnold-['role']",
      "data": {
        "json_path": "role",
        "raw_value": "${aws_iam_role.Alexander-Arnold.name}"
      },
      "source": "aws_iam_role_policy_attachment.corporate-domain-admin-password-policy-attachment",
      "target": "aws_iam_role.Alexander-Arnold"
    },
    {
      "id": "aws_iam_role_policy_attachment.corporate-domain-admin-password-policy-attachment-aws_iam_policy.corporate-domain-admin-password-policy-['policy_arn']",
      "data": {
        "json_path": "policy_arn",
        "raw_value": "${aws_iam_policy.corporate-domain-admin-password-policy.arn}"
      },
      "source": "aws_iam_role_policy_attachment.corporate-domain-admin-password-policy-attachment",
      "target": "aws_iam_policy.corporate-domain-admin-password-policy"
    },
    {
      "id": "aws_iam_role_policy_attachment.execution-aws_iam_role.execution-['role']",
      "data": {
        "json_path": "role",
        "raw_value": "${aws_iam_role.execution.name}"
      },
      "source": "aws_iam_role_policy_attachment.execution",
      "target": "aws_iam_role.execution"
    },
    {
      "id": "aws_iam_role.executioner-role-aws_iam_policy.executioner-policy-['managed_policy_arns', '0']",
      "data": {
        "json_path": "managed_policy_arns.0",
        "raw_value": "${aws_iam_policy.executioner-policy.arn}"
      },
      "source": "aws_iam_role.executioner-role",
      "target": "aws_iam_policy.executioner-policy"
    },
    {
      "id": "aws_iam_role.executioner-role-aws_iam_policy.executioner-secret-policy-['managed_policy_arns', '1']",
      "data": {
        "json_path": "managed_policy_arns.1",
        "raw_value": "${aws_iam_policy.executioner-secret-policy.arn}"
      },
      "source": "aws_iam_role.executioner-role",
      "target": "aws_iam_policy.executioner-secret-policy"
    },
    {
      "id": "aws_iam_policy.executioner-secret-policy-aws_ssm_parameter.executioner-secret-['policy']",
      "data": {
        "json_path": "policy",
        "raw_value": "${jsonencode({\"Version\": \"2012-10-17\", \"Statement\": [{\"Effect\": \"Allow\", \"Action\": \"ssm:GetParameter\", \"Resource\": \"${aws_ssm_parameter.executioner-secret.arn}\"}]})}"
      },
      "source": "aws_iam_policy.executioner-secret-policy",
      "target": "aws_ssm_parameter.executioner-secret"
    },
    {
      "id": "aws_lambda_function.executioner-aws_iam_role.executioner-role-['role']",
      "data": {
        "json_path": "role",
        "raw_value": "${aws_iam_role.executioner-role.arn}"
      },
      "source": "aws_lambda_function.executioner",
      "target": "aws_iam_role.executioner-role"
    },
    {
      "id": "aws_sns_topic_policy.executioner-aws_sns_topic.test_sns-['policy', 'Statement', '0', 'Resource']",
      "data": {
        "json_path": "policy.Statement.0.Resource",
        "raw_value": "${aws_sns_topic.test_sns.arn}"
      },
      "source": "aws_sns_topic_policy.executioner",
      "target": "aws_sns_topic.test_sns"
    },
    {
      "id": "aws_sns_topic_subscription.test_sns_subscription-aws_sns_topic.test_sns-['topic_arn']",
      "data": {
        "json_path": "topic_arn",
        "raw_value": "${aws_sns_topic.test_sns.arn}"
      },
      "source": "aws_sns_topic_subscription.test_sns_subscription",
      "target": "aws_sns_topic.test_sns"
    },
    {
      "id": "aws_sns_topic_subscription.test_sns_subscription-aws_lambda_function.executioner-['endpoint']",
      "data": {
        "json_path": "endpoint",
        "raw_value": "${aws_lambda_function.executioner.arn}"
      },
      "source": "aws_sns_topic_subscription.test_sns_subscription",
      "target": "aws_lambda_function.executioner"
    },
    {
      "id": "aws_lambda_permission.allow_sns-aws_lambda_function.executioner-['function_name']",
      "data": {
        "json_path": "function_name",
        "raw_value": "${aws_lambda_function.executioner.function_name}"
      },
      "source": "aws_lambda_permission.allow_sns",
      "target": "aws_lambda_function.executioner"
    },
    {
      "id": "aws_lambda_permission.allow_sns-aws_sns_topic.test_sns-['source_arn']",
      "data": {
        "json_path": "source_arn",
        "raw_value": "${aws_sns_topic.test_sns.arn}"
      },
      "source": "aws_lambda_permission.allow_sns",
      "target": "aws_sns_topic.test_sns"
    },
    {
      "id": "aws_iam_policy.event_bridge_sns_rce_policy-aws_sns_topic.test_sns-['policy']",
      "data": {
        "json_path": "policy",
        "raw_value": "${jsonencode({\"Version\": \"2012-10-17\", \"Statement\": [{\"Action\": [\"logs:CreateLogGroup\", \"logs:CreateLogStream\", \"logs:PutLogEvents\", \"sns:Subscribe\", \"sns:ListSubscriptionsByTopic\", \"sns:ListTopics\", \"sns:ListSubscriptions\", \"sns:GetTopicAttributes\", \"sns:Receive\", \"sns:Publish\"], \"Effect\": \"Allow\", \"Resource\": \"${aws_sns_topic.test_sns.arn}\"}]})}"
      },
      "source": "aws_iam_policy.event_bridge_sns_rce_policy",
      "target": "aws_sns_topic.test_sns"
    },
    {
      "id": "aws_iam_role_policy_attachment.event_bridge_sns_rce_policy_attachment-aws_iam_role.event_bridge_sns_rce_role-['role']",
      "data": {
        "json_path": "role",
        "raw_value": "${aws_iam_role.event_bridge_sns_rce_role.name}"
      },
      "source": "aws_iam_role_policy_attachment.event_bridge_sns_rce_policy_attachment",
      "target": "aws_iam_role.event_bridge_sns_rce_role"
    },
    {
      "id": "aws_iam_role_policy_attachment.event_bridge_sns_rce_policy_attachment-aws_iam_policy.event_bridge_sns_rce_policy-['policy_arn']",
      "data": {
        "json_path": "policy_arn",
        "raw_value": "${aws_iam_policy.event_bridge_sns_rce_policy.arn}"
      },
      "source": "aws_iam_role_policy_attachment.event_bridge_sns_rce_policy_attachment",
      "target": "aws_iam_policy.event_bridge_sns_rce_policy"
    },
    {
      "id": "aws_scheduler_schedule.eventbridge_sns_rce-aws_sns_topic.test_sns-['target', '0', 'arn']",
      "data": {
        "json_path": "target.0.arn",
        "raw_value": "${aws_sns_topic.test_sns.arn}"
      },
      "source": "aws_scheduler_schedule.eventbridge_sns_rce",
      "target": "aws_sns_topic.test_sns"
    },
    {
      "id": "aws_scheduler_schedule.eventbridge_sns_rce-aws_iam_role.event_bridge_sns_rce_role-['target', '0', 'role_arn']",
      "data": {
        "json_path": "target.0.role_arn",
        "raw_value": "${aws_iam_role.event_bridge_sns_rce_role.arn}"
      },
      "source": "aws_scheduler_schedule.eventbridge_sns_rce",
      "target": "aws_iam_role.event_bridge_sns_rce_role"
    },
    {
      "id": "aws_iam_role_policy_attachment.root-policy1-role-attach-policy-aws_iam_role.root-role-['role']",
      "data": {
        "json_path": "role",
        "raw_value": "${aws_iam_role.root-role.name}"
      },
      "source": "aws_iam_role_policy_attachment.root-policy1-role-attach-policy",
      "target": "aws_iam_role.root-role"
    },
    {
      "id": "aws_iam_role_policy_attachment.root-policy1-role-attach-policy-aws_iam_policy.root-policy1-['policy_arn']",
      "data": {
        "json_path": "policy_arn",
        "raw_value": "${aws_iam_policy.root-policy1.arn}"
      },
      "source": "aws_iam_role_policy_attachment.root-policy1-role-attach-policy",
      "target": "aws_iam_policy.root-policy1"
    },
    {
      "id": "aws_iam_role.privesc-AssumeRole-ending-role-aws_iam_role.privesc-AssumeRole-intermediate-role-['assume_role_policy']",
      "data": {
        "json_path": "assume_role_policy",
        "raw_value": "${jsonencode({\"Version\": \"2012-10-17\", \"Statement\": [{\"Action\": \"sts:AssumeRole\", \"Effect\": \"Allow\", \"Sid\": \"\", \"Principal\": {\"AWS\": \"${aws_iam_role.privesc-AssumeRole-intermediate-role.arn}\"}}]})}"
      },
      "source": "aws_iam_role.privesc-AssumeRole-ending-role",
      "target": "aws_iam_role.privesc-AssumeRole-intermediate-role"
    },
    {
      "id": "aws_iam_policy.privesc-AssumeRole-high-priv-policy-aws_ssm_parameter.secret1-['policy']",
      "data": {
        "json_path": "policy",
        "raw_value": "${jsonencode({\"Version\": \"2012-10-17\", \"Statement\": [{\"Effect\": \"Allow\", \"Action\": \"ssm:GetParameter\", \"Resource\": \"${aws_ssm_parameter.secret1.arn}\"}]})}"
      },
      "source": "aws_iam_policy.privesc-AssumeRole-high-priv-policy",
      "target": "aws_ssm_parameter.secret1"
    },
    {
      "id": "aws_iam_role_policy_attachment.privesc-AssumeRole-high-priv-policy-role-attach-policy-aws_iam_role.privesc-AssumeRole-ending-role-['role']",
      "data": {
        "json_path": "role",
        "raw_value": "${aws_iam_role.privesc-AssumeRole-ending-role.name}"
      },
      "source": "aws_iam_role_policy_attachment.privesc-AssumeRole-high-priv-policy-role-attach-policy",
      "target": "aws_iam_role.privesc-AssumeRole-ending-role"
    },
    {
      "id": "aws_iam_role_policy_attachment.privesc-AssumeRole-high-priv-policy-role-attach-policy-aws_iam_policy.privesc-AssumeRole-high-priv-policy-['policy_arn']",
      "data": {
        "json_path": "policy_arn",
        "raw_value": "${aws_iam_policy.privesc-AssumeRole-high-priv-policy.arn}"
      },
      "source": "aws_iam_role_policy_attachment.privesc-AssumeRole-high-priv-policy-role-attach-policy",
      "target": "aws_iam_policy.privesc-AssumeRole-high-priv-policy"
    },
    {
      "id": "aws_secretsmanager_secret_version.double_tap_flag_secret_version-aws_secretsmanager_secret.double_tap_flag_secret-['secret_id']",
      "data": {
        "json_path": "secret_id",
        "raw_value": "${aws_secretsmanager_secret.double_tap_flag_secret.id}"
      },
      "source": "aws_secretsmanager_secret_version.double_tap_flag_secret_version",
      "target": "aws_secretsmanager_secret.double_tap_flag_secret"
    },
    {
      "id": "aws_iam_policy.double_tap_secret_policy-aws_secretsmanager_secret.double_tap_flag_secret-['policy']",
      "data": {
        "json_path": "policy",
        "raw_value": "${jsonencode({\"Version\": \"2012-10-17\", \"Statement\": [{\"Action\": [\"secretsmanager:GetSecretValue\", \"secretsmanager:DescribeSecret\", \"secretsmanager:ListSecretVersionIds\", \"secretsmanager:ListSecrets\"], \"Effect\": \"Allow\", \"Resource\": [\"${aws_secretsmanager_secret.double_tap_flag_secret.arn}\"]}]})}"
      },
      "source": "aws_iam_policy.double_tap_secret_policy",
      "target": "aws_secretsmanager_secret.double_tap_flag_secret"
    },
    {
      "id": "aws_iam_role_policy_attachment.double_tap_secret_policy-aws_iam_policy.double_tap_secret_policy-['policy_arn']",
      "data": {
        "json_path": "policy_arn",
        "raw_value": "${aws_iam_policy.double_tap_secret_policy.arn}"
      },
      "source": "aws_iam_role_policy_attachment.double_tap_secret_policy",
      "target": "aws_iam_policy.double_tap_secret_policy"
    },
    {
      "id": "aws_iam_role_policy_attachment.double_tap_secret_policy-aws_iam_role.double_tap_secret-['role']",
      "data": {
        "json_path": "role",
        "raw_value": "${aws_iam_role.double_tap_secret.name}"
      },
      "source": "aws_iam_role_policy_attachment.double_tap_secret_policy",
      "target": "aws_iam_role.double_tap_secret"
    },
    {
      "id": "aws_iam_role_policy_attachment.ssm_ec2_secret_policy_attachment-aws_iam_role.double_tap_secret-['role']",
      "data": {
        "json_path": "role",
        "raw_value": "${aws_iam_role.double_tap_secret.name}"
      },
      "source": "aws_iam_role_policy_attachment.ssm_ec2_secret_policy_attachment",
      "target": "aws_iam_role.double_tap_secret"
    },
    {
      "id": "aws_iam_role_policy_attachment.double-tap-deny-aws_iam_role.double_tap_secret-['role']",
      "data": {
        "json_path": "role",
        "raw_value": "${aws_iam_role.double_tap_secret.name}"
      },
      "source": "aws_iam_role_policy_attachment.double-tap-deny",
      "target": "aws_iam_role.double_tap_secret"
    },
    {
      "id": "aws_iam_role_policy_attachment.double-tap-deny-aws_iam_policy.double_tap_deny_ssm_parameter_access-['policy_arn']",
      "data": {
        "json_path": "policy_arn",
        "raw_value": "${aws_iam_policy.double_tap_deny_ssm_parameter_access.arn}"
      },
      "source": "aws_iam_role_policy_attachment.double-tap-deny",
      "target": "aws_iam_policy.double_tap_deny_ssm_parameter_access"
    },
    {
      "id": "aws_instance.flag-aws_iam_instance_profile.double_tap_secret_profile-['iam_instance_profile']",
      "data": {
        "json_path": "iam_instance_profile",
        "raw_value": "${aws_iam_instance_profile.double_tap_secret_profile.name}"
      },
      "source": "aws_instance.flag",
      "target": "aws_iam_instance_profile.double_tap_secret_profile"
    },
    {
      "id": "aws_iam_instance_profile.double_tap_secret_profile-aws_iam_role.double_tap_secret-['role']",
      "data": {
        "json_path": "role",
        "raw_value": "${aws_iam_role.double_tap_secret.name}"
      },
      "source": "aws_iam_instance_profile.double_tap_secret_profile",
      "target": "aws_iam_role.double_tap_secret"
    },
    {
      "id": "aws_iam_role_policy_attachment.ec2_privileged_policy-aws_iam_policy.ec2_privileged_policy-['policy_arn']",
      "data": {
        "json_path": "policy_arn",
        "raw_value": "${aws_iam_policy.ec2_privileged_policy.arn}"
      },
      "source": "aws_iam_role_policy_attachment.ec2_privileged_policy",
      "target": "aws_iam_policy.ec2_privileged_policy"
    },
    {
      "id": "aws_iam_role_policy_attachment.ec2_privileged_policy-aws_iam_role.ec2_privileged-['role']",
      "data": {
        "json_path": "role",
        "raw_value": "${aws_iam_role.ec2_privileged.name}"
      },
      "source": "aws_iam_role_policy_attachment.ec2_privileged_policy",
      "target": "aws_iam_role.ec2_privileged"
    },
    {
      "id": "aws_instance.ec2-aws_iam_instance_profile.ec2_privileged_profile-['iam_instance_profile']",
      "data": {
        "json_path": "iam_instance_profile",
        "raw_value": "${aws_iam_instance_profile.ec2_privileged_profile.name}"
      },
      "source": "aws_instance.ec2",
      "target": "aws_iam_instance_profile.ec2_privileged_profile"
    },
    {
      "id": "aws_iam_instance_profile.ec2_privileged_profile-aws_iam_role.ec2_privileged-['role']",
      "data": {
        "json_path": "role",
        "raw_value": "${aws_iam_role.ec2_privileged.name}"
      },
      "source": "aws_iam_instance_profile.ec2_privileged_profile",
      "target": "aws_iam_role.ec2_privileged"
    },
    {
      "id": "aws_iam_role_policy_attachment.double_tap_iam_policy_attachment-aws_iam_policy.double_tap_iam_policy-['policy_arn']",
      "data": {
        "json_path": "policy_arn",
        "raw_value": "${aws_iam_policy.double_tap_iam_policy.arn}"
      },
      "source": "aws_iam_role_policy_attachment.double_tap_iam_policy_attachment",
      "target": "aws_iam_policy.double_tap_iam_policy"
    },
    {
      "id": "aws_iam_role_policy_attachment.double_tap_iam_policy_attachment-aws_iam_role.double_tap_xsdf-['role']",
      "data": {
        "json_path": "role",
        "raw_value": "${aws_iam_role.double_tap_xsdf.name}"
      },
      "source": "aws_iam_role_policy_attachment.double_tap_iam_policy_attachment",
      "target": "aws_iam_role.double_tap_xsdf"
    },
    {
      "id": "aws_iam_role_policy_attachment.lambda_ec2_policy-aws_iam_policy.lambda_ec2_policy-['policy_arn']",
      "data": {
        "json_path": "policy_arn",
        "raw_value": "${aws_iam_policy.lambda_ec2_policy.arn}"
      },
      "source": "aws_iam_role_policy_attachment.lambda_ec2_policy",
      "target": "aws_iam_policy.lambda_ec2_policy"
    },
    {
      "id": "aws_iam_role_policy_attachment.lambda_ec2_policy-aws_iam_role.lambda_ec2-['role']",
      "data": {
        "json_path": "role",
        "raw_value": "${aws_iam_role.lambda_ec2.name}"
      },
      "source": "aws_iam_role_policy_attachment.lambda_ec2_policy",
      "target": "aws_iam_role.lambda_ec2"
    },
    {
      "id": "aws_iam_role_policy_attachment.lambda_ec2_read_policy-aws_iam_role.lambda_ec2-['role']",
      "data": {
        "json_path": "role",
        "raw_value": "${aws_iam_role.lambda_ec2.name}"
      },
      "source": "aws_iam_role_policy_attachment.lambda_ec2_read_policy",
      "target": "aws_iam_role.lambda_ec2"
    },
    {
      "id": "aws_iam_role_policy_attachment.role-policy-attachment3-aws_iam_role.ramos-['role']",
      "data": {
        "json_path": "role",
        "raw_value": "${aws_iam_role.ramos.name}"
      },
      "source": "aws_iam_role_policy_attachment.role-policy-attachment3",
      "target": "aws_iam_role.ramos"
    },
    {
      "id": "aws_iam_role_policy_attachment.role-policy-attachment2-aws_iam_role.ramos-['role']",
      "data": {
        "json_path": "role",
        "raw_value": "${aws_iam_role.ramos.name}"
      },
      "source": "aws_iam_role_policy_attachment.role-policy-attachment2",
      "target": "aws_iam_role.ramos"
    },
    {
      "id": "aws_iam_role_policy_attachment.role-policy-attachment1-aws_iam_role.ramos-['role']",
      "data": {
        "json_path": "role",
        "raw_value": "${aws_iam_role.ramos.name}"
      },
      "source": "aws_iam_role_policy_attachment.role-policy-attachment1",
      "target": "aws_iam_role.ramos"
    },
    {
      "id": "aws_iam_role_policy_attachment.pain-policy-attachment-aws_iam_role.pain-['role']",
      "data": {
        "json_path": "role",
        "raw_value": "${aws_iam_role.pain.name}"
      },
      "source": "aws_iam_role_policy_attachment.pain-policy-attachment",
      "target": "aws_iam_role.pain"
    },
    {
      "id": "aws_iam_role_policy_attachment.pain-policy-attachment-aws_iam_policy.pain-policy-['policy_arn']",
      "data": {
        "json_path": "policy_arn",
        "raw_value": "${aws_iam_policy.pain-policy.arn}"
      },
      "source": "aws_iam_role_policy_attachment.pain-policy-attachment",
      "target": "aws_iam_policy.pain-policy"
    },
    {
      "id": "aws_iam_role_policy_attachment.pulisic-ec2-policy-attachment-aws_iam_role.pain-['role']",
      "data": {
        "json_path": "role",
        "raw_value": "${aws_iam_role.pain.name}"
      },
      "source": "aws_iam_role_policy_attachment.pulisic-ec2-policy-attachment",
      "target": "aws_iam_role.pain"
    },
    {
      "id": "aws_iam_role_policy_attachment.pulisic-cloudformation-policy-attachment-aws_iam_role.pain-['role']",
      "data": {
        "json_path": "role",
        "raw_value": "${aws_iam_role.pain.name}"
      },
      "source": "aws_iam_role_policy_attachment.pulisic-cloudformation-policy-attachment",
      "target": "aws_iam_role.pain"
    },
    {
      "id": "aws_iam_role_policy_attachment.pulisic-opsworks-policy-attachment-aws_iam_role.pain-['role']",
      "data": {
        "json_path": "role",
        "raw_value": "${aws_iam_role.pain.name}"
      },
      "source": "aws_iam_role_policy_attachment.pulisic-opsworks-policy-attachment",
      "target": "aws_iam_role.pain"
    },
    {
      "id": "aws_iam_role_policy_attachment.pain2-policy-attachment-aws_iam_role.pain2-['role']",
      "data": {
        "json_path": "role",
        "raw_value": "${aws_iam_role.pain2.name}"
      },
      "source": "aws_iam_role_policy_attachment.pain2-policy-attachment",
      "target": "aws_iam_role.pain2"
    },
    {
      "id": "aws_iam_role_policy_attachment.pain2-deny-policy-attachment-aws_iam_role.pain2-['role']",
      "data": {
        "json_path": "role",
        "raw_value": "${aws_iam_role.pain2.name}"
      },
      "source": "aws_iam_role_policy_attachment.pain2-deny-policy-attachment",
      "target": "aws_iam_role.pain2"
    },
    {
      "id": "aws_iam_role_policy_attachment.pain2-deny-policy-attachment-aws_iam_policy.pain2-deny-policy-['policy_arn']",
      "data": {
        "json_path": "policy_arn",
        "raw_value": "${aws_iam_policy.pain2-deny-policy.arn}"
      },
      "source": "aws_iam_role_policy_attachment.pain2-deny-policy-attachment",
      "target": "aws_iam_policy.pain2-deny-policy"
    },
    {
      "id": "aws_iam_role_policy_attachment.pain3-policy-attachment-aws_iam_role.pain3-['role']",
      "data": {
        "json_path": "role",
        "raw_value": "${aws_iam_role.pain3.name}"
      },
      "source": "aws_iam_role_policy_attachment.pain3-policy-attachment",
      "target": "aws_iam_role.pain3"
    },
    {
      "id": "aws_iam_role_policy_attachment.pain3-policy-attachment-aws_iam_policy.pain3-ec2-policy-['policy_arn']",
      "data": {
        "json_path": "policy_arn",
        "raw_value": "${aws_iam_policy.pain3-ec2-policy.arn}"
      },
      "source": "aws_iam_role_policy_attachment.pain3-policy-attachment",
      "target": "aws_iam_policy.pain3-ec2-policy"
    },
    {
      "id": "aws_iam_role_policy_attachment.pain3-lambda-policy-attachment-aws_iam_role.pain3-['role']",
      "data": {
        "json_path": "role",
        "raw_value": "${aws_iam_role.pain3.name}"
      },
      "source": "aws_iam_role_policy_attachment.pain3-lambda-policy-attachment",
      "target": "aws_iam_role.pain3"
    },
    {
      "id": "aws_iam_instance_profile.pain4-instance-profile-aws_iam_role.pain4-['role']",
      "data": {
        "json_path": "role",
        "raw_value": "${aws_iam_role.pain4.name}"
      },
      "source": "aws_iam_instance_profile.pain4-instance-profile",
      "target": "aws_iam_role.pain4"
    },
    {
      "id": "aws_iam_policy.pain4-policy-aws_s3_bucket.pain-s3-['policy']",
      "data": {
        "json_path": "policy",
        "raw_value": "${jsonencode({\"Version\": \"2012-10-17\", \"Statement\": [{\"Effect\": \"Allow\", \"Action\": [\"s3:GetObject\", \"s3:ListBucket\"], \"Resource\": [\"${aws_s3_bucket.pain-s3.arn}\", \"${aws_s3_bucket.pain-s3.arn}/*\"]}, {\"Effect\": \"Allow\", \"Action\": [\"s3:ListAllMyBuckets\"], \"Resource\": [\"*\"]}]})}"
      },
      "source": "aws_iam_policy.pain4-policy",
      "target": "aws_s3_bucket.pain-s3"
    },
    {
      "id": "aws_iam_role_policy_attachment.pain4-policy-attachment-aws_iam_role.pain4-['role']",
      "data": {
        "json_path": "role",
        "raw_value": "${aws_iam_role.pain4.name}"
      },
      "source": "aws_iam_role_policy_attachment.pain4-policy-attachment",
      "target": "aws_iam_role.pain4"
    },
    {
      "id": "aws_iam_role_policy_attachment.pain4-policy-attachment-aws_iam_policy.pain4-policy-['policy_arn']",
      "data": {
        "json_path": "policy_arn",
        "raw_value": "${aws_iam_policy.pain4-policy.arn}"
      },
      "source": "aws_iam_role_policy_attachment.pain4-policy-attachment",
      "target": "aws_iam_policy.pain4-policy"
    },
    {
      "id": "aws_s3_object.pain-s3-object-aws_s3_bucket.pain-s3-['bucket']",
      "data": {
        "json_path": "bucket",
        "raw_value": "${aws_s3_bucket.pain-s3.id}"
      },
      "source": "aws_s3_object.pain-s3-object",
      "target": "aws_s3_bucket.pain-s3"
    },
    {
      "id": "aws_iam_policy.authorized_deployers-aws_s3_bucket.deployment-automation-['policy']",
      "data": {
        "json_path": "policy",
        "raw_value": "${jsonencode({\"Version\": \"2012-10-17\", \"Statement\": [{\"Effect\": \"Allow\", \"Action\": [\"sts:AssumeRole\"], \"Resource\": [\"arn:aws:iam:::role/deployment_automation\", \"arn:aws:iam::992382614597:role/*\"]}, {\"Effect\": \"Allow\", \"Action\": [\"s3:GetObject\", \"s3:ListBucket\"], \"Resource\": [\"${aws_s3_bucket.deployment-automation.arn}\", \"${aws_s3_bucket.deployment-automation.arn}/*\"]}]})}"
      },
      "source": "aws_iam_policy.authorized_deployers",
      "target": "aws_s3_bucket.deployment-automation"
    },
    {
      "id": "aws_iam_role_policy_attachment.authorized_deployers-attachment-aws_iam_role.reinier-['role']",
      "data": {
        "json_path": "role",
        "raw_value": "${aws_iam_role.reinier.name}"
      },
      "source": "aws_iam_role_policy_attachment.authorized_deployers-attachment",
      "target": "aws_iam_role.reinier"
    },
    {
      "id": "aws_iam_role_policy_attachment.authorized_deployers-attachment-aws_iam_policy.authorized_deployers-['policy_arn']",
      "data": {
        "json_path": "policy_arn",
        "raw_value": "${aws_iam_policy.authorized_deployers.arn}"
      },
      "source": "aws_iam_role_policy_attachment.authorized_deployers-attachment",
      "target": "aws_iam_policy.authorized_deployers"
    },
    {
      "id": "aws_iam_role_policy_attachment.security_audit-attachment-aws_iam_role.reinier-['role']",
      "data": {
        "json_path": "role",
        "raw_value": "${aws_iam_role.reinier.name}"
      },
      "source": "aws_iam_role_policy_attachment.security_audit-attachment",
      "target": "aws_iam_role.reinier"
    },
    {
      "id": "aws_secretsmanager_secret_version.SegueFlag-aws_secretsmanager_secret.SegueFlag-['secret_id']",
      "data": {
        "json_path": "secret_id",
        "raw_value": "${aws_secretsmanager_secret.SegueFlag.id}"
      },
      "source": "aws_secretsmanager_secret_version.SegueFlag",
      "target": "aws_secretsmanager_secret.SegueFlag"
    },
    {
      "id": "aws_iam_role_policy_attachment.deployment_automation-attachment-aws_iam_role.deployment_automation-['role']",
      "data": {
        "json_path": "role",
        "raw_value": "${aws_iam_role.deployment_automation.name}"
      },
      "source": "aws_iam_role_policy_attachment.deployment_automation-attachment",
      "target": "aws_iam_role.deployment_automation"
    },
    {
      "id": "aws_iam_role_policy_attachment.deployment_automation-attachment-aws_iam_policy.deployment_automation-['policy_arn']",
      "data": {
        "json_path": "policy_arn",
        "raw_value": "${aws_iam_policy.deployment_automation.arn}"
      },
      "source": "aws_iam_role_policy_attachment.deployment_automation-attachment",
      "target": "aws_iam_policy.deployment_automation"
    },
    {
      "id": "aws_iam_policy.secret_reader-aws_secretsmanager_secret.SegueFlag-['policy']",
      "data": {
        "json_path": "policy",
        "raw_value": "${jsonencode({\"Version\": \"2012-10-17\", \"Statement\": [{\"Effect\": \"Allow\", \"Action\": [\"secretsmanager:ListSecrets\"], \"Resource\": \"*\"}, {\"Effect\": \"Allow\", \"Action\": [\"secretsmanager:GetSecretValue\"], \"Resource\": \"${aws_secretsmanager_secret.SegueFlag.arn}\"}]})}"
      },
      "source": "aws_iam_policy.secret_reader",
      "target": "aws_secretsmanager_secret.SegueFlag"
    },
    {
      "id": "aws_iam_role_policy_attachment.secret_reader-attachment-aws_iam_role.secret_reader-['role']",
      "data": {
        "json_path": "role",
        "raw_value": "${aws_iam_role.secret_reader.name}"
      },
      "source": "aws_iam_role_policy_attachment.secret_reader-attachment",
      "target": "aws_iam_role.secret_reader"
    },
    {
      "id": "aws_iam_role_policy_attachment.secret_reader-attachment-aws_iam_policy.secret_reader-['policy_arn']",
      "data": {
        "json_path": "policy_arn",
        "raw_value": "${aws_iam_policy.secret_reader.arn}"
      },
      "source": "aws_iam_role_policy_attachment.secret_reader-attachment",
      "target": "aws_iam_policy.secret_reader"
    },
    {
      "id": "aws_s3_bucket_public_access_block.deployment-automation-public-access-block-aws_s3_bucket.deployment-automation-['bucket']",
      "data": {
        "json_path": "bucket",
        "raw_value": "${aws_s3_bucket.deployment-automation.id}"
      },
      "source": "aws_s3_bucket_public_access_block.deployment-automation-public-access-block",
      "target": "aws_s3_bucket.deployment-automation"
    },
    {
      "id": "aws_s3_object.deployment-automation-object-aws_s3_bucket.deployment-automation-['bucket']",
      "data": {
        "json_path": "bucket",
        "raw_value": "${aws_s3_bucket.deployment-automation.id}"
      },
      "source": "aws_s3_object.deployment-automation-object",
      "target": "aws_s3_bucket.deployment-automation"
    },
    {
      "id": "aws_s3_object.deployment-automation-object-2-aws_s3_bucket.deployment-automation-['bucket']",
      "data": {
        "json_path": "bucket",
        "raw_value": "${aws_s3_bucket.deployment-automation.id}"
      },
      "source": "aws_s3_object.deployment-automation-object-2",
      "target": "aws_s3_bucket.deployment-automation"
    },
    {
      "id": "null_resource.upload_logs-aws_elasticsearch_domain.pat-['provisioner', '0', 'local-exec', 'command']",
      "data": {
        "json_path": "provisioner.0.local-exec.command",
        "raw_value": "curl -X POST \"${aws_elasticsearch_domain.pat.endpoint}/webserver-logs/_doc/\" -H 'Content-Type: application/json' -d '{\"timestamp\": \"2023-04-25T01:02:00Z\", \"log\": \"192.0.2.44 - - [25/Apr/2023:01:02:00 +0000] \"GET /app/database HTTP/1.1\" 200 7189\", \"source_ip\": \"192.0.2.44\"}' && \\\ncurl -X POST \"${aws_elasticsearch_domain.pat.endpoint}/webserver-logs/_doc/\" -H 'Content-Type: application/json' -d '{\"timestamp\": \"2023-04-25T01:00:00Z\", \"log\": \"192.0.2.42 - - [25/Apr/2023:01:04:00 +0000] \"GET /app/login?session_id=abc123&ctf_flag=FLAG{search1::You_will_find_the_craziest_stuff_in_elasticsearch_sometimes} HTTP/1.1\" 200 5123\", \"source_ip\": \"192.0.2.4\"}' && \\\ncurl -X POST \"${aws_elasticsearch_domain.pat.endpoint}/webserver-logs/_doc/\" -H 'Content-Type: application/json' -d '{\"timestamp\": \"2023-04-25T01:01:00Z\", \"log\": \"192.0.2.43 - - [25/Apr/2023:01:01:00 +0000] \"GET /app/data?token=Z2l0aHViX3BhdF8xMUE3UEdORVEwUHhZTFNNNm1MWnplXzlTZnBDeFVZV0ZycXJEMlp0V2NZZjRySmFEYkNKMXQ5S0VCUWNOUUM5VjNSUElZT1VST0sxQzl5WTdKCg== HTTP/1.1\" 200 6145\", \"source_ip\": \"192.0.2.43\"}' && \\\ncurl -X POST \"${aws_elasticsearch_domain.pat.endpoint}/webserver-logs/_doc/\" -H 'Content-Type: application/json' -d '{\"timestamp\": \"2023-04-25T01:02:00Z\", \"log\": \"192.0.2.44 - - [25/Apr/2023:01:02:00 +0000] \"GET /app/profile HTTP/1.1\" 200 7189\", \"source_ip\": \"192.0.2.44\"}'"
      },
      "source": "null_resource.upload_logs",
      "target": "aws_elasticsearch_domain.pat"
    },
    {
      "id": "aws_lambda_function.furls1-aws_iam_role.furls1-['role']",
      "data": {
        "json_path": "role",
        "raw_value": "${aws_iam_role.furls1.arn}"
      },
      "source": "aws_lambda_function.furls1",
      "target": "aws_iam_role.furls1"
    },
    {
      "id": "aws_iam_role.furls1-aws_iam_policy.furls1-['managed_policy_arns', '0']",
      "data": {
        "json_path": "managed_policy_arns.0",
        "raw_value": "${aws_iam_policy.furls1.arn}"
      },
      "source": "aws_iam_role.furls1",
      "target": "aws_iam_policy.furls1"
    },
    {
      "id": "aws_lambda_function_url.furls1-aws_lambda_function.furls1-['function_name']",
      "data": {
        "json_path": "function_name",
        "raw_value": "${aws_lambda_function.furls1.function_name}"
      },
      "source": "aws_lambda_function_url.furls1",
      "target": "aws_lambda_function.furls1"
    },
    {
      "id": "aws_lambda_function.auth-me-aws_iam_role.furls2-['role']",
      "data": {
        "json_path": "role",
        "raw_value": "${aws_iam_role.furls2.arn}"
      },
      "source": "aws_lambda_function.auth-me",
      "target": "aws_iam_role.furls2"
    },
    {
      "id": "aws_iam_role.furls2-aws_iam_policy.furls2-['managed_policy_arns', '0']",
      "data": {
        "json_path": "managed_policy_arns.0",
        "raw_value": "${aws_iam_policy.furls2.arn}"
      },
      "source": "aws_iam_role.furls2",
      "target": "aws_iam_policy.furls2"
    },
    {
      "id": "aws_lambda_function_url.furls2-aws_lambda_function.auth-me-['function_name']",
      "data": {
        "json_path": "function_name",
        "raw_value": "${aws_lambda_function.auth-me.function_name}"
      },
      "source": "aws_lambda_function_url.furls2",
      "target": "aws_lambda_function.auth-me"
    },
    {
      "id": "aws_iam_role_policy_attachment.mewis-aws_iam_role.mewis-['role']",
      "data": {
        "json_path": "role",
        "raw_value": "${aws_iam_role.mewis.name}"
      },
      "source": "aws_iam_role_policy_attachment.mewis",
      "target": "aws_iam_role.mewis"
    },
    {
      "id": "aws_iam_role_policy_attachment.mewis-aws_iam_policy.mewis-['policy_arn']",
      "data": {
        "json_path": "policy_arn",
        "raw_value": "${aws_iam_policy.mewis.arn}"
      },
      "source": "aws_iam_role_policy_attachment.mewis",
      "target": "aws_iam_policy.mewis"
    },
    {
      "id": "aws_iam_policy.sns_publish_policy-aws_sns_topic.eventbridge_sns-['policy']",
      "data": {
        "json_path": "policy",
        "raw_value": "${jsonencode({\"Version\": \"2012-10-17\", \"Statement\": [{\"Effect\": \"Allow\", \"Action\": \"sns:Publish\", \"Resource\": \"${aws_sns_topic.eventbridge_sns.arn}\"}]})}"
      },
      "source": "aws_iam_policy.sns_publish_policy",
      "target": "aws_sns_topic.eventbridge_sns"
    },
    {
      "id": "aws_iam_role_policy_attachment.sns_publish_policy_attachment-aws_iam_role.event_bridge_sns_role-['role']",
      "data": {
        "json_path": "role",
        "raw_value": "${aws_iam_role.event_bridge_sns_role.name}"
      },
      "source": "aws_iam_role_policy_attachment.sns_publish_policy_attachment",
      "target": "aws_iam_role.event_bridge_sns_role"
    },
    {
      "id": "aws_iam_role_policy_attachment.sns_publish_policy_attachment-aws_iam_policy.sns_publish_policy-['policy_arn']",
      "data": {
        "json_path": "policy_arn",
        "raw_value": "${aws_iam_policy.sns_publish_policy.arn}"
      },
      "source": "aws_iam_role_policy_attachment.sns_publish_policy_attachment",
      "target": "aws_iam_policy.sns_publish_policy"
    },
    {
      "id": "aws_sns_topic_policy.schedule-event-policy-aws_sns_topic.eventbridge_sns-['policy']",
      "data": {
        "json_path": "policy",
        "raw_value": "${jsonencode({\"Version\": \"2012-10-17\", \"Id\": \"snspolicy\", \"Statement\": [{\"Sid\": \"First\", \"Effect\": \"Allow\", \"Principal\": \"*\", \"Action\": [\"sns:Subscribe\", \"sns:Publish\"], \"Resource\": \"${aws_sns_topic.eventbridge_sns.arn}\", \"Condition\": {\"IpAddress\": {\"aws:SourceIp\": \"'' != \"\" ? chomp('') : chomp(None)/32\"}}}]})}"
      },
      "source": "aws_sns_topic_policy.schedule-event-policy",
      "target": "aws_sns_topic.eventbridge_sns"
    },
    {
      "id": "aws_scheduler_schedule.test_eventbridge-sns-aws_sns_topic.eventbridge_sns-['target', '0', 'arn']",
      "data": {
        "json_path": "target.0.arn",
        "raw_value": "${aws_sns_topic.eventbridge_sns.arn}"
      },
      "source": "aws_scheduler_schedule.test_eventbridge-sns",
      "target": "aws_sns_topic.eventbridge_sns"
    },
    {
      "id": "aws_scheduler_schedule.test_eventbridge-sns-aws_iam_role.event_bridge_sns_role-['target', '0', 'role_arn']",
      "data": {
        "json_path": "target.0.role_arn",
        "raw_value": "${aws_iam_role.event_bridge_sns_role.arn}"
      },
      "source": "aws_scheduler_schedule.test_eventbridge-sns",
      "target": "aws_iam_role.event_bridge_sns_role"
    },
    {
      "id": "aws_lambda_function.producer-aws_iam_role.producer-['role']",
      "data": {
        "json_path": "role",
        "raw_value": "${aws_iam_role.producer.arn}"
      },
      "source": "aws_lambda_function.producer",
      "target": "aws_iam_role.producer"
    },
    {
      "id": "aws_lambda_function.producer-aws_sqs_queue.internal_message_bus-['environment', '0', 'variables', 'TARGET_SQS_QUEUE_NAME']",
      "data": {
        "json_path": "environment.0.variables.TARGET_SQS_QUEUE_NAME",
        "raw_value": "${aws_sqs_queue.internal_message_bus.id}"
      },
      "source": "aws_lambda_function.producer",
      "target": "aws_sqs_queue.internal_message_bus"
    },
    {
      "id": "aws_iam_role_policy_attachment.producer-aws_iam_role.producer-['role']",
      "data": {
        "json_path": "role",
        "raw_value": "${aws_iam_role.producer.name}"
      },
      "source": "aws_iam_role_policy_attachment.producer",
      "target": "aws_iam_role.producer"
    },
    {
      "id": "aws_iam_role_policy_attachment.producer-aws_iam_policy.producer-['policy_arn']",
      "data": {
        "json_path": "policy_arn",
        "raw_value": "${aws_iam_policy.producer.arn}"
      },
      "source": "aws_iam_role_policy_attachment.producer",
      "target": "aws_iam_policy.producer"
    },
    {
      "id": "aws_iam_policy.lambda-viewer-aws_lambda_function.producer-['policy']",
      "data": {
        "json_path": "policy",
        "raw_value": "${jsonencode({\"Version\": \"2012-10-17\", \"Statement\": [{\"Action\": [\"lambda:GetFunction\"], \"Effect\": \"Allow\", \"Resource\": \"${aws_lambda_function.producer.arn}\"}]})}"
      },
      "source": "aws_iam_policy.lambda-viewer",
      "target": "aws_lambda_function.producer"
    },
    {
      "id": "aws_iam_role_policy_attachment.lambda-viewer-aws_iam_role.pepi-['role']",
      "data": {
        "json_path": "role",
        "raw_value": "${aws_iam_role.pepi.name}"
      },
      "source": "aws_iam_role_policy_attachment.lambda-viewer",
      "target": "aws_iam_role.pepi"
    },
    {
      "id": "aws_iam_role_policy_attachment.lambda-viewer-aws_iam_policy.lambda-viewer-['policy_arn']",
      "data": {
        "json_path": "policy_arn",
        "raw_value": "${aws_iam_policy.lambda-viewer.arn}"
      },
      "source": "aws_iam_role_policy_attachment.lambda-viewer",
      "target": "aws_iam_policy.lambda-viewer"
    },
    {
      "id": "aws_sqs_queue.internal_message_bus-aws_sqs_queue.terraform_queue_deadletter-['redrive_policy']",
      "data": {
        "json_path": "redrive_policy",
        "raw_value": "${jsonencode({\"deadLetterTargetArn\": \"${aws_sqs_queue.terraform_queue_deadletter.arn}\", \"maxReceiveCount\": 4})}"
      },
      "source": "aws_sqs_queue.internal_message_bus",
      "target": "aws_sqs_queue.terraform_queue_deadletter"
    },
    {
      "id": "aws_sqs_queue_policy.schedule-event-rce-policy-aws_sqs_queue.internal_message_bus-['policy']",
      "data": {
        "json_path": "policy",
        "raw_value": "${jsonencode({\"Version\": \"2012-10-17\", \"Id\": \"sqspolicy\", \"Statement\": [{\"Sid\": \"First\", \"Effect\": \"Allow\", \"Principal\": \"*\", \"Action\": [\"sqs:SendMessage\", \"sqs:ReceiveMessage\"], \"Resource\": \"${aws_sqs_queue.internal_message_bus.arn}\", \"Condition\": {\"IpAddress\": {\"aws:SourceIp\": \"'' != \"\" ? chomp('') : chomp(None)/32\"}}}]})}"
      },
      "source": "aws_sqs_queue_policy.schedule-event-rce-policy",
      "target": "aws_sqs_queue.internal_message_bus"
    },
    {
      "id": "aws_iam_role.consumer-aws_iam_policy.lambda-sqs-secret-policy-['managed_policy_arns', '0']",
      "data": {
        "json_path": "managed_policy_arns.0",
        "raw_value": "${aws_iam_policy.lambda-sqs-secret-policy.arn}"
      },
      "source": "aws_iam_role.consumer",
      "target": "aws_iam_policy.lambda-sqs-secret-policy"
    },
    {
      "id": "aws_iam_policy.lambda-sqs-secret-policy-aws_ssm_parameter.lambda-sqs-secret-['policy']",
      "data": {
        "json_path": "policy",
        "raw_value": "${jsonencode({\"Version\": \"2012-10-17\", \"Statement\": [{\"Effect\": \"Allow\", \"Action\": \"ssm:GetParameter\", \"Resource\": \"${aws_ssm_parameter.lambda-sqs-secret.arn}\"}, {\"Effect\": \"Allow\", \"Action\": [\"sqs:ReceiveMessage\", \"sqs:DeleteMessage\", \"sqs:GetQueueUrl\", \"sqs:GetQueueAttributes\", \"sqs:ChangeMessageVisibility\", \"sqs:ChangeMessageVisibilityBatch\", \"sqs:DeleteMessageBatch\"], \"Resource\": \"${aws_sqs_queue.internal_message_bus.arn}\"}, {\"Effect\": \"Allow\", \"Action\": [\"logs:CreateLogGroup\", \"logs:CreateLogStream\", \"logs:PutLogEvents\"], \"Resource\": \"*\"}]})}"
      },
      "source": "aws_iam_policy.lambda-sqs-secret-policy",
      "target": "aws_ssm_parameter.lambda-sqs-secret"
    },
    {
      "id": "aws_iam_policy.lambda-sqs-secret-policy-aws_sqs_queue.internal_message_bus-['policy']",
      "data": {
        "json_path": "policy",
        "raw_value": "${jsonencode({\"Version\": \"2012-10-17\", \"Statement\": [{\"Effect\": \"Allow\", \"Action\": \"ssm:GetParameter\", \"Resource\": \"${aws_ssm_parameter.lambda-sqs-secret.arn}\"}, {\"Effect\": \"Allow\", \"Action\": [\"sqs:ReceiveMessage\", \"sqs:DeleteMessage\", \"sqs:GetQueueUrl\", \"sqs:GetQueueAttributes\", \"sqs:ChangeMessageVisibility\", \"sqs:ChangeMessageVisibilityBatch\", \"sqs:DeleteMessageBatch\"], \"Resource\": \"${aws_sqs_queue.internal_message_bus.arn}\"}, {\"Effect\": \"Allow\", \"Action\": [\"logs:CreateLogGroup\", \"logs:CreateLogStream\", \"logs:PutLogEvents\"], \"Resource\": \"*\"}]})}"
      },
      "source": "aws_iam_policy.lambda-sqs-secret-policy",
      "target": "aws_sqs_queue.internal_message_bus"
    },
    {
      "id": "aws_lambda_function.consumer-aws_iam_role.consumer-['role']",
      "data": {
        "json_path": "role",
        "raw_value": "${aws_iam_role.consumer.arn}"
      },
      "source": "aws_lambda_function.consumer",
      "target": "aws_iam_role.consumer"
    },
    {
      "id": "aws_lambda_function.consumer-aws_sqs_queue.internal_message_bus-['environment', '0', 'variables', 'TARGET_SQS_QUEUE_NAME']",
      "data": {
        "json_path": "environment.0.variables.TARGET_SQS_QUEUE_NAME",
        "raw_value": "${aws_sqs_queue.internal_message_bus.id}"
      },
      "source": "aws_lambda_function.consumer",
      "target": "aws_sqs_queue.internal_message_bus"
    },
    {
      "id": "aws_lambda_event_source_mapping.consumer_mapping-aws_sqs_queue.internal_message_bus-['event_source_arn']",
      "data": {
        "json_path": "event_source_arn",
        "raw_value": "${aws_sqs_queue.internal_message_bus.arn}"
      },
      "source": "aws_lambda_event_source_mapping.consumer_mapping",
      "target": "aws_sqs_queue.internal_message_bus"
    },
    {
      "id": "aws_lambda_event_source_mapping.consumer_mapping-aws_lambda_function.consumer-['function_name']",
      "data": {
        "json_path": "function_name",
        "raw_value": "${aws_lambda_function.consumer.arn}"
      },
      "source": "aws_lambda_event_source_mapping.consumer_mapping",
      "target": "aws_lambda_function.consumer"
    },
    {
      "id": "aws_instance.wyatt-aws_security_group.wyatt-['vpc_security_group_ids', '0']",
      "data": {
        "json_path": "vpc_security_group_ids.0",
        "raw_value": "${aws_security_group.wyatt.id}"
      },
      "source": "aws_instance.wyatt",
      "target": "aws_security_group.wyatt"
    },
    {
      "id": "aws_instance.wyatt-aws_iam_instance_profile.wyatt-['iam_instance_profile']",
      "data": {
        "json_path": "iam_instance_profile",
        "raw_value": "${aws_iam_instance_profile.wyatt.name}"
      },
      "source": "aws_instance.wyatt",
      "target": "aws_iam_instance_profile.wyatt"
    },
    {
      "id": "aws_iam_instance_profile.wyatt-aws_iam_role.wyatt-['role']",
      "data": {
        "json_path": "role",
        "raw_value": "${aws_iam_role.wyatt.name}"
      },
      "source": "aws_iam_instance_profile.wyatt",
      "target": "aws_iam_role.wyatt"
    },
    {
      "id": "aws_iam_policy.wyatt-aws_dynamodb_table.wyatt-['policy']",
      "data": {
        "json_path": "policy",
        "raw_value": "${jsonencode({\"Version\": \"2012-10-17\", \"Statement\": [{\"Effect\": \"Allow\", \"Action\": [\"dynamodb:GetItem\", \"dynamodb:BatchGetItem\", \"dynamodb:Query\", \"dynamodb:Scan\"], \"Resource\": [\"${aws_dynamodb_table.wyatt.arn}\"]}]})}"
      },
      "source": "aws_iam_policy.wyatt",
      "target": "aws_dynamodb_table.wyatt"
    },
    {
      "id": "aws_iam_role_policy_attachment.wyatt-aws_iam_role.wyatt-['role']",
      "data": {
        "json_path": "role",
        "raw_value": "${aws_iam_role.wyatt.name}"
      },
      "source": "aws_iam_role_policy_attachment.wyatt",
      "target": "aws_iam_role.wyatt"
    },
    {
      "id": "aws_iam_role_policy_attachment.wyatt-aws_iam_policy.wyatt-['policy_arn']",
      "data": {
        "json_path": "policy_arn",
        "raw_value": "${aws_iam_policy.wyatt.arn}"
      },
      "source": "aws_iam_role_policy_attachment.wyatt",
      "target": "aws_iam_policy.wyatt"
    },
    {
      "id": "null_resource.insert_records-aws_dynamodb_table.wyatt-['provisioner', '0', 'local-exec', 'command']",
      "data": {
        "json_path": "provisioner.0.local-exec.command",
        "raw_value": "aws --region \"us-west-2\" --profile \"default\" dynamodb put-item --table-name ${aws_dynamodb_table.wyatt.name} --item '{\"id\": {\"S\": \"record1\"}, \"data\": {\"S\": \"Sample data 1\"}}' && \\\naws --region \"us-west-2\" --profile \"default\" dynamodb put-item --table-name ${aws_dynamodb_table.wyatt.name} --item '{\"id\": {\"S\": \"record2\"}, \"data\": {\"S\": \"Sample data 2\"}, \"ctf_flag\": {\"S\": \"FLAG{wyatt::So_Many_DBs_To_Look_Through}\"}}' && \\\naws --region \"us-west-2\" --profile \"default\" dynamodb put-item --table-name ${aws_dynamodb_table.wyatt.name} --item '{\"id\": {\"S\": \"record3\"}, \"data\": {\"S\": \"Sample data 3\"}}'"
      },
      "source": "null_resource.insert_records",
      "target": "aws_dynamodb_table.wyatt"
    },
    {
      "id": "aws_security_group_rule.intra-sg-access-ingress-aws_security_group.intra-sg-access-['security_group_id']",
      "data": {
        "json_path": "security_group_id",
        "raw_value": "${aws_security_group.intra-sg-access.id}"
      },
      "source": "aws_security_group_rule.intra-sg-access-ingress",
      "target": "aws_security_group.intra-sg-access"
    },
    {
      "id": "aws_instance.bastion-aws_iam_instance_profile.bastion-['iam_instance_profile']",
      "data": {
        "json_path": "iam_instance_profile",
        "raw_value": "${aws_iam_instance_profile.bastion.name}"
      },
      "source": "aws_instance.bastion",
      "target": "aws_iam_instance_profile.bastion"
    },
    {
      "id": "aws_instance.bastion-aws_security_group.intra-sg-access-['vpc_security_group_ids', '0']",
      "data": {
        "json_path": "vpc_security_group_ids.0",
        "raw_value": "${aws_security_group.intra-sg-access.id}"
      },
      "source": "aws_instance.bastion",
      "target": "aws_security_group.intra-sg-access"
    },
    {
      "id": "aws_iam_role_policy_attachment.ssmcore-aws_iam_role.bastion-['role']",
      "data": {
        "json_path": "role",
        "raw_value": "${aws_iam_role.bastion.name}"
      },
      "source": "aws_iam_role_policy_attachment.ssmcore",
      "target": "aws_iam_role.bastion"
    },
    {
      "id": "aws_iam_role_policy_attachment.bastion-deny-aws_iam_role.bastion-['role']",
      "data": {
        "json_path": "role",
        "raw_value": "${aws_iam_role.bastion.name}"
      },
      "source": "aws_iam_role_policy_attachment.bastion-deny",
      "target": "aws_iam_role.bastion"
    },
    {
      "id": "aws_iam_role_policy_attachment.bastion-deny-aws_iam_policy.rootdeny_ssm_parameter_access-['policy_arn']",
      "data": {
        "json_path": "policy_arn",
        "raw_value": "${aws_iam_policy.rootdeny_ssm_parameter_access.arn}"
      },
      "source": "aws_iam_role_policy_attachment.bastion-deny",
      "target": "aws_iam_policy.rootdeny_ssm_parameter_access"
    },
    {
      "id": "aws_iam_instance_profile.bastion-aws_iam_role.bastion-['role']",
      "data": {
        "json_path": "role",
        "raw_value": "${aws_iam_role.bastion.name}"
      },
      "source": "aws_iam_instance_profile.bastion",
      "target": "aws_iam_role.bastion"
    },
    {
      "id": "aws_iam_role_policy_attachment.bastion-s3-aws_iam_role.bastion-['role']",
      "data": {
        "json_path": "role",
        "raw_value": "${aws_iam_role.bastion.name}"
      },
      "source": "aws_iam_role_policy_attachment.bastion-s3",
      "target": "aws_iam_role.bastion"
    },
    {
      "id": "aws_iam_role_policy_attachment.bastion-s3-aws_iam_policy.bastion-s3-['policy_arn']",
      "data": {
        "json_path": "policy_arn",
        "raw_value": "${aws_iam_policy.bastion-s3.arn}"
      },
      "source": "aws_iam_role_policy_attachment.bastion-s3",
      "target": "aws_iam_policy.bastion-s3"
    },
    {
      "id": "aws_s3_bucket_public_access_block.cloudfoxable-bastion-public-access-block-aws_s3_bucket.cloudfoxable-bastion-['bucket']",
      "data": {
        "json_path": "bucket",
        "raw_value": "${aws_s3_bucket.cloudfoxable-bastion.id}"
      },
      "source": "aws_s3_bucket_public_access_block.cloudfoxable-bastion-public-access-block",
      "target": "aws_s3_bucket.cloudfoxable-bastion"
    },
    {
      "id": "aws_s3_object.cloudfoxable-bastion-object-aws_s3_bucket.cloudfoxable-bastion-['bucket']",
      "data": {
        "json_path": "bucket",
        "raw_value": "${aws_s3_bucket.cloudfoxable-bastion.id}"
      },
      "source": "aws_s3_object.cloudfoxable-bastion-object",
      "target": "aws_s3_bucket.cloudfoxable-bastion"
    },
    {
      "id": "aws_iam_policy.bastion-ssm-aws_instance.bastion-['policy']",
      "data": {
        "json_path": "policy",
        "raw_value": "${jsonencode({\"Version\": \"2012-10-17\", \"Statement\": [{\"Action\": [\"ssm:StartSession\", \"ssm:SendCommand\", \"ssm:ListCommandInvocations\", \"ssm:TerminateSession\"], \"Effect\": \"Allow\", \"Resource\": [\"${aws_instance.bastion.arn}\", \"arn:aws:ssm:us-west-2::document/SSM-SessionManagerRunShell\", \"arn:aws:ssm:us-west-2::session/ctf-starting-user-*\"]}]})}"
      },
      "source": "aws_iam_policy.bastion-ssm",
      "target": "aws_instance.bastion"
    },
    {
      "id": "aws_iam_user_policy_attachment.bastion-ssm-aws_iam_policy.bastion-ssm-['policy_arn']",
      "data": {
        "json_path": "policy_arn",
        "raw_value": "${aws_iam_policy.bastion-ssm.arn}"
      },
      "source": "aws_iam_user_policy_attachment.bastion-ssm",
      "target": "aws_iam_policy.bastion-ssm"
    },
    {
      "id": "aws_db_instance.default-aws_db_subnet_group.default-['db_subnet_group_name']",
      "data": {
        "json_path": "db_subnet_group_name",
        "raw_value": "${aws_db_subnet_group.default.id}"
      },
      "source": "aws_db_instance.default",
      "target": "aws_db_subnet_group.default"
    },
    {
      "id": "aws_lambda_function.rds_sql_executor-aws_iam_role.lambda_execution_role-['role']",
      "data": {
        "json_path": "role",
        "raw_value": "${aws_iam_role.lambda_execution_role.arn}"
      },
      "source": "aws_lambda_function.rds_sql_executor",
      "target": "aws_iam_role.lambda_execution_role"
    },
    {
      "id": "aws_lambda_function.rds_sql_executor-aws_db_instance.default-['environment', '0', 'variables', 'RDS_DB_NAME']",
      "data": {
        "json_path": "environment.0.variables.RDS_DB_NAME",
        "raw_value": "${aws_db_instance.default.db_name}"
      },
      "source": "aws_lambda_function.rds_sql_executor",
      "target": "aws_db_instance.default"
    },
    {
      "id": "aws_iam_role_policy_attachment.lambda_policy_attach-aws_iam_role.lambda_execution_role-['role']",
      "data": {
        "json_path": "role",
        "raw_value": "${aws_iam_role.lambda_execution_role.name}"
      },
      "source": "aws_iam_role_policy_attachment.lambda_policy_attach",
      "target": "aws_iam_role.lambda_execution_role"
    },
    {
      "id": "aws_iam_role_policy_attachment.lambda_policy_attach-aws_iam_policy.lambda_policy-['policy_arn']",
      "data": {
        "json_path": "policy_arn",
        "raw_value": "${aws_iam_policy.lambda_policy.arn}"
      },
      "source": "aws_iam_role_policy_attachment.lambda_policy_attach",
      "target": "aws_iam_policy.lambda_policy"
    },
    {
      "id": "null_resource.invoke_lambda-aws_db_instance.default-['triggers', 'db']",
      "data": {
        "json_path": "triggers.db",
        "raw_value": "${aws_db_instance.default.address}"
      },
      "source": "null_resource.invoke_lambda",
      "target": "aws_db_instance.default"
    },
    {
      "id": "null_resource.invoke_lambda-aws_lambda_function.rds_sql_executor-['provisioner', '0', 'local-exec', 'command']",
      "data": {
        "json_path": "provisioner.0.local-exec.command",
        "raw_value": "aws --region us-west-2 --profile default lambda invoke --function-name ${aws_lambda_function.rds_sql_executor.function_name} response.json"
      },
      "source": "null_resource.invoke_lambda",
      "target": "aws_lambda_function.rds_sql_executor"
    }
  ]
}