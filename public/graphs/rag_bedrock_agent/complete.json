{"directed": true, "multigraph": false, "graph": {}, "nodes": [{"data": {"resource_type": "aws_vpc_endpoint", "resource_name": "s3", "resource_service": "vpc", "resource_icon": "aws/Architecture-Group-Icons_07312025/AWS-Cloud_32.svg", "count": 1, "vpc_id": "vpc-047dd28296946f67c", "service_name": "com.amazonaws..s3", "vpc_endpoint_type": "Gateway"}, "id": "aws_vpc_endpoint.s3"}, {"data": {"resource_type": "aws_s3_bucket", "resource_name": "sample_kb_bucket", "resource_service": "s3", "resource_icon": "aws/Architecture-Service-Icons_07312025/Arch_Storage/48/Arch_Amazon-Simple-Storage-Service_48.svg", "bucket": "kb-usw2-prod", "force_destroy": true}, "id": "aws_s3_bucket.sample_kb_bucket"}, {"data": {"resource_type": "aws_s3_bucket", "resource_name": "sample_kb_logging_bucket", "resource_service": "s3", "resource_icon": "aws/Architecture-Service-Icons_07312025/Arch_Storage/48/Arch_Amazon-Simple-Storage-Service_48.svg", "bucket": "kb-accesslog-usw2-prod", "force_destroy": true}, "id": "aws_s3_bucket.sample_kb_logging_bucket"}, {"data": {"resource_type": "aws_s3_bucket_server_side_encryption_configuration", "resource_name": "sample_kb_bucket_encryption_configurations", "resource_service": "s3", "resource_icon": "aws/Architecture-Service-Icons_07312025/Arch_Storage/48/Arch_Amazon-Simple-Storage-Service_48.svg", "bucket": "${aws_s3_bucket.sample_kb_bucket.id}", "rule": [{"apply_server_side_encryption_by_default": [{"sse_algorithm": "aws:kms", "kms_master_key_id": "arn:aws:kms:us-west-2:XXXXXXXXXXXXX:key/1488f8c9-6443-4486-9927-8825278e3aad"}]}]}, "id": "aws_s3_bucket_server_side_encryption_configuration.sample_kb_bucket_encryption_configurations"}, {"data": {"resource_type": "aws_s3_bucket_server_side_encryption_configuration", "resource_name": "sample_log_bucket_encryption_configurations", "resource_service": "s3", "resource_icon": "aws/Architecture-Service-Icons_07312025/Arch_Storage/48/Arch_Amazon-Simple-Storage-Service_48.svg", "bucket": "${aws_s3_bucket.sample_kb_logging_bucket.id}", "rule": [{"apply_server_side_encryption_by_default": [{"sse_algorithm": "aws:kms", "kms_master_key_id": "arn:aws:kms:us-west-2:XXXXXXXXXXXXX:key/1488f8c9-6443-4486-9927-8825278e3aad"}]}]}, "id": "aws_s3_bucket_server_side_encryption_configuration.sample_log_bucket_encryption_configurations"}, {"data": {"resource_type": "aws_s3_bucket_versioning", "resource_name": "sample_kb_bucket_version", "resource_service": "s3", "resource_icon": "aws/Architecture-Service-Icons_07312025/Arch_Storage/48/Arch_Amazon-Simple-Storage-Service_48.svg", "bucket": "${aws_s3_bucket.sample_kb_bucket.id}", "versioning_configuration": [{"status": "Enabled"}], "depends_on": ["${aws_s3_bucket_server_side_encryption_configuration.sample_kb_bucket_encryption_configurations}"]}, "id": "aws_s3_bucket_versioning.sample_kb_bucket_version"}, {"data": {"resource_type": "aws_s3_bucket_logging", "resource_name": "sample_kb_bucket_logging", "resource_service": "s3", "resource_icon": "aws/Architecture-Service-Icons_07312025/Arch_Storage/48/Arch_Amazon-Simple-Storage-Service_48.svg", "count": 1, "bucket": "${aws_s3_bucket.sample_kb_bucket.id}", "target_bucket": "${aws_s3_bucket.sample_kb_logging_bucket.id}", "target_prefix": "log-usw2-prod"}, "id": "aws_s3_bucket_logging.sample_kb_bucket_logging"}, {"data": {"resource_type": "aws_s3_bucket_lifecycle_configuration", "resource_name": "sample_kb_bucket_lifecycle", "resource_service": "s3", "resource_icon": "aws/Architecture-Service-Icons_07312025/Arch_Storage/48/Arch_Amazon-Simple-Storage-Service_48.svg", "count": 1, "bucket": "${aws_s3_bucket.sample_kb_bucket.id}", "rule": [{"id": "ABORT_INCOMPLETE_UPLOADS", "status": "Enabled", "abort_incomplete_multipart_upload": [{"days_after_initiation": 3}]}]}, "id": "aws_s3_bucket_lifecycle_configuration.sample_kb_bucket_lifecycle"}, {"data": {"resource_type": "aws_s3_bucket_lifecycle_configuration", "resource_name": "sample_kb_logging_bucket_lifecycle", "resource_service": "s3", "resource_icon": "aws/Architecture-Service-Icons_07312025/Arch_Storage/48/Arch_Amazon-Simple-Storage-Service_48.svg", "count": 1, "bucket": "${aws_s3_bucket.sample_kb_logging_bucket.id}", "rule": [{"id": "ABORT_INCOMPLETE_UPLOADS", "status": "Enabled", "abort_incomplete_multipart_upload": [{"days_after_initiation": 3}]}]}, "id": "aws_s3_bucket_lifecycle_configuration.sample_kb_logging_bucket_lifecycle"}, {"data": {"resource_type": "aws_iam_role", "resource_name": "bedrock_iam_role", "resource_service": "iam", "resource_icon": "aws/Architecture-Service-Icons_07312025/Arch_Security-Identity-Compliance/48/Arch_AWS-Identity-and-Access-Management_48.svg", "assume_role_policy": null, "name": "bedrock-agent-role-acme-prod"}, "id": "aws_iam_role.bedrock_iam_role"}, {"data": {"resource_type": "aws_iam_role_policy", "resource_name": "bedrock_iam_policy", "resource_service": "iam", "resource_icon": "aws/Architecture-Service-Icons_07312025/Arch_Security-Identity-Compliance/48/Arch_AWS-Identity-and-Access-Management_48.svg", "policy": null, "role": "${aws_iam_role.bedrock_iam_role.id}", "name": "bedrock-agent-policy-acme-prod"}, "id": "aws_iam_role_policy.bedrock_iam_policy"}, {"data": {"resource_type": "aws_iam_role", "resource_name": "bedrock_sample_kb_role", "resource_service": "iam", "resource_icon": "aws/Architecture-Service-Icons_07312025/Arch_Security-Identity-Compliance/48/Arch_AWS-Identity-and-Access-Management_48.svg", "name": "bedrock-kb-role-acme-prod", "assume_role_policy": null}, "id": "aws_iam_role.bedrock_sample_kb_role"}, {"data": {"resource_type": "aws_iam_role_policy", "resource_name": "bedrock_sample_kb_model", "resource_service": "iam", "resource_icon": "aws/Architecture-Service-Icons_07312025/Arch_Security-Identity-Compliance/48/Arch_AWS-Identity-and-Access-Management_48.svg", "role": "${aws_iam_role.bedrock_sample_kb_role.name}", "policy": null, "name": "bedrock-kb-policy-acme-prod"}, "id": "aws_iam_role_policy.bedrock_sample_kb_model"}, {"data": {"resource_type": "aws_iam_role_policy", "resource_name": "bedrock_sample_kb_s3", "resource_service": "iam", "resource_icon": "aws/Architecture-Service-Icons_07312025/Arch_Security-Identity-Compliance/48/Arch_AWS-Identity-and-Access-Management_48.svg", "role": "${aws_iam_role.bedrock_sample_kb_role.name}", "policy": null}, "id": "aws_iam_role_policy.bedrock_sample_kb_s3"}, {"data": {"resource_type": "aws_iam_role", "resource_name": "agent_lambda_role", "resource_service": "iam", "resource_icon": "aws/Architecture-Service-Icons_07312025/Arch_Security-Identity-Compliance/48/Arch_AWS-Identity-and-Access-Management_48.svg", "name": "bedrock-agent-lambda-role-acme-prod", "assume_role_policy": null}, "id": "aws_iam_role.agent_lambda_role"}, {"data": {"resource_type": "aws_iam_policy", "resource_name": "agent_lambda_role_policy", "resource_service": "iam", "resource_icon": "aws/Architecture-Service-Icons_07312025/Arch_Security-Identity-Compliance/48/Arch_AWS-Identity-and-Access-Management_48.svg", "description": "Policy for Lambda Execution", "policy": null, "name": "bedrock-agent-lambda-policy-acme-prod"}, "id": "aws_iam_policy.agent_lambda_role_policy"}, {"data": {"resource_type": "aws_iam_role_policy_attachment", "resource_name": "agent_lambda_role_policy_attachment", "resource_service": "iam", "resource_icon": "aws/Architecture-Service-Icons_07312025/Arch_Security-Identity-Compliance/48/Arch_AWS-Identity-and-Access-Management_48.svg", "role": "${aws_iam_role.agent_lambda_role.name}", "policy_arn": "${aws_iam_policy.agent_lambda_role_policy.arn}"}, "id": "aws_iam_role_policy_attachment.agent_lambda_role_policy_attachment"}, {"data": {"resource_type": "aws_iam_policy", "resource_name": "agent_lambda_invoke_policy", "resource_service": "iam", "resource_icon": "aws/Architecture-Service-Icons_07312025/Arch_Security-Identity-Compliance/48/Arch_AWS-Identity-and-Access-Management_48.svg", "description": "Policy for Lambda Execution", "policy": null, "name": "bedrock-agent-lambda-invoke-policyacme-prod"}, "id": "aws_iam_policy.agent_lambda_invoke_policy"}, {"data": {"resource_type": "aws_iam_role_policy_attachment", "resource_name": "bedrock_agent_permissions_attachment", "resource_service": "iam", "resource_icon": "aws/Architecture-Service-Icons_07312025/Arch_Security-Identity-Compliance/48/Arch_AWS-Identity-and-Access-Management_48.svg", "role": "${aws_iam_role.agent_lambda_role.name}", "policy_arn": "${aws_iam_policy.agent_lambda_invoke_policy.arn}"}, "id": "aws_iam_role_policy_attachment.bedrock_agent_permissions_attachment"}, {"data": {"resource_type": "aws_iam_policy", "resource_name": "agent_lambda_s3_data_policy", "resource_service": "iam", "resource_icon": "aws/Architecture-Service-Icons_07312025/Arch_Security-Identity-Compliance/48/Arch_AWS-Identity-and-Access-Management_48.svg", "description": "Policy for Access to Data Objects in S3", "policy": null, "name": "bedrock-agent-lambda-s3-policyacme-prod"}, "id": "aws_iam_policy.agent_lambda_s3_data_policy"}, {"data": {"resource_type": "aws_iam_role_policy_attachment", "resource_name": "agent_lambda_s3_data_policy_attachment", "resource_service": "iam", "resource_icon": "aws/Architecture-Service-Icons_07312025/Arch_Security-Identity-Compliance/48/Arch_AWS-Identity-and-Access-Management_48.svg", "role": "${aws_iam_role.agent_lambda_role.name}", "policy_arn": "${aws_iam_policy.agent_lambda_s3_data_policy.arn}"}, "id": "aws_iam_role_policy_attachment.agent_lambda_s3_data_policy_attachment"}, {"data": {"resource_type": "aws_iam_role_policy_attachment", "resource_name": "lamba_exec_role_eni", "resource_service": "iam", "resource_icon": "aws/Architecture-Service-Icons_07312025/Arch_Security-Identity-Compliance/48/Arch_AWS-Identity-and-Access-Management_48.svg", "role": "${aws_iam_role.agent_lambda_role.name}", "policy_arn": null}, "id": "aws_iam_role_policy_attachment.lamba_exec_role_eni"}, {"data": {"resource_type": "aws_iam_role_policy", "resource_name": "bedrock_logging_policy", "resource_service": "iam", "resource_icon": "aws/Architecture-Service-Icons_07312025/Arch_Security-Identity-Compliance/48/Arch_AWS-Identity-and-Access-Management_48.svg", "name": "bedrock-agent-invoke-role-policy", "role": "${aws_iam_role.bedrock_logging_role.id}", "policy": null}, "id": "aws_iam_role_policy.bedrock_logging_policy"}, {"data": {"resource_type": "aws_iam_role", "resource_name": "bedrock_logging_role", "resource_service": "iam", "resource_icon": "aws/Architecture-Service-Icons_07312025/Arch_Security-Identity-Compliance/48/Arch_AWS-Identity-and-Access-Management_48.svg", "assume_role_policy": null, "name": "bedrock-agent-invoke-role-acme-prod"}, "id": "aws_iam_role.bedrock_logging_role"}, {"data": {"resource_type": "aws_opensearchserverless_access_policy", "resource_name": "sample_kb_aoss_policy", "resource_service": "opensearchserverless", "resource_icon": "aws/Architecture-Service-Icons_07312025/Arch_Analytics/48/Arch_Amazon-OpenSearch-Service_48.svg", "name": "aoss-kb-policy-acme-prod", "type": "data", "policy": "${jsonencode([{\"Rules\": [{\"ResourceType\": \"index\", \"Resource\": [\"index/aoss-collection-usw2-prod/*\"], \"Permission\": [\"aoss:CreateIndex\", \"aoss:DeleteIndex\", \"aoss:DescribeIndex\", \"aoss:ReadDocument\", \"aoss:UpdateIndex\", \"aoss:WriteDocument\"]}, {\"ResourceType\": \"collection\", \"Resource\": [\"collection/aoss-collection-usw2-prod\"], \"Permission\": [\"aoss:CreateCollectionItems\", \"aoss:DescribeCollectionItems\", \"aoss:UpdateCollectionItems\"]}], \"Principal\": [\"${module.roles.knowledge_base_role_arn}\", \"\"]}])}"}, "id": "aws_opensearchserverless_access_policy.sample_kb_aoss_policy"}, {"data": {"resource_type": "aws_opensearchserverless_security_policy", "resource_name": "sample_kb_encryption_policy", "resource_service": "opensearchserverless", "resource_icon": "aws/Architecture-Service-Icons_07312025/Arch_Analytics/48/Arch_Amazon-OpenSearch-Service_48.svg", "name": "aoss-encr-policy-acme-prod", "type": "encryption", "policy": "${jsonencode({\"Rules\": [{\"Resource\": [\"collection/aoss-collection-usw2-prod\"], \"ResourceType\": \"collection\"}], \"KmsARN\": \"arn:aws:kms:us-west-2:XXXXXXXXXXXXX:key/1488f8c9-6443-4486-9927-8825278e3aad\"})}"}, "id": "aws_opensearchserverless_security_policy.sample_kb_encryption_policy"}, {"data": {"resource_type": "aws_opensearchserverless_security_policy", "resource_name": "sample_kb_network_policy", "resource_service": "opensearchserverless", "resource_icon": "aws/Architecture-Service-Icons_07312025/Arch_Analytics/48/Arch_Amazon-OpenSearch-Service_48.svg", "name": "aoss-nw-policy-acme-prod", "type": "network", "policy": "${jsonencode([{\"Rules\": [{\"ResourceType\": \"collection\", \"Resource\": [\"collection/aoss-collection-usw2-prod\"]}, {\"ResourceType\": \"dashboard\", \"Resource\": [\"collection/aoss-collection-usw2-prod\"]}], \"AllowFromPublic\": true}])}"}, "id": "aws_opensearchserverless_security_policy.sample_kb_network_policy"}, {"data": {"resource_type": "aws_opensearchserverless_collection", "resource_name": "sample_aoss_collection", "resource_service": "opensearchserverless", "resource_icon": "aws/Architecture-Service-Icons_07312025/Arch_Analytics/48/Arch_Amazon-OpenSearch-Service_48.svg", "name": "aoss-collection-usw2-prod", "type": "VECTORSEARCH", "depends_on": ["${aws_opensearchserverless_access_policy.sample_kb_aoss_policy}", "${aws_opensearchserverless_security_policy.sample_kb_encryption_policy}", "${aws_opensearchserverless_security_policy.sample_kb_network_policy}"]}, "id": "aws_opensearchserverless_collection.sample_aoss_collection"}, {"data": {"resource_type": "opensearch_index", "resource_name": "sample_aoss_index", "resource_service": "index", "resource_icon": "terraform/terraform-logo.svg", "name": "bedrock-knowledge-base-default-index", "number_of_shards": 2, "number_of_replicas": 1, "index_knn": true, "index_knn_algo_param_ef_search": 512, "mappings": {"properties": {"bedrock-knowledge-base-default-vector": {"type": "knn_vector", "dimension": "1024", "method": {"name": "hnsw", "engine": "FAISS", "parameters": {"m": 16, "ef_construction": 512}, "space_type": "l2"}}, "AMAZON_BEDROCK_METADATA": {"type": "text", "index": "false"}, "AMAZON_BEDROCK_TEXT_CHUNK": {"type": "text", "index": "true"}}}, "lifecycle": [{"ignore_changes": "${all}"}], "force_destroy": true, "depends_on": ["${aws_opensearchserverless_collection.sample_aoss_collection}"]}, "id": "opensearch_index.sample_aoss_index"}, {"data": {"resource_type": "aws_ssm_parameter", "resource_name": "knowledge_base_id", "resource_service": "ssm", "resource_icon": "aws/Architecture-Service-Icons_07312025/Arch_Management-Governance/48/Arch_AWS-Systems-Manager_48.svg", "name": "bedrock-kb-usw2-prod-kb-id", "description": "Bedrock Knowledge Base ID", "type": "SecureString", "value": "${aws_bedrockagent_knowledge_base.sample_kb.id}", "key_id": "arn:aws:kms:us-west-2:XXXXXXXXXXXXX:key/1488f8c9-6443-4486-9927-8825278e3aad"}, "id": "aws_ssm_parameter.knowledge_base_id"}, {"data": {"resource_type": "aws_ssm_parameter", "resource_name": "knowledge_base_data_source_id", "resource_service": "ssm", "resource_icon": "aws/Architecture-Service-Icons_07312025/Arch_Management-Governance/48/Arch_AWS-Systems-Manager_48.svg", "name": "bedrock-kb-usw2-prod-datasource-id", "description": "Bedrock Knowledge Base Data Source ID", "type": "SecureString", "value": "${aws_bedrockagent_data_source.data_source.id}", "key_id": "arn:aws:kms:us-west-2:XXXXXXXXXXXXX:key/1488f8c9-6443-4486-9927-8825278e3aad"}, "id": "aws_ssm_parameter.knowledge_base_data_source_id"}, {"data": {"resource_type": "aws_ssm_parameter", "resource_name": "bedrock_agent_instruction_ssm_history", "resource_service": "ssm", "resource_icon": "aws/Architecture-Service-Icons_07312025/Arch_Management-Governance/48/Arch_AWS-Systems-Manager_48.svg", "name": "bedrock-agent-usw2-prod-last-processed-version", "description": "Bedrock Agent Instructions SSM History", "type": "SecureString", "value": "initial", "key_id": "arn:aws:kms:us-west-2:XXXXXXXXXXXXX:key/1488f8c9-6443-4486-9927-8825278e3aad", "depends_on": ["${aws_bedrockagent_agent_alias.bedrock_agent_alias}"], "lifecycle": [{"ignore_changes": ["${value}"]}]}, "id": "aws_ssm_parameter.bedrock_agent_instruction_ssm_history"}, {"data": {"resource_type": "time_sleep", "resource_name": "aws_iam_role_policy_bedrock_sample_kb_oss", "resource_service": "sleep", "resource_icon": "terraform/terraform-logo.svg", "create_duration": "30s", "depends_on": ["${aws_iam_role_policy.bedrock_sample_kb_oss}"]}, "id": "time_sleep.aws_iam_role_policy_bedrock_sample_kb_oss"}, {"data": {"resource_type": "aws_bedrockagent_knowledge_base", "resource_name": "sample_kb", "resource_service": "bedrockagent", "resource_icon": "aws/Architecture-Service-Icons_07312025/Arch_Artificial-Intelligence/48/Arch_Amazon-Bedrock_48.svg", "name": "bedrock-kb-usw2-prod", "role_arn": "${module.roles.knowledge_base_role_arn}", "knowledge_base_configuration": [{"vector_knowledge_base_configuration": [{"embedding_model_arn": null}], "type": "VECTOR"}], "storage_configuration": [{"type": "OPENSEARCH_SERVERLESS", "opensearch_serverless_configuration": [{"collection_arn": "${module.aoss.aoss_collection_arn}", "vector_index_name": "bedrock-knowledge-base-default-index", "field_mapping": [{"vector_field": "bedrock-knowledge-base-default-vector", "text_field": "AMAZON_BEDROCK_TEXT_CHUNK", "metadata_field": "AMAZON_BEDROCK_METADATA"}]}]}], "depends_on": ["${time_sleep.aws_iam_role_policy_bedrock_sample_kb_oss}"]}, "id": "aws_bedrockagent_knowledge_base.sample_kb"}, {"data": {"resource_type": "aws_bedrockagent_data_source", "resource_name": "data_source", "resource_service": "bedrockagent", "resource_icon": "aws/Architecture-Service-Icons_07312025/Arch_Artificial-Intelligence/48/Arch_Amazon-Bedrock_48.svg", "knowledge_base_id": "${aws_bedrockagent_knowledge_base.sample_kb.id}", "name": "bedrock-knowledge-base-data-source-bucket", "data_source_configuration": [{"type": "S3", "s3_configuration": [{"bucket_arn": "${module.knowledge_base_bucket.arn}"}]}], "server_side_encryption_configuration": [{"kms_key_arn": "arn:aws:kms:us-west-2:XXXXXXXXXXXXX:key/1488f8c9-6443-4486-9927-8825278e3aad"}]}, "id": "aws_bedrockagent_data_source.data_source"}, {"data": {"resource_type": "aws_iam_role_policy", "resource_name": "bedrock_sample_kb_oss", "resource_service": "iam", "resource_icon": "aws/Architecture-Service-Icons_07312025/Arch_Security-Identity-Compliance/48/Arch_AWS-Identity-and-Access-Management_48.svg", "role": "${module.roles.knowledge_base_role_name}", "policy": null}, "id": "aws_iam_role_policy.bedrock_sample_kb_oss"}, {"data": {"resource_type": "aws_ssm_parameter", "resource_name": "bedrock_agent_id", "resource_service": "ssm", "resource_icon": "aws/Architecture-Service-Icons_07312025/Arch_Management-Governance/48/Arch_AWS-Systems-Manager_48.svg", "name": "bedrock-agent-usw2-prod-id", "description": "Bedrock Agent ID", "type": "SecureString", "value": "${aws_bedrockagent_agent.bedrock_agent.agent_id}", "key_id": "arn:aws:kms:us-west-2:XXXXXXXXXXXXX:key/1488f8c9-6443-4486-9927-8825278e3aad", "depends_on": ["${aws_bedrockagent_agent_alias.bedrock_agent_alias}"]}, "id": "aws_ssm_parameter.bedrock_agent_id"}, {"data": {"resource_type": "aws_ssm_parameter", "resource_name": "bedrock_agent_name", "resource_service": "ssm", "resource_icon": "aws/Architecture-Service-Icons_07312025/Arch_Management-Governance/48/Arch_AWS-Systems-Manager_48.svg", "name": "bedrock-agent-usw2-prod-name", "description": "Bedrock Agent Name", "type": "SecureString", "value": "${aws_bedrockagent_agent.bedrock_agent.agent_name}", "key_id": "arn:aws:kms:us-west-2:XXXXXXXXXXXXX:key/1488f8c9-6443-4486-9927-8825278e3aad", "depends_on": ["${aws_bedrockagent_agent_alias.bedrock_agent_alias}"]}, "id": "aws_ssm_parameter.bedrock_agent_name"}, {"data": {"resource_type": "aws_ssm_parameter", "resource_name": "bedrock_agent_alias", "resource_service": "ssm", "resource_icon": "aws/Architecture-Service-Icons_07312025/Arch_Management-Governance/48/Arch_AWS-Systems-Manager_48.svg", "name": "bedrock-agent-usw2-prod-alias", "description": "Bedrock Agent Alias", "type": "SecureString", "value": "${aws_bedrockagent_agent_alias.bedrock_agent_alias.agent_alias_id}", "key_id": "arn:aws:kms:us-west-2:XXXXXXXXXXXXX:key/1488f8c9-6443-4486-9927-8825278e3aad", "depends_on": ["${aws_bedrockagent_agent_alias.bedrock_agent_alias}"]}, "id": "aws_ssm_parameter.bedrock_agent_alias"}, {"data": {"resource_type": "aws_ssm_parameter", "resource_name": "bedrock_agent_arn", "resource_service": "ssm", "resource_icon": "aws/Architecture-Service-Icons_07312025/Arch_Management-Governance/48/Arch_AWS-Systems-Manager_48.svg", "name": "bedrock-agent-usw2-prod-arn", "description": "Bedrock Agent ARN", "type": "SecureString", "value": "${aws_bedrockagent_agent.bedrock_agent.agent_arn}", "key_id": "arn:aws:kms:us-west-2:XXXXXXXXXXXXX:key/1488f8c9-6443-4486-9927-8825278e3aad", "depends_on": ["${aws_bedrockagent_agent_alias.bedrock_agent_alias}"]}, "id": "aws_ssm_parameter.bedrock_agent_arn"}, {"data": {"resource_type": "aws_ssm_parameter", "resource_name": "bedrock_agent_instruction", "resource_service": "ssm", "resource_icon": "aws/Architecture-Service-Icons_07312025/Arch_Management-Governance/48/Arch_AWS-Systems-Manager_48.svg", "name": "bedrock-agent-usw2-prod-agent-instruction", "description": "Bedrock Agent Instruction", "type": "SecureString", "value": "${aws_bedrockagent_agent.bedrock_agent.instruction}", "key_id": "arn:aws:kms:us-west-2:XXXXXXXXXXXXX:key/1488f8c9-6443-4486-9927-8825278e3aad", "depends_on": ["${aws_bedrockagent_agent_alias.bedrock_agent_alias}"]}, "id": "aws_ssm_parameter.bedrock_agent_instruction"}, {"data": {"resource_type": "aws_ssm_parameter", "resource_name": "bedrock_agent_action_group_instruction", "resource_service": "ssm", "resource_icon": "aws/Architecture-Service-Icons_07312025/Arch_Management-Governance/48/Arch_AWS-Systems-Manager_48.svg", "name": "bedrock-agent-usw2-prod-agent-kb-instruction", "description": "Bedrock Agent KB Instruction", "type": "SecureString", "value": "${aws_bedrockagent_agent_knowledge_base_association.bedrock_agent_kb_association.description}", "key_id": "arn:aws:kms:us-west-2:XXXXXXXXXXXXX:key/1488f8c9-6443-4486-9927-8825278e3aad", "depends_on": ["${aws_bedrockagent_agent_alias.bedrock_agent_alias}"]}, "id": "aws_ssm_parameter.bedrock_agent_action_group_instruction"}, {"data": {"resource_type": "aws_ssm_parameter", "resource_name": "action_group_lambda_sha", "resource_service": "ssm", "resource_icon": "aws/Architecture-Service-Icons_07312025/Arch_Management-Governance/48/Arch_AWS-Systems-Manager_48.svg", "name": "bedrock-agent-usw2-prod-ag-lambda-sha", "description": "Bedrock Agent KB Lambda Code SHA", "type": "SecureString", "value": null, "key_id": "arn:aws:kms:us-west-2:XXXXXXXXXXXXX:key/1488f8c9-6443-4486-9927-8825278e3aad", "depends_on": ["${aws_bedrockagent_agent_alias.bedrock_agent_alias}"]}, "id": "aws_ssm_parameter.action_group_lambda_sha"}, {"data": {"resource_type": "aws_bedrockagent_agent", "resource_name": "bedrock_agent", "resource_service": "bedrockagent", "resource_icon": "aws/Architecture-Service-Icons_07312025/Arch_Artificial-Intelligence/48/Arch_Amazon-Bedrock_48.svg", "agent_name": "bedrock-agent-usw2-prod", "agent_resource_role_arn": "${module.roles.bedrock_agent_role_arn}", "idle_session_ttl_in_seconds": 600, "prepare_agent": true, "customer_encryption_key_arn": "arn:aws:kms:us-west-2:XXXXXXXXXXXXX:key/1488f8c9-6443-4486-9927-8825278e3aad", "foundation_model": "anthropic.claude-3-haiku-20240307-v1:0", "description": "You are a fitness chatbot", "instruction": "You are a helpful fitness assistant. You have general knowledge about sports. You can answer\nquestions related to fitness, diet plans. Use only the tools or knowledge base provided to answer\nuser questions. Choose between the tools or the knowledge base. Do not use both. Do not respond\nwithout using a tool or knowledge base.\nWhen a user asks to calculate their BMI:\n1. Ask for their weight in kilograms.\n2. Ask for their height in meters\n3. If the user provides values in any other unit, convert it into kilograms for weight and\nmeters for height. Do not make any comments about health status.", "prompt_override_configuration": [{"prompt_configurations": [{"base_prompt_template": "${file(\"${path.module}/prompt_templates/pre_processing.txt\")}", "inference_configuration": [{"max_length": 4096, "stop_sequences": ["\n\nHuman:"], "temperature": 0, "top_k": 250, "top_p": 1}], "parser_mode": "DEFAULT", "prompt_creation_mode": "OVERRIDDEN", "prompt_state": "ENABLED", "prompt_type": "PRE_PROCESSING"}, {"base_prompt_template": "${file(\"${path.module}/prompt_templates/orchestration.txt\")}", "inference_configuration": [{"max_length": 4096, "stop_sequences": ["\n\nHuman:"], "temperature": 0, "top_k": 250, "top_p": 1}], "parser_mode": "DEFAULT", "prompt_creation_mode": "OVERRIDDEN", "prompt_state": "ENABLED", "prompt_type": "ORCHESTRATION"}, {"base_prompt_template": "${file(\"${path.module}/prompt_templates/kb_resp_gen.txt\")}", "inference_configuration": [{"max_length": 4096, "stop_sequences": ["\n\nHuman:"], "temperature": 0, "top_k": 250, "top_p": 1}], "parser_mode": "DEFAULT", "prompt_creation_mode": "OVERRIDDEN", "prompt_state": "ENABLED", "prompt_type": "KNOWLEDGE_BASE_RESPONSE_GENERATION"}, {"base_prompt_template": "${file(\"${path.module}/prompt_templates/post_processing.txt\")}", "inference_configuration": [{"max_length": 4096, "stop_sequences": ["\n\nHuman:"], "temperature": 0, "top_k": 250, "top_p": 1}], "parser_mode": "DEFAULT", "prompt_creation_mode": "OVERRIDDEN", "prompt_state": "ENABLED", "prompt_type": "POST_PROCESSING"}]}]}, "id": "aws_bedrockagent_agent.bedrock_agent"}, {"data": {"resource_type": "aws_bedrockagent_agent_action_group", "resource_name": "bedrock_agent_actiongroup", "resource_service": "bedrockagent", "resource_icon": "aws/Architecture-Service-Icons_07312025/Arch_Artificial-Intelligence/48/Arch_Amazon-Bedrock_48.svg", "action_group_name": "bedrock-agent-ag-usw2-prod", "agent_id": "${aws_bedrockagent_agent.bedrock_agent.id}", "agent_version": "DRAFT", "description": "Use the action group to get the fitness plans, diet plans and historical details", "skip_resource_in_use_check": true, "action_group_executor": [{"lambda": "${aws_lambda_function.bi_chatbot_container_lambda.arn}"}], "api_schema": [{"payload": "${file(\"${path.root}/schema.json\")}"}]}, "id": "aws_bedrockagent_agent_action_group.bedrock_agent_actiongroup"}, {"data": {"resource_type": "aws_bedrockagent_agent_knowledge_base_association", "resource_name": "bedrock_agent_kb_association", "resource_service": "bedrockagent", "resource_icon": "aws/Architecture-Service-Icons_07312025/Arch_Artificial-Intelligence/48/Arch_Amazon-Bedrock_48.svg", "agent_id": "${aws_bedrockagent_agent.bedrock_agent.agent_id}", "description": "Use the knowledge base when the user is asking for a definition about a fitness, diet plans. Give a very detailed answer and cite the source.", "knowledge_base_id": "${module.bedrock_knowledge_base.knowledge_base_id}", "knowledge_base_state": "ENABLED"}, "id": "aws_bedrockagent_agent_knowledge_base_association.bedrock_agent_kb_association"}, {"data": {"resource_type": "null_resource", "resource_name": "agent_prepare", "resource_service": "resource", "resource_icon": "terraform/terraform-logo.svg", "triggers": {"agent_state": "${sha256(jsonencode(aws_bedrockagent_agent.bedrock_agent))}", "action_group_state": "${sha256(jsonencode(aws_bedrockagent_agent_action_group.bedrock_agent_actiongroup))}", "kb_assoc_state": "${sha256(jsonencode(aws_bedrockagent_agent_knowledge_base_association.bedrock_agent_kb_association))}"}, "provisioner": [{"local-exec": {"command": "aws bedrock-agent prepare-agent --agent-id ${aws_bedrockagent_agent.bedrock_agent.id}"}}], "depends_on": ["${aws_bedrockagent_agent.bedrock_agent}", "${aws_bedrockagent_agent_action_group.bedrock_agent_actiongroup}", "${aws_bedrockagent_agent_knowledge_base_association.bedrock_agent_kb_association}"]}, "id": "null_resource.agent_prepare"}, {"data": {"resource_type": "time_sleep", "resource_name": "agent_api_sleep", "resource_service": "sleep", "resource_icon": "terraform/terraform-logo.svg", "create_duration": "60s", "depends_on": ["${null_resource.agent_prepare}"]}, "id": "time_sleep.agent_api_sleep"}, {"data": {"resource_type": "aws_bedrockagent_agent_alias", "resource_name": "bedrock_agent_alias", "resource_service": "bedrockagent", "resource_icon": "aws/Architecture-Service-Icons_07312025/Arch_Artificial-Intelligence/48/Arch_Amazon-Bedrock_48.svg", "agent_alias_name": "bedrock-agent-alias-usw2-prod", "agent_id": "${aws_bedrockagent_agent.bedrock_agent.agent_id}", "description": "bedrock-agent-alias-usw2-prod", "depends_on": ["${time_sleep.agent_api_sleep}"]}, "id": "aws_bedrockagent_agent_alias.bedrock_agent_alias"}, {"data": {"resource_type": "aws_cloudwatch_log_group", "resource_name": "agent_invoke_log_group", "resource_service": "cloudwatch", "resource_icon": "aws/Architecture-Service-Icons_07312025/Arch_Management-Governance/48/Arch_Amazon-CloudWatch_48.svg", "name": "agent-invoke-log-bedrock-agent-usw2-prod", "retention_in_days": 365, "kms_key_id": "arn:aws:kms:us-west-2:XXXXXXXXXXXXX:key/1488f8c9-6443-4486-9927-8825278e3aad"}, "id": "aws_cloudwatch_log_group.agent_invoke_log_group"}, {"data": {"resource_type": "aws_cloudwatch_log_stream", "resource_name": "agent_invoke_log_stream", "resource_service": "cloudwatch", "resource_icon": "aws/Architecture-Service-Icons_07312025/Arch_Management-Governance/48/Arch_Amazon-CloudWatch_48.svg", "name": "agent-invoke-log-bedrock-agent-usw2-prod-cw-stream", "log_group_name": "${aws_cloudwatch_log_group.agent_invoke_log_group.name}"}, "id": "aws_cloudwatch_log_stream.agent_invoke_log_stream"}, {"data": {"resource_type": "aws_bedrock_model_invocation_logging_configuration", "resource_name": "cloudwatch_only", "resource_service": "bedrock", "resource_icon": "aws/Architecture-Service-Icons_07312025/Arch_Artificial-Intelligence/48/Arch_Amazon-Bedrock_48.svg", "logging_config": [{"image_data_delivery_enabled": true, "text_data_delivery_enabled": true, "embedding_data_delivery_enabled": true, "cloudwatch_config": [{"log_group_name": "agent-invoke-log-bedrock-agent-usw2-prod", "role_arn": "${module.roles.bedrock_agent_invoke_log_group_role_arn}"}]}], "depends_on": ["${aws_cloudwatch_log_group.agent_invoke_log_group}", "${aws_cloudwatch_log_stream.agent_invoke_log_stream}"]}, "id": "aws_bedrock_model_invocation_logging_configuration.cloudwatch_only"}, {"data": {"resource_type": "aws_sqs_queue", "resource_name": "bi_chatbot_container_lambda_dql", "resource_service": "sqs", "resource_icon": "aws/Architecture-Service-Icons_07312025/Arch_App-Integration/48/Arch_Amazon-Simple-Queue-Service_48.svg", "name": "bi-chatbot-container-lambda-dlq-acme-prod", "kms_master_key_id": "arn:aws:kms:us-west-2:XXXXXXXXXXXXX:key/1488f8c9-6443-4486-9927-8825278e3aad"}, "id": "aws_sqs_queue.bi_chatbot_container_lambda_dql"}, {"data": {"resource_type": "aws_security_group", "resource_name": "lambda_group_lambda", "resource_service": "security", "resource_icon": "aws/Category-Icons_07312025/Arch-Category_48/Arch-Category_Security-Identity-Compliance_48.svg", "name": "lambda-security-group-acme-prod", "vpc_id": "vpc-047dd28296946f67c", "description": "Security Group for Lambda Function", "egress": [{"from_port": 0, "to_port": 0, "protocol": -1, "cidr_blocks": ["0.0.0.0/0"], "description": "Allow egress to all"}]}, "id": "aws_security_group.lambda_group_lambda"}, {"data": {"resource_type": "aws_lambda_code_signing_config", "resource_name": "this", "resource_service": "lambda", "resource_icon": "aws/Architecture-Service-Icons_07312025/Arch_Compute/48/Arch_AWS-Lambda_48.svg", "description": "Code signing config for AFT Lambda", "allowed_publishers": [{"signing_profile_version_arns": ["${aws_signer_signing_profile.this.arn}"]}], "policies": [{"untrusted_artifact_on_deployment": "Warn"}]}, "id": "aws_lambda_code_signing_config.this"}, {"data": {"resource_type": "aws_signer_signing_profile", "resource_name": "this", "resource_service": "signer", "resource_icon": "aws/Architecture-Service-Icons_07312025/Arch_Security-Identity-Compliance/48/Arch_AWS-Signer_48.svg", "name_prefix": "AwsLambdaCodeSigningAction", "platform_id": "AWSLambda-SHA384-ECDSA", "signature_validity_period": [{"value": 5, "type": "YEARS"}]}, "id": "aws_signer_signing_profile.this"}, {"data": {"resource_type": "aws_lambda_function", "resource_name": "bi_chatbot_container_lambda", "resource_service": "lambda", "resource_icon": "aws/Architecture-Service-Icons_07312025/Arch_Compute/48/Arch_AWS-Lambda_48.svg", "function_name": "bi-chatbot-container-lambda-acme-prod", "handler": "lambda_function.lambda_handler", "runtime": "python3.12", "architectures": ["x86_64"], "kms_key_arn": "arn:aws:kms:us-west-2:XXXXXXXXXXXXX:key/1488f8c9-6443-4486-9927-8825278e3aad", "role": "${module.roles.bedrock_agent_lambda_role_arn}", "code_signing_config_arn": "${aws_lambda_code_signing_config.this.arn}", "reserved_concurrent_executions": -1, "timeout": 300, "publish": true, "s3_bucket": "<BUCKET-NAME>", "s3_key": "package.zip", "package_type": "Zip", "memory_size": 1024, "layers": ["arn:aws:lambda::017000801446:layer:AWSLambdaPowertoolsPythonV2:60"], "tracing_config": [{"mode": "Active"}], "dead_letter_config": [{"target_arn": "${aws_sqs_queue.bi_chatbot_container_lambda_dql.arn}"}], "vpc_config": [{"subnet_ids": ["subnet-0eb0b0e49448a5b49", "subnet-0f423fe837a1cfa22"], "security_group_ids": ["${aws_security_group.lambda_group_lambda.id}"]}], "environment": [{"variables": {"MODEL_ID": "anthropic.claude-3-haiku-20240307-v1:0", "HAIKU_MODEL_ID": "anthropic.claude-3-haiku-20240307-v1:0", "GROUP_DATA_OBJECT_KEY": "group_data.json", "REPORT_DATA_OBJECT_KEY": "report_data.json", "FILTER_DATA_OBJECT_KEY": "fields.json", "MAPPING_DATA_OBJECT_KEY": "maps.json", "REQUEST_TEMPLATE_OBJECT_KEY": "request_template.json", "RESPONSE_TEMPLATE_OBJECT_KEY": "response_template.json", "FEW_SHOT_OBJECT_KEY": "examples.json", "GENERATE_FIELDS": "id fiscal lifeToDate from to from1 to1 trend compare pivot1 pivot2 pivot3 pivot4 pivot5 pivot6 pivot7 pivot8 pivot9 pivot10 pivot11 pivot12 filters sorts", "AGENT_DESCRIPTION": "You are a fitness chatbot", "AGENT_INSTRUCTIONS": "You are a helpful fitness assistant. You have general knowledge about sports. You can answer\nquestions related to fitness, diet plans. Use only the tools or knowledge base provided to answer\nuser questions. Choose between the tools or the knowledge base. Do not use both. Do not respond\nwithout using a tool or knowledge base.\nWhen a user asks to calculate their BMI:\n1. Ask for their weight in kilograms.\n2. Ask for their height in meters\n3. If the user provides values in any other unit, convert it into kilograms for weight and\nmeters for height. Do not make any comments about health status.", "ACTION_GROUP_AGENT_DESCRIPTION": "Use the action group to get the fitness plans, diet plans and historical details", "KB_INSTRUCTIONS_FOR_AGENT": "Use the knowledge base when the user is asking for a definition about a fitness, diet plans. Give a very detailed answer and cite the source."}}]}, "id": "aws_lambda_function.bi_chatbot_container_lambda"}, {"data": {"resource_type": "aws_lambda_permission", "resource_name": "allow_bedrock_lambda_invoke", "resource_service": "lambda", "resource_icon": "aws/Architecture-Service-Icons_07312025/Arch_Compute/48/Arch_AWS-Lambda_48.svg", "statement_id": "AllowExecutionFromBedrock", "action": "lambda:InvokeFunction", "function_name": "${aws_lambda_function.bi_chatbot_container_lambda.function_name}", "principal": "bedrock.amazonaws.com", "source_account": null, "source_arn": "arn:aws:bedrock:::agent/*"}, "id": "aws_lambda_permission.allow_bedrock_lambda_invoke"}, {"data": {"resource_type": "aws_lambda_alias", "resource_name": "scale_up_lambda_alias", "resource_service": "lambda", "resource_icon": "aws/Architecture-Service-Icons_07312025/Arch_Compute/48/Arch_AWS-Lambda_48.svg", "name": "provisioned-${aws_lambda_function.bi_chatbot_container_lambda.function_name}", "description": "Alias for provisioned instances of ${aws_lambda_function.bi_chatbot_container_lambda.function_name}", "function_name": "${aws_lambda_function.bi_chatbot_container_lambda.function_name}", "function_version": "${aws_lambda_function.bi_chatbot_container_lambda.version}"}, "id": "aws_lambda_alias.scale_up_lambda_alias"}, {"data": {"resource_type": "aws_lambda_provisioned_concurrency_config", "resource_name": "concurrency_setup", "resource_service": "lambda", "resource_icon": "aws/Architecture-Service-Icons_07312025/Arch_Compute/48/Arch_AWS-Lambda_48.svg", "function_name": "${aws_lambda_function.bi_chatbot_container_lambda.function_name}", "provisioned_concurrent_executions": 3, "qualifier": "${aws_lambda_alias.scale_up_lambda_alias.name}"}, "id": "aws_lambda_provisioned_concurrency_config.concurrency_setup"}, {"data": {"resource_type": "null_resource", "resource_name": "lambda_code_update", "resource_service": "resource", "resource_icon": "terraform/terraform-logo.svg", "depends_on": ["${aws_lambda_function.bi_chatbot_container_lambda}"], "provisioner": [{"local-exec": {"command": "aws lambda update-function-code --function-name ${aws_lambda_function.bi_chatbot_container_lambda.function_name} --s3-bucket <BUCKET-NAME> --s3-key package.zip  --region "}}], "triggers": {"s3_object_version": null, "s3_object_etag": null}}, "id": "null_resource.lambda_code_update"}, {"data": {"resource_type": "aws_cloudwatch_log_group", "resource_name": "lambda_log_group", "resource_service": "cloudwatch", "resource_icon": "aws/Architecture-Service-Icons_07312025/Arch_Management-Governance/48/Arch_Amazon-CloudWatch_48.svg", "name": "/aws/lambda/${aws_lambda_function.bi_chatbot_container_lambda.function_name}", "retention_in_days": 365, "kms_key_id": "arn:aws:kms:us-west-2:XXXXXXXXXXXXX:key/1488f8c9-6443-4486-9927-8825278e3aad"}, "id": "aws_cloudwatch_log_group.lambda_log_group"}, {"data": {"resource_type": "aws_cloudwatch_log_stream", "resource_name": "lambda_log_stream", "resource_service": "cloudwatch", "resource_icon": "aws/Architecture-Service-Icons_07312025/Arch_Management-Governance/48/Arch_Amazon-CloudWatch_48.svg", "name": "${aws_lambda_function.bi_chatbot_container_lambda.function_name}-cw-stream", "log_group_name": "${aws_cloudwatch_log_group.lambda_log_group.name}"}, "id": "aws_cloudwatch_log_stream.lambda_log_stream"}, {"data": {"resource_type": "aws_bedrock_guardrail", "resource_name": "this", "resource_service": "bedrock", "resource_icon": "aws/Architecture-Service-Icons_07312025/Arch_Artificial-Intelligence/48/Arch_Amazon-Bedrock_48.svg", "name": "bedrock-guardrail", "kms_key_arn": "arn:aws:kms:us-west-2:XXXXXXXXXXXXX:key/1488f8c9-6443-4486-9927-8825278e3aad", "blocked_input_messaging": "This input is not allowed due to content restrictions.", "blocked_outputs_messaging": "The generated output was blocked due to content restrictions.", "description": "A guardrail for Bedrock to ensure safe and appropriate content", "dynamic": [{"content_policy_config": {"for_each": [{"filters_config": [{"input_strength": "MEDIUM", "output_strength": "MEDIUM", "type": "HATE"}, {"input_strength": "HIGH", "output_strength": "HIGH", "type": "VIOLENCE"}]}], "content": [{"dynamic": [{"filters_config": {"for_each": "${content_policy_config.value.filters_config}", "content": [{"input_strength": "${filters_config.value.input_strength}", "output_strength": "${filters_config.value.output_strength}", "type": "${filters_config.value.type}"}]}}]}]}}, {"sensitive_information_policy_config": {"for_each": [{"pii_entities_config": [{"action": "BLOCK", "type": "NAME"}, {"action": "BLOCK", "type": "EMAIL"}], "regexes_config": [{"action": "BLOCK", "description": "Block Social Security Numbers", "name": "SSN_Regex", "pattern": "^\\d{3}-\\d{2}-\\d{4}$"}]}], "content": [{"dynamic": [{"pii_entities_config": {"for_each": "${sensitive_information_policy_config.value.pii_entities_config}", "content": [{"action": "${pii_entities_config.value.action}", "type": "${pii_entities_config.value.type}"}]}}, {"regexes_config": {"for_each": "${sensitive_information_policy_config.value.regexes_config}", "content": [{"action": "${regexes_config.value.action}", "description": "${regexes_config.value.description}", "name": "${regexes_config.value.name}", "pattern": "${regexes_config.value.pattern}"}]}}]}]}}, {"topic_policy_config": {"for_each": [{"topics_config": [{"name": "investment_advice", "examples": ["Where should I invest my money?", "What stocks should I buy?"], "type": "DENY", "definition": "Any advice or recommendations regarding financial investments or asset allocation."}]}], "content": [{"dynamic": [{"topics_config": {"for_each": "${topic_policy_config.value.topics_config}", "content": [{"name": "${topics_config.value.name}", "examples": "${topics_config.value.examples}", "type": "${topics_config.value.type}", "definition": "${topics_config.value.definition}"}]}}]}]}}, {"word_policy_config": {"for_each": [{"managed_word_lists_config": [{"type": "PROFANITY"}], "words_config": [{"text": "badword1"}, {"text": "badword2"}]}], "content": [{"dynamic": [{"managed_word_lists_config": {"for_each": "${word_policy_config.value.managed_word_lists_config}", "content": [{"type": "${managed_word_lists_config.value.type}"}]}}, {"words_config": {"for_each": "${word_policy_config.value.words_config}", "content": [{"text": "${words_config.value.text}"}]}}]}]}}]}, "id": "aws_bedrock_guardrail.this"}, {"data": {"resource_type": "aws_security_group", "resource_name": "endpoint_security_group", "resource_service": "security", "resource_icon": "aws/Category-Icons_07312025/Arch-Category_48/Arch-Category_Security-Identity-Compliance_48.svg", "name": "vpc-endpoint-security-group-acme-prod", "vpc_id": "vpc-047dd28296946f67c", "description": "Security Group for VPC Endpoints", "ingress": [{"from_port": 0, "to_port": 0, "protocol": -1, "cidr_blocks": ["172.16.5.0/24", "172.16.6.0/24"], "description": "Allow all ingress from VPC CIDR"}], "egress": [{"from_port": 0, "to_port": 0, "protocol": -1, "cidr_blocks": ["0.0.0.0/0"], "description": "Allow egress to all"}]}, "id": "aws_security_group.endpoint_security_group"}, {"data": {"resource_type": "aws_vpc_endpoint", "resource_name": "interface_endpoints", "resource_service": "vpc", "resource_icon": "aws/Architecture-Group-Icons_07312025/AWS-Cloud_32.svg", "for_each": "${{for k , v in local.interface_endpoints : k => v if v.enabled}}", "vpc_id": "vpc-047dd28296946f67c", "service_name": "com.amazonaws..${each.value.service}", "vpc_endpoint_type": "Interface", "subnet_ids": ["subnet-0eb0b0e49448a5b49", "subnet-0f423fe837a1cfa22"], "security_group_ids": ["${aws_security_group.endpoint_security_group.id}"], "private_dns_enabled": true}, "id": "aws_vpc_endpoint.interface_endpoints"}, {"data": {"resource_type": "aws_vpc_endpoint", "resource_name": "bedrock_interface_endpoints", "resource_service": "vpc", "resource_icon": "aws/Architecture-Group-Icons_07312025/AWS-Cloud_32.svg", "for_each": "${{for k , v in local.bedrock_interface_endpoints : k => v if v.enabled}}", "vpc_id": "vpc-047dd28296946f67c", "service_name": "com.amazonaws..${each.value.service}", "vpc_endpoint_type": "Interface", "subnet_ids": ["subnet-0eb0b0e49448a5b49", "subnet-0f423fe837a1cfa22"], "security_group_ids": ["${aws_security_group.interface_group_lambda.id}"], "private_dns_enabled": true}, "id": "aws_vpc_endpoint.bedrock_interface_endpoints"}, {"data": {"resource_type": "aws_security_group", "resource_name": "interface_group_lambda", "resource_service": "security", "resource_icon": "aws/Category-Icons_07312025/Arch-Category_48/Arch-Category_Security-Identity-Compliance_48.svg", "name": "interface-security-group-acme-prod", "vpc_id": "vpc-047dd28296946f67c", "description": "Security Group for Bedrock Interface Endpoints", "ingress": [{"from_port": 0, "to_port": 0, "protocol": -1, "security_groups": ["${module.bedrock_agent.lambda_security_group_id}"], "description": "Allow calls only from Lambda Function"}], "egress": [{"from_port": 0, "to_port": 0, "protocol": -1, "cidr_blocks": ["0.0.0.0/0"], "description": "Allow egress to all"}]}, "id": "aws_security_group.interface_group_lambda"}, {"data": {"resource_type": "aws_opensearchserverless_vpc_endpoint", "resource_name": "aoss_vpc_endpoints", "resource_service": "opensearchserverless", "resource_icon": "aws/Architecture-Service-Icons_07312025/Arch_Analytics/48/Arch_Amazon-OpenSearch-Service_48.svg", "name": "aoss-vpc-endpoints", "subnet_ids": ["subnet-0eb0b0e49448a5b49", "subnet-0f423fe837a1cfa22"], "vpc_id": "vpc-047dd28296946f67c"}, "id": "aws_opensearchserverless_vpc_endpoint.aoss_vpc_endpoints"}, {"data": {"resource_type": "null_resource", "resource_name": "update_agent_check", "resource_service": "resource", "resource_icon": "terraform/terraform-logo.svg", "provisioner": [{"local-exec": {"command": "chmod +x ${path.module}/update_agent_check.sh; ${path.module}/update_agent_check.sh  <BUCKET-NAME> ${module.bedrock_agent.ssm_parameter_agent_name} ${module.bedrock_agent.ssm_parameter_agent_id} ${module.bedrock_agent.ssm_parameter_agent_instruction} ${module.bedrock_agent.ssm_parameter_agent_ag_instruction} ${module.bedrock_knowledge_base.ssm_parameter_knowledge_base_id} ${module.bedrock_agent.ssm_parameter_agent_ag_lambda_sha} ${module.bedrock_agent.lambda_function_name}   ${module.bedrock_agent.ssm_parameter_agent_alias}"}}], "triggers": {"always_run": "${timestamp()}"}}, "id": "null_resource.update_agent_check"}], "edges": [{"id": "aws_s3_bucket_server_side_encryption_configuration.sample_kb_bucket_encryption_configurations-aws_s3_bucket.sample_kb_bucket-['bucket']", "json_path": "bucket", "raw_value": "${aws_s3_bucket.sample_kb_bucket.id}", "source": "aws_s3_bucket_server_side_encryption_configuration.sample_kb_bucket_encryption_configurations", "target": "aws_s3_bucket.sample_kb_bucket"}, {"id": "aws_s3_bucket_server_side_encryption_configuration.sample_log_bucket_encryption_configurations-aws_s3_bucket.sample_kb_logging_bucket-['bucket']", "json_path": "bucket", "raw_value": "${aws_s3_bucket.sample_kb_logging_bucket.id}", "source": "aws_s3_bucket_server_side_encryption_configuration.sample_log_bucket_encryption_configurations", "target": "aws_s3_bucket.sample_kb_logging_bucket"}, {"id": "aws_s3_bucket_versioning.sample_kb_bucket_version-aws_s3_bucket.sample_kb_bucket-['bucket']", "json_path": "bucket", "raw_value": "${aws_s3_bucket.sample_kb_bucket.id}", "source": "aws_s3_bucket_versioning.sample_kb_bucket_version", "target": "aws_s3_bucket.sample_kb_bucket"}, {"id": "aws_s3_bucket_versioning.sample_kb_bucket_version-aws_s3_bucket_server_side_encryption_configuration.sample_kb_bucket_encryption_configurations-['depends_on', '0']", "json_path": "depends_on.0", "raw_value": "${aws_s3_bucket_server_side_encryption_configuration.sample_kb_bucket_encryption_configurations}", "source": "aws_s3_bucket_versioning.sample_kb_bucket_version", "target": "aws_s3_bucket_server_side_encryption_configuration.sample_kb_bucket_encryption_configurations"}, {"id": "aws_s3_bucket_logging.sample_kb_bucket_logging-aws_s3_bucket.sample_kb_bucket-['bucket']", "json_path": "bucket", "raw_value": "${aws_s3_bucket.sample_kb_bucket.id}", "source": "aws_s3_bucket_logging.sample_kb_bucket_logging", "target": "aws_s3_bucket.sample_kb_bucket"}, {"id": "aws_s3_bucket_logging.sample_kb_bucket_logging-aws_s3_bucket.sample_kb_logging_bucket-['target_bucket']", "json_path": "target_bucket", "raw_value": "${aws_s3_bucket.sample_kb_logging_bucket.id}", "source": "aws_s3_bucket_logging.sample_kb_bucket_logging", "target": "aws_s3_bucket.sample_kb_logging_bucket"}, {"id": "aws_s3_bucket_lifecycle_configuration.sample_kb_bucket_lifecycle-aws_s3_bucket.sample_kb_bucket-['bucket']", "json_path": "bucket", "raw_value": "${aws_s3_bucket.sample_kb_bucket.id}", "source": "aws_s3_bucket_lifecycle_configuration.sample_kb_bucket_lifecycle", "target": "aws_s3_bucket.sample_kb_bucket"}, {"id": "aws_s3_bucket_lifecycle_configuration.sample_kb_logging_bucket_lifecycle-aws_s3_bucket.sample_kb_logging_bucket-['bucket']", "json_path": "bucket", "raw_value": "${aws_s3_bucket.sample_kb_logging_bucket.id}", "source": "aws_s3_bucket_lifecycle_configuration.sample_kb_logging_bucket_lifecycle", "target": "aws_s3_bucket.sample_kb_logging_bucket"}, {"id": "aws_iam_role_policy.bedrock_iam_policy-aws_iam_role.bedrock_iam_role-['role']", "json_path": "role", "raw_value": "${aws_iam_role.bedrock_iam_role.id}", "source": "aws_iam_role_policy.bedrock_iam_policy", "target": "aws_iam_role.bedrock_iam_role"}, {"id": "aws_iam_role_policy.bedrock_sample_kb_model-aws_iam_role.bedrock_sample_kb_role-['role']", "json_path": "role", "raw_value": "${aws_iam_role.bedrock_sample_kb_role.name}", "source": "aws_iam_role_policy.bedrock_sample_kb_model", "target": "aws_iam_role.bedrock_sample_kb_role"}, {"id": "aws_iam_role_policy.bedrock_sample_kb_s3-aws_iam_role.bedrock_sample_kb_role-['role']", "json_path": "role", "raw_value": "${aws_iam_role.bedrock_sample_kb_role.name}", "source": "aws_iam_role_policy.bedrock_sample_kb_s3", "target": "aws_iam_role.bedrock_sample_kb_role"}, {"id": "aws_iam_role_policy_attachment.agent_lambda_role_policy_attachment-aws_iam_role.agent_lambda_role-['role']", "json_path": "role", "raw_value": "${aws_iam_role.agent_lambda_role.name}", "source": "aws_iam_role_policy_attachment.agent_lambda_role_policy_attachment", "target": "aws_iam_role.agent_lambda_role"}, {"id": "aws_iam_role_policy_attachment.agent_lambda_role_policy_attachment-aws_iam_policy.agent_lambda_role_policy-['policy_arn']", "json_path": "policy_arn", "raw_value": "${aws_iam_policy.agent_lambda_role_policy.arn}", "source": "aws_iam_role_policy_attachment.agent_lambda_role_policy_attachment", "target": "aws_iam_policy.agent_lambda_role_policy"}, {"id": "aws_iam_role_policy_attachment.bedrock_agent_permissions_attachment-aws_iam_role.agent_lambda_role-['role']", "json_path": "role", "raw_value": "${aws_iam_role.agent_lambda_role.name}", "source": "aws_iam_role_policy_attachment.bedrock_agent_permissions_attachment", "target": "aws_iam_role.agent_lambda_role"}, {"id": "aws_iam_role_policy_attachment.bedrock_agent_permissions_attachment-aws_iam_policy.agent_lambda_invoke_policy-['policy_arn']", "json_path": "policy_arn", "raw_value": "${aws_iam_policy.agent_lambda_invoke_policy.arn}", "source": "aws_iam_role_policy_attachment.bedrock_agent_permissions_attachment", "target": "aws_iam_policy.agent_lambda_invoke_policy"}, {"id": "aws_iam_role_policy_attachment.agent_lambda_s3_data_policy_attachment-aws_iam_role.agent_lambda_role-['role']", "json_path": "role", "raw_value": "${aws_iam_role.agent_lambda_role.name}", "source": "aws_iam_role_policy_attachment.agent_lambda_s3_data_policy_attachment", "target": "aws_iam_role.agent_lambda_role"}, {"id": "aws_iam_role_policy_attachment.agent_lambda_s3_data_policy_attachment-aws_iam_policy.agent_lambda_s3_data_policy-['policy_arn']", "json_path": "policy_arn", "raw_value": "${aws_iam_policy.agent_lambda_s3_data_policy.arn}", "source": "aws_iam_role_policy_attachment.agent_lambda_s3_data_policy_attachment", "target": "aws_iam_policy.agent_lambda_s3_data_policy"}, {"id": "aws_iam_role_policy_attachment.lamba_exec_role_eni-aws_iam_role.agent_lambda_role-['role']", "json_path": "role", "raw_value": "${aws_iam_role.agent_lambda_role.name}", "source": "aws_iam_role_policy_attachment.lamba_exec_role_eni", "target": "aws_iam_role.agent_lambda_role"}, {"id": "aws_iam_role_policy.bedrock_logging_policy-aws_iam_role.bedrock_logging_role-['role']", "json_path": "role", "raw_value": "${aws_iam_role.bedrock_logging_role.id}", "source": "aws_iam_role_policy.bedrock_logging_policy", "target": "aws_iam_role.bedrock_logging_role"}, {"id": "aws_opensearchserverless_collection.sample_aoss_collection-aws_opensearchserverless_access_policy.sample_kb_aoss_policy-['depends_on', '0']", "json_path": "depends_on.0", "raw_value": "${aws_opensearchserverless_access_policy.sample_kb_aoss_policy}", "source": "aws_opensearchserverless_collection.sample_aoss_collection", "target": "aws_opensearchserverless_access_policy.sample_kb_aoss_policy"}, {"id": "aws_opensearchserverless_collection.sample_aoss_collection-aws_opensearchserverless_security_policy.sample_kb_encryption_policy-['depends_on', '1']", "json_path": "depends_on.1", "raw_value": "${aws_opensearchserverless_security_policy.sample_kb_encryption_policy}", "source": "aws_opensearchserverless_collection.sample_aoss_collection", "target": "aws_opensearchserverless_security_policy.sample_kb_encryption_policy"}, {"id": "aws_opensearchserverless_collection.sample_aoss_collection-aws_opensearchserverless_security_policy.sample_kb_network_policy-['depends_on', '2']", "json_path": "depends_on.2", "raw_value": "${aws_opensearchserverless_security_policy.sample_kb_network_policy}", "source": "aws_opensearchserverless_collection.sample_aoss_collection", "target": "aws_opensearchserverless_security_policy.sample_kb_network_policy"}, {"id": "opensearch_index.sample_aoss_index-aws_opensearchserverless_collection.sample_aoss_collection-['depends_on', '0']", "json_path": "depends_on.0", "raw_value": "${aws_opensearchserverless_collection.sample_aoss_collection}", "source": "opensearch_index.sample_aoss_index", "target": "aws_opensearchserverless_collection.sample_aoss_collection"}, {"id": "aws_ssm_parameter.knowledge_base_id-aws_bedrockagent_knowledge_base.sample_kb-['value']", "json_path": "value", "raw_value": "${aws_bedrockagent_knowledge_base.sample_kb.id}", "source": "aws_ssm_parameter.knowledge_base_id", "target": "aws_bedrockagent_knowledge_base.sample_kb"}, {"id": "aws_ssm_parameter.knowledge_base_data_source_id-aws_bedrockagent_data_source.data_source-['value']", "json_path": "value", "raw_value": "${aws_bedrockagent_data_source.data_source.id}", "source": "aws_ssm_parameter.knowledge_base_data_source_id", "target": "aws_bedrockagent_data_source.data_source"}, {"id": "aws_ssm_parameter.bedrock_agent_instruction_ssm_history-aws_bedrockagent_agent_alias.bedrock_agent_alias-['depends_on', '0']", "json_path": "depends_on.0", "raw_value": "${aws_bedrockagent_agent_alias.bedrock_agent_alias}", "source": "aws_ssm_parameter.bedrock_agent_instruction_ssm_history", "target": "aws_bedrockagent_agent_alias.bedrock_agent_alias"}, {"id": "time_sleep.aws_iam_role_policy_bedrock_sample_kb_oss-aws_iam_role_policy.bedrock_sample_kb_oss-['depends_on', '0']", "json_path": "depends_on.0", "raw_value": "${aws_iam_role_policy.bedrock_sample_kb_oss}", "source": "time_sleep.aws_iam_role_policy_bedrock_sample_kb_oss", "target": "aws_iam_role_policy.bedrock_sample_kb_oss"}, {"id": "aws_bedrockagent_data_source.data_source-aws_bedrockagent_knowledge_base.sample_kb-['knowledge_base_id']", "json_path": "knowledge_base_id", "raw_value": "${aws_bedrockagent_knowledge_base.sample_kb.id}", "source": "aws_bedrockagent_data_source.data_source", "target": "aws_bedrockagent_knowledge_base.sample_kb"}, {"id": "aws_ssm_parameter.bedrock_agent_id-aws_bedrockagent_agent.bedrock_agent-['value']", "json_path": "value", "raw_value": "${aws_bedrockagent_agent.bedrock_agent.agent_id}", "source": "aws_ssm_parameter.bedrock_agent_id", "target": "aws_bedrockagent_agent.bedrock_agent"}, {"id": "aws_ssm_parameter.bedrock_agent_id-aws_bedrockagent_agent_alias.bedrock_agent_alias-['depends_on', '0']", "json_path": "depends_on.0", "raw_value": "${aws_bedrockagent_agent_alias.bedrock_agent_alias}", "source": "aws_ssm_parameter.bedrock_agent_id", "target": "aws_bedrockagent_agent_alias.bedrock_agent_alias"}, {"id": "aws_ssm_parameter.bedrock_agent_name-aws_bedrockagent_agent.bedrock_agent-['value']", "json_path": "value", "raw_value": "${aws_bedrockagent_agent.bedrock_agent.agent_name}", "source": "aws_ssm_parameter.bedrock_agent_name", "target": "aws_bedrockagent_agent.bedrock_agent"}, {"id": "aws_ssm_parameter.bedrock_agent_name-aws_bedrockagent_agent_alias.bedrock_agent_alias-['depends_on', '0']", "json_path": "depends_on.0", "raw_value": "${aws_bedrockagent_agent_alias.bedrock_agent_alias}", "source": "aws_ssm_parameter.bedrock_agent_name", "target": "aws_bedrockagent_agent_alias.bedrock_agent_alias"}, {"id": "aws_ssm_parameter.bedrock_agent_alias-aws_bedrockagent_agent_alias.bedrock_agent_alias-['depends_on', '0']", "json_path": "depends_on.0", "raw_value": "${aws_bedrockagent_agent_alias.bedrock_agent_alias}", "source": "aws_ssm_parameter.bedrock_agent_alias", "target": "aws_bedrockagent_agent_alias.bedrock_agent_alias"}, {"id": "aws_ssm_parameter.bedrock_agent_arn-aws_bedrockagent_agent.bedrock_agent-['value']", "json_path": "value", "raw_value": "${aws_bedrockagent_agent.bedrock_agent.agent_arn}", "source": "aws_ssm_parameter.bedrock_agent_arn", "target": "aws_bedrockagent_agent.bedrock_agent"}, {"id": "aws_ssm_parameter.bedrock_agent_arn-aws_bedrockagent_agent_alias.bedrock_agent_alias-['depends_on', '0']", "json_path": "depends_on.0", "raw_value": "${aws_bedrockagent_agent_alias.bedrock_agent_alias}", "source": "aws_ssm_parameter.bedrock_agent_arn", "target": "aws_bedrockagent_agent_alias.bedrock_agent_alias"}, {"id": "aws_ssm_parameter.bedrock_agent_instruction-aws_bedrockagent_agent.bedrock_agent-['value']", "json_path": "value", "raw_value": "${aws_bedrockagent_agent.bedrock_agent.instruction}", "source": "aws_ssm_parameter.bedrock_agent_instruction", "target": "aws_bedrockagent_agent.bedrock_agent"}, {"id": "aws_ssm_parameter.bedrock_agent_instruction-aws_bedrockagent_agent_alias.bedrock_agent_alias-['depends_on', '0']", "json_path": "depends_on.0", "raw_value": "${aws_bedrockagent_agent_alias.bedrock_agent_alias}", "source": "aws_ssm_parameter.bedrock_agent_instruction", "target": "aws_bedrockagent_agent_alias.bedrock_agent_alias"}, {"id": "aws_ssm_parameter.bedrock_agent_action_group_instruction-aws_bedrockagent_agent_knowledge_base_association.bedrock_agent_kb_association-['value']", "json_path": "value", "raw_value": "${aws_bedrockagent_agent_knowledge_base_association.bedrock_agent_kb_association.description}", "source": "aws_ssm_parameter.bedrock_agent_action_group_instruction", "target": "aws_bedrockagent_agent_knowledge_base_association.bedrock_agent_kb_association"}, {"id": "aws_ssm_parameter.bedrock_agent_action_group_instruction-aws_bedrockagent_agent_alias.bedrock_agent_alias-['depends_on', '0']", "json_path": "depends_on.0", "raw_value": "${aws_bedrockagent_agent_alias.bedrock_agent_alias}", "source": "aws_ssm_parameter.bedrock_agent_action_group_instruction", "target": "aws_bedrockagent_agent_alias.bedrock_agent_alias"}, {"id": "aws_ssm_parameter.action_group_lambda_sha-aws_bedrockagent_agent_alias.bedrock_agent_alias-['depends_on', '0']", "json_path": "depends_on.0", "raw_value": "${aws_bedrockagent_agent_alias.bedrock_agent_alias}", "source": "aws_ssm_parameter.action_group_lambda_sha", "target": "aws_bedrockagent_agent_alias.bedrock_agent_alias"}, {"id": "aws_bedrockagent_agent_action_group.bedrock_agent_actiongroup-aws_bedrockagent_agent.bedrock_agent-['agent_id']", "json_path": "agent_id", "raw_value": "${aws_bedrockagent_agent.bedrock_agent.id}", "source": "aws_bedrockagent_agent_action_group.bedrock_agent_actiongroup", "target": "aws_bedrockagent_agent.bedrock_agent"}, {"id": "aws_bedrockagent_agent_action_group.bedrock_agent_actiongroup-aws_lambda_function.bi_chatbot_container_lambda-['action_group_executor', '0', 'lambda']", "json_path": "action_group_executor.0.lambda", "raw_value": "${aws_lambda_function.bi_chatbot_container_lambda.arn}", "source": "aws_bedrockagent_agent_action_group.bedrock_agent_actiongroup", "target": "aws_lambda_function.bi_chatbot_container_lambda"}, {"id": "aws_bedrockagent_agent_knowledge_base_association.bedrock_agent_kb_association-aws_bedrockagent_agent.bedrock_agent-['agent_id']", "json_path": "agent_id", "raw_value": "${aws_bedrockagent_agent.bedrock_agent.agent_id}", "source": "aws_bedrockagent_agent_knowledge_base_association.bedrock_agent_kb_association", "target": "aws_bedrockagent_agent.bedrock_agent"}, {"id": "null_resource.agent_prepare-aws_bedrockagent_agent.bedrock_agent-['depends_on', '0']", "json_path": "depends_on.0", "raw_value": "${aws_bedrockagent_agent.bedrock_agent}", "source": "null_resource.agent_prepare", "target": "aws_bedrockagent_agent.bedrock_agent"}, {"id": "null_resource.agent_prepare-aws_bedrockagent_agent_action_group.bedrock_agent_actiongroup-['depends_on', '1']", "json_path": "depends_on.1", "raw_value": "${aws_bedrockagent_agent_action_group.bedrock_agent_actiongroup}", "source": "null_resource.agent_prepare", "target": "aws_bedrockagent_agent_action_group.bedrock_agent_actiongroup"}, {"id": "null_resource.agent_prepare-aws_bedrockagent_agent_knowledge_base_association.bedrock_agent_kb_association-['depends_on', '2']", "json_path": "depends_on.2", "raw_value": "${aws_bedrockagent_agent_knowledge_base_association.bedrock_agent_kb_association}", "source": "null_resource.agent_prepare", "target": "aws_bedrockagent_agent_knowledge_base_association.bedrock_agent_kb_association"}, {"id": "aws_bedrockagent_agent_alias.bedrock_agent_alias-aws_bedrockagent_agent.bedrock_agent-['agent_id']", "json_path": "agent_id", "raw_value": "${aws_bedrockagent_agent.bedrock_agent.agent_id}", "source": "aws_bedrockagent_agent_alias.bedrock_agent_alias", "target": "aws_bedrockagent_agent.bedrock_agent"}, {"id": "aws_cloudwatch_log_stream.agent_invoke_log_stream-aws_cloudwatch_log_group.agent_invoke_log_group-['log_group_name']", "json_path": "log_group_name", "raw_value": "${aws_cloudwatch_log_group.agent_invoke_log_group.name}", "source": "aws_cloudwatch_log_stream.agent_invoke_log_stream", "target": "aws_cloudwatch_log_group.agent_invoke_log_group"}, {"id": "aws_bedrock_model_invocation_logging_configuration.cloudwatch_only-aws_cloudwatch_log_group.agent_invoke_log_group-['depends_on', '0']", "json_path": "depends_on.0", "raw_value": "${aws_cloudwatch_log_group.agent_invoke_log_group}", "source": "aws_bedrock_model_invocation_logging_configuration.cloudwatch_only", "target": "aws_cloudwatch_log_group.agent_invoke_log_group"}, {"id": "aws_bedrock_model_invocation_logging_configuration.cloudwatch_only-aws_cloudwatch_log_stream.agent_invoke_log_stream-['depends_on', '1']", "json_path": "depends_on.1", "raw_value": "${aws_cloudwatch_log_stream.agent_invoke_log_stream}", "source": "aws_bedrock_model_invocation_logging_configuration.cloudwatch_only", "target": "aws_cloudwatch_log_stream.agent_invoke_log_stream"}, {"id": "aws_lambda_code_signing_config.this-aws_signer_signing_profile.this-['allowed_publishers', '0', 'signing_profile_version_arns', '0']", "json_path": "allowed_publishers.0.signing_profile_version_arns.0", "raw_value": "${aws_signer_signing_profile.this.arn}", "source": "aws_lambda_code_signing_config.this", "target": "aws_signer_signing_profile.this"}, {"id": "aws_lambda_function.bi_chatbot_container_lambda-aws_lambda_code_signing_config.this-['code_signing_config_arn']", "json_path": "code_signing_config_arn", "raw_value": "${aws_lambda_code_signing_config.this.arn}", "source": "aws_lambda_function.bi_chatbot_container_lambda", "target": "aws_lambda_code_signing_config.this"}, {"id": "aws_lambda_function.bi_chatbot_container_lambda-aws_sqs_queue.bi_chatbot_container_lambda_dql-['dead_letter_config', '0', 'target_arn']", "json_path": "dead_letter_config.0.target_arn", "raw_value": "${aws_sqs_queue.bi_chatbot_container_lambda_dql.arn}", "source": "aws_lambda_function.bi_chatbot_container_lambda", "target": "aws_sqs_queue.bi_chatbot_container_lambda_dql"}, {"id": "aws_lambda_function.bi_chatbot_container_lambda-aws_security_group.lambda_group_lambda-['vpc_config', '0', 'security_group_ids', '0']", "json_path": "vpc_config.0.security_group_ids.0", "raw_value": "${aws_security_group.lambda_group_lambda.id}", "source": "aws_lambda_function.bi_chatbot_container_lambda", "target": "aws_security_group.lambda_group_lambda"}, {"id": "aws_lambda_permission.allow_bedrock_lambda_invoke-aws_lambda_function.bi_chatbot_container_lambda-['function_name']", "json_path": "function_name", "raw_value": "${aws_lambda_function.bi_chatbot_container_lambda.function_name}", "source": "aws_lambda_permission.allow_bedrock_lambda_invoke", "target": "aws_lambda_function.bi_chatbot_container_lambda"}, {"id": "aws_lambda_alias.scale_up_lambda_alias-aws_lambda_function.bi_chatbot_container_lambda-['function_version']", "json_path": "function_version", "raw_value": "${aws_lambda_function.bi_chatbot_container_lambda.version}", "source": "aws_lambda_alias.scale_up_lambda_alias", "target": "aws_lambda_function.bi_chatbot_container_lambda"}, {"id": "aws_lambda_provisioned_concurrency_config.concurrency_setup-aws_lambda_function.bi_chatbot_container_lambda-['function_name']", "json_path": "function_name", "raw_value": "${aws_lambda_function.bi_chatbot_container_lambda.function_name}", "source": "aws_lambda_provisioned_concurrency_config.concurrency_setup", "target": "aws_lambda_function.bi_chatbot_container_lambda"}, {"id": "aws_lambda_provisioned_concurrency_config.concurrency_setup-aws_lambda_alias.scale_up_lambda_alias-['qualifier']", "json_path": "qualifier", "raw_value": "${aws_lambda_alias.scale_up_lambda_alias.name}", "source": "aws_lambda_provisioned_concurrency_config.concurrency_setup", "target": "aws_lambda_alias.scale_up_lambda_alias"}, {"id": "null_resource.lambda_code_update-aws_lambda_function.bi_chatbot_container_lambda-['provisioner', '0', 'local-exec', 'command']", "json_path": "provisioner.0.local-exec.command", "raw_value": "aws lambda update-function-code --function-name ${aws_lambda_function.bi_chatbot_container_lambda.function_name} --s3-bucket <BUCKET-NAME> --s3-key package.zip  --region ", "source": "null_resource.lambda_code_update", "target": "aws_lambda_function.bi_chatbot_container_lambda"}, {"id": "aws_cloudwatch_log_group.lambda_log_group-aws_lambda_function.bi_chatbot_container_lambda-['name']", "json_path": "name", "raw_value": "/aws/lambda/${aws_lambda_function.bi_chatbot_container_lambda.function_name}", "source": "aws_cloudwatch_log_group.lambda_log_group", "target": "aws_lambda_function.bi_chatbot_container_lambda"}, {"id": "aws_cloudwatch_log_stream.lambda_log_stream-aws_lambda_function.bi_chatbot_container_lambda-['name']", "json_path": "name", "raw_value": "${aws_lambda_function.bi_chatbot_container_lambda.function_name}-cw-stream", "source": "aws_cloudwatch_log_stream.lambda_log_stream", "target": "aws_lambda_function.bi_chatbot_container_lambda"}, {"id": "aws_cloudwatch_log_stream.lambda_log_stream-aws_cloudwatch_log_group.lambda_log_group-['log_group_name']", "json_path": "log_group_name", "raw_value": "${aws_cloudwatch_log_group.lambda_log_group.name}", "source": "aws_cloudwatch_log_stream.lambda_log_stream", "target": "aws_cloudwatch_log_group.lambda_log_group"}, {"id": "aws_vpc_endpoint.interface_endpoints-aws_security_group.endpoint_security_group-['security_group_ids', '0']", "json_path": "security_group_ids.0", "raw_value": "${aws_security_group.endpoint_security_group.id}", "source": "aws_vpc_endpoint.interface_endpoints", "target": "aws_security_group.endpoint_security_group"}, {"id": "aws_vpc_endpoint.bedrock_interface_endpoints-aws_security_group.interface_group_lambda-['security_group_ids', '0']", "json_path": "security_group_ids.0", "raw_value": "${aws_security_group.interface_group_lambda.id}", "source": "aws_vpc_endpoint.bedrock_interface_endpoints", "target": "aws_security_group.interface_group_lambda"}]}