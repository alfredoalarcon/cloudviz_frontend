{
  "directed": true,
  "multigraph": false,
  "graph": {},
  "nodes": [
    {
      "data": {
        "resource_type": "aws_cloudformation_stack_set",
        "resource_name": "sra_execution_role_stackset",
        "resource_service": "cloudformation",
        "resource_icon": "aws/Architecture-Service-Icons_07312025/Arch_Management-Governance/48/Arch_AWS-CloudFormation_48.svg",
        "name": "sra-stackset-execution-role",
        "description": "SRA execution role stackset",
        "template_body": "${file(\"${path.root}/sra_execution_role/execution-role.yaml\")}",
        "parameters": {
          "pSRAExecutionRoleName": "sra-execution",
          "pSRASolutionName": "sra-create-deployment-roles",
          "pManagementAccountId": null
        },
        "auto_deployment": [
          {
            "enabled": true,
            "retain_stacks_on_account_removal": false
          }
        ],
        "call_as": "SELF",
        "capabilities": [
          "CAPABILITY_NAMED_IAM"
        ],
        "managed_execution": [
          {
            "active": true
          }
        ],
        "operation_preferences": [
          {
            "failure_tolerance_percentage": 100,
            "max_concurrent_percentage": 100,
            "region_concurrency_type": "PARALLEL"
          }
        ],
        "permission_model": "SERVICE_MANAGED"
      },
      "id": "aws_cloudformation_stack_set.sra_execution_role_stackset"
    },
    {
      "data": {
        "resource_type": "aws_cloudformation_stack_set_instance",
        "resource_name": "sra_execution_role_stackset_instance",
        "resource_service": "cloudformation",
        "resource_icon": "aws/Architecture-Service-Icons_07312025/Arch_Management-Governance/48/Arch_AWS-CloudFormation_48.svg",
        "deployment_targets": [
          {
            "organizational_unit_ids": [
              null
            ]
          }
        ],
        "region": null,
        "stack_set_name": "${aws_cloudformation_stack_set.sra_execution_role_stackset.name}"
      },
      "id": "aws_cloudformation_stack_set_instance.sra_execution_role_stackset_instance"
    },
    {
      "data": {
        "resource_type": "local_file",
        "resource_name": "backend_file_creation",
        "resource_service": "terraform/terraform-logo.svg",
        "resource_icon": "terraform/terraform-logo.svg",
        "depends_on": [
          "${module.mangement_account_parameters}"
        ],
        "content": "########################################################################\n# Main Configuration\n########################################################################\nbucket         = \"${module.s3_state_bucket.bucket_name}\"\nkey            = \"state/sra_state.tfstate\"\nregion         = \"\"\nencrypt        = true\ndynamodb_table = \"${module.dynamo_tf_lock.dynamo_db_table_name}\"",
        "filename": "${path.root}/../solutions/backend.tfvars"
      },
      "id": "local_file.backend_file_creation"
    },
    {
      "data": {
        "resource_type": "local_file",
        "resource_name": "config_file_creation",
        "resource_service": "terraform/terraform-logo.svg",
        "resource_icon": "terraform/terraform-logo.svg",
        "depends_on": [
          "${module.mangement_account_parameters}"
        ],
        "content": "    ########################################################################\n    # Main Configuration\n    ########################################################################\n    audit_account_id                                   = \"\"\n    home_region                                        = \"\"\n    log_archive_account_id                             = \"\"\n    management_account_id                              = \"\"\n    organization_id                                    = \"\"\n    root_organizational_unit_id                        = \"\"\n    customer_control_tower_regions                     = \"\"\n    customer_control_tower_regions_without_home_region = \"\"\n    enabled_regions                                    = \"\"\n    enabled_regions_without_home_region                = \"\"\n\n    ########################################################################\n    # Services to enable/disable\n    ########################################################################\n    enable_gd                  = false\n    enable_sh                  = false\n    enable_access_analyzer     = false\n    enable_macie               = false\n    enable_cloudtrail_org      = false\n    enable_iam_password_policy = false\n    enable_inspector           = false\n    \n    ########################################################################\n    # Guard Duty Settings\n    ########################################################################\n    disable_guard_duty                   = false\n    enable_s3_logs                       = true\n    enable_kubernetes_audit_logs         = true\n    enable_malware_protection            = true\n    enable_rds_login_events              = true\n    enable_runtime_monitoring            = true\n    enable_ecs_fargate_agent_management  = true\n    enable_ec2_agent_management          = true\n    enable_eks_addon_management          = true\n    enable_lambda_network_logs           = true\n    guardduty_control_tower_regions_only = true\n    finding_publishing_frequency         = \"FIFTEEN_MINUTES\"\n\n    ########################################################################\n    # Security Hub Settings\n    ########################################################################\n    disable_security_hub                     = false\n    cis_standard_version                     = \"3.0.0\"\n    compliance_frequency                     = \"7\"\n    securityhub_control_tower_regions_only   = true\n    enable_cis_standard                      = false\n    enable_pci_standard                      = false\n    enable_nist_standard                     = false\n    enable_security_best_practices_standard  = true\n    pci_standard_version                     = \"3.2.1\"\n    nist_standard_version                    = \"5.0.0\"\n    security_best_practices_standard_version = \"1.0.0\"\n\n    ########################################################################\n    # Inspector Settings\n    ########################################################################\n    disable_inspector                    = false # set true BEFORE destroy\n    ecr_rescan_duration                  = \"LIFETIME\"\n    scan_components                      = \"EC2,ECR,LAMBDA,LAMBDA_CODE\"\n    inspector_control_tower_regions_only = true\n\n    ########################################################################\n    # IAM Password Policy\n    ########################################################################\n    iam_password_policy_allow_users_to_change_password = true\n    iam_password_policy_hard_expiry                    = false\n    iam_password_policy_max_password_age               = 90\n    iam_password_policy_minimum_password_length        = 14\n    iam_password_policy_password_reuse_prevention      = 24\n    iam_password_policy_require_lowercase_characters   = true\n    iam_password_policy_require_numbers                = true\n    iam_password_policy_require_symbols                = true\n    iam_password_policy_require_uppercase_characters   = true\n    \n    ########################################################################\n    # Macie Settings\n    ########################################################################\n    disable_macie                      = false\n    macie_finding_publishing_frequency = \"FIFTEEN_MINUTES\"\n\n    ########################################################################\n    # CloudTrail Settings\n    ########################################################################\n    enable_data_events_only   = true\n    enable_lambda_data_events = true\n    enable_s3_data_events     = true\n    disable_cloudtrail        = false",
        "filename": "${path.root}/../solutions/config.tfvars"
      },
      "id": "local_file.config_file_creation"
    },
    {
      "data": {
        "resource_type": "null_resource",
        "resource_name": "package_lambda",
        "resource_service": "terraform/terraform-logo.svg",
        "resource_icon": "terraform/terraform-logo.svg",
        "triggers": {
          "src_hash": null
        },
        "provisioner": [
          {
            "local-exec": {
              "command": "    rm -rf ${path.module}/lambda/package && mkdir ${path.module}/lambda/package\n    python3 -m pip install -r ${path.root}/../../solutions/iam/iam_password_policy/lambda/src/requirements.txt -t ${path.module}/lambda/package\n    python3 -m pip install -r ${path.root}/../../solutions/iam/iam_password_policy/lambda/src/../../layer/boto3/package.txt -t ${path.module}/lambda/package\n    cp ${path.root}/../../solutions/iam/iam_password_policy/lambda/src/*.py ${path.module}/lambda/package/\n    cd ${path.module}/lambda/package\n    zip -r ../lambda_function.zip ."
            }
          }
        ]
      },
      "id": "null_resource.package_lambda"
    },
    {
      "data": {
        "resource_type": "aws_lambda_function",
        "resource_name": "management_account_parameters",
        "resource_service": "lambda",
        "resource_icon": "aws/Architecture-Service-Icons_07312025/Arch_Compute/48/Arch_AWS-Lambda_48.svg",
        "function_name": "sra-management-account-parameters",
        "source_code_hash": null,
        "filename": null,
        "handler": "app.terraform_handler",
        "runtime": "python3.9",
        "role": "${aws_iam_role.management_account_parameters_lambda_role.arn}",
        "timeout": 300,
        "memory_size": 128,
        "environment": [
          {
            "variables": {
              "LOG_LEVEL": "INFO",
              "TAG_KEY": "sra-solution",
              "TAG_VALUE": "sra-common-prerequisites",
              "CONTROL_TOWER": "true",
              "OTHER_REGIONS": "ct-regions",
              "OTHER_SECURITY_ACCT": 111111111111,
              "OTHER_LOG_ARCHIVE_ACCT": 222222222222
            }
          }
        ],
        "architectures": [
          "arm64"
        ],
        "tags": {
          "\"${var.sra_solution_tag_key}\"": "sra-common-prerequisites"
        }
      },
      "id": "aws_lambda_function.management_account_parameters"
    },
    {
      "data": {
        "resource_type": "aws_cloudwatch_log_group",
        "resource_name": "management_account_parameters",
        "resource_service": "cloudwatch",
        "resource_icon": "aws/Architecture-Service-Icons_07312025/Arch_Management-Governance/48/Arch_Amazon-CloudWatch_48.svg",
        "count": 1,
        "name": "/aws/lambda/${aws_lambda_function.management_account_parameters.function_name}",
        "kms_key_id": "",
        "retention_in_days": 14
      },
      "id": "aws_cloudwatch_log_group.management_account_parameters"
    },
    {
      "data": {
        "resource_type": "aws_iam_role",
        "resource_name": "management_account_parameters_lambda_role",
        "resource_service": "iam",
        "resource_icon": "aws/Architecture-Service-Icons_07312025/Arch_Security-Identity-Compliance/48/Arch_AWS-Identity-and-Access-Management_48.svg",
        "name": "sra-management-account-parameters-lambda",
        "description": "Role for 'sra-management-account-parameters-lambda' Lambda function",
        "assume_role_policy": null,
        "tags": {
          "\"${var.sra_solution_tag_key}\"": "sra-common-prerequisites"
        }
      },
      "id": "aws_iam_role.management_account_parameters_lambda_role"
    },
    {
      "data": {
        "resource_type": "aws_iam_role_policy",
        "resource_name": "cloudwatch_policy_attachment",
        "resource_service": "iam",
        "resource_icon": "aws/Architecture-Service-Icons_07312025/Arch_Security-Identity-Compliance/48/Arch_AWS-Identity-and-Access-Management_48.svg",
        "name": "CloudWatchLogGroup",
        "role": "${aws_iam_role.management_account_parameters_lambda_role.id}",
        "policy": null
      },
      "id": "aws_iam_role_policy.cloudwatch_policy_attachment"
    },
    {
      "data": {
        "resource_type": "aws_iam_role_policy",
        "resource_name": "management_account_parameters_lambda_ssm_policy_attachment",
        "resource_service": "iam",
        "resource_icon": "aws/Architecture-Service-Icons_07312025/Arch_Security-Identity-Compliance/48/Arch_AWS-Identity-and-Access-Management_48.svg",
        "name": "ssm-account-parameter-creator",
        "role": "${aws_iam_role.management_account_parameters_lambda_role.id}",
        "policy": null
      },
      "id": "aws_iam_role_policy.management_account_parameters_lambda_ssm_policy_attachment"
    },
    {
      "data": {
        "resource_type": "aws_lambda_invocation",
        "resource_name": "lambda_invoke",
        "resource_service": "lambda",
        "resource_icon": "aws/Architecture-Service-Icons_07312025/Arch_Compute/48/Arch_AWS-Lambda_48.svg",
        "function_name": "${aws_lambda_function.iam_password_policy_lambda_function.function_name}",
        "input": "${jsonencode({\"RequestType\": \"Create\", \"ResourceType\": \"Terraform\", \"ResourceProperties\": {\"ServiceToken\": \"${aws_lambda_function.iam_password_policy_lambda_function.arn}\", \"HARD_EXPIRY\": \"unknown\", \"MAX_PASSWORD_AGE\": \"unknown\", \"PASSWORD_REUSE_PREVENTION\": \"unknown\", \"MINIMUM_PASSWORD_LENGTH\": \"unknown\", \"REQUIRE_LOWERCASE_CHARACTERS\": \"unknown\", \"REQUIRE_NUMBERS\": \"unknown\", \"REQUIRE_SYMBOLS\": \"unknown\", \"REQUIRE_UPPERCASE_CHARACTERS\": \"unknown\", \"ALLOW_USERS_TO_CHANGE_PASSWORD\": \"unknown\"}})}"
      },
      "id": "aws_lambda_invocation.lambda_invoke"
    },
    {
      "data": {
        "resource_type": "aws_iam_role",
        "resource_name": "sra_execution_role",
        "resource_service": "iam",
        "resource_icon": "aws/Architecture-Service-Icons_07312025/Arch_Security-Identity-Compliance/48/Arch_AWS-Identity-and-Access-Management_48.svg",
        "name": "sra-execution",
        "assume_role_policy": "${jsonencode({\"Version\": \"2012-10-17\", \"Statement\": [{\"Action\": \"sts:AssumeRole\", \"Effect\": \"Allow\", \"Principal\": {\"AWS\": \"${format(\"arn:%s:iam::%s:root\", var.aws_partition, var.management_account_id)}\"}}]})}",
        "tags": {
          "sra-solution": "sra-create-deployment-roles"
        }
      },
      "id": "aws_iam_role.sra_execution_role"
    },
    {
      "data": {
        "resource_type": "aws_iam_role_policy_attachment",
        "resource_name": "sra_execution_role_admin_policy",
        "resource_service": "iam",
        "resource_icon": "aws/Architecture-Service-Icons_07312025/Arch_Security-Identity-Compliance/48/Arch_AWS-Identity-and-Access-Management_48.svg",
        "role": "${aws_iam_role.sra_execution_role.name}",
        "policy_arn": "${format(\"arn:%s:iam::aws:policy/AdministratorAccess\", var.aws_partition)}"
      },
      "id": "aws_iam_role_policy_attachment.sra_execution_role_admin_policy"
    },
    {
      "data": {
        "resource_type": "aws_kms_key",
        "resource_name": "sra_secrets_key",
        "resource_service": "kms",
        "resource_icon": "aws/Architecture-Service-Icons_07312025/Arch_Security-Identity-Compliance/48/Arch_AWS-Key-Management-Service_48.svg",
        "description": "SRA Secrets Key",
        "enable_key_rotation": true,
        "policy": null
      },
      "id": "aws_kms_key.sra_secrets_key"
    },
    {
      "data": {
        "resource_type": "aws_kms_alias",
        "resource_name": "sra_secrets_key_alias",
        "resource_service": "kms",
        "resource_icon": "aws/Architecture-Service-Icons_07312025/Arch_Security-Identity-Compliance/48/Arch_AWS-Key-Management-Service_48.svg",
        "name": "alias/sra-secrets-key",
        "target_key_id": "${aws_kms_key.sra_secrets_key.key_id}"
      },
      "id": "aws_kms_alias.sra_secrets_key_alias"
    },
    {
      "data": {
        "resource_type": "aws_s3_bucket",
        "resource_name": "sra_state_bucket",
        "resource_service": "s3",
        "resource_icon": "aws/Architecture-Service-Icons_07312025/Arch_Storage/48/Arch_Amazon-Simple-Storage-Service_48.svg",
        "bucket": "sra-tfstate-files--",
        "force_destroy": true,
        "tags": {
          "sra-solution": "sra-tfstate-s3"
        }
      },
      "id": "aws_s3_bucket.sra_state_bucket"
    },
    {
      "data": {
        "resource_type": "aws_s3_bucket_server_side_encryption_configuration",
        "resource_name": "sra_state_bucket_see",
        "resource_service": "s3",
        "resource_icon": "aws/Architecture-Service-Icons_07312025/Arch_Storage/48/Arch_Amazon-S3-on-Outposts_48.svg",
        "bucket": "${aws_s3_bucket.sra_state_bucket.id}",
        "rule": [
          {
            "apply_server_side_encryption_by_default": [
              {
                "kms_master_key_id": "${module.sra_secrets_kms.kms_key_arn}",
                "sse_algorithm": "aws:kms"
              }
            ]
          }
        ]
      },
      "id": "aws_s3_bucket_server_side_encryption_configuration.sra_state_bucket_see"
    },
    {
      "data": {
        "resource_type": "aws_s3_bucket_versioning",
        "resource_name": "sra_state_bucket_versioning",
        "resource_service": "s3",
        "resource_icon": "aws/Architecture-Service-Icons_07312025/Arch_Storage/48/Arch_Amazon-S3-on-Outposts_48.svg",
        "bucket": "${aws_s3_bucket.sra_state_bucket.id}",
        "versioning_configuration": [
          {
            "status": "Enabled"
          }
        ]
      },
      "id": "aws_s3_bucket_versioning.sra_state_bucket_versioning"
    },
    {
      "data": {
        "resource_type": "aws_s3_bucket_ownership_controls",
        "resource_name": "sra_state_bucket_ownership_control",
        "resource_service": "s3",
        "resource_icon": "aws/Architecture-Service-Icons_07312025/Arch_Storage/48/Arch_Amazon-S3-on-Outposts_48.svg",
        "bucket": "${aws_s3_bucket.sra_state_bucket.id}",
        "rule": [
          {
            "object_ownership": "BucketOwnerPreferred"
          }
        ]
      },
      "id": "aws_s3_bucket_ownership_controls.sra_state_bucket_ownership_control"
    },
    {
      "data": {
        "resource_type": "aws_s3_bucket_public_access_block",
        "resource_name": "sra_state_bucket_public_access_block",
        "resource_service": "s3",
        "resource_icon": "aws/Architecture-Service-Icons_07312025/Arch_Storage/48/Arch_Amazon-S3-on-Outposts_48.svg",
        "bucket": "${aws_s3_bucket.sra_state_bucket.id}",
        "block_public_acls": true,
        "block_public_policy": true,
        "ignore_public_acls": true,
        "restrict_public_buckets": true
      },
      "id": "aws_s3_bucket_public_access_block.sra_state_bucket_public_access_block"
    },
    {
      "data": {
        "resource_type": "aws_dynamodb_table",
        "resource_name": "terraform_locks",
        "resource_service": "dynamodb",
        "resource_icon": "aws/Architecture-Service-Icons_07312025/Arch_Database/48/Arch_Amazon-DynamoDB_48.svg",
        "name": "sra-tfstate-lock",
        "billing_mode": "PAY_PER_REQUEST",
        "hash_key": "LockID",
        "attribute": [
          {
            "name": "LockID",
            "type": "S"
          }
        ]
      },
      "id": "aws_dynamodb_table.terraform_locks"
    },
    {
      "data": {
        "resource_type": "aws_iam_role",
        "resource_name": "configuration_role",
        "resource_service": "iam",
        "resource_icon": "aws/Architecture-Service-Icons_07312025/Arch_Security-Identity-Compliance/48/Arch_AWS-Identity-and-Access-Management_48.svg",
        "name": "sra-securityhub-configuration",
        "assume_role_policy": null,
        "tags": {
          "sra-solution": "sra-securityhub-org"
        }
      },
      "id": "aws_iam_role.configuration_role"
    },
    {
      "data": {
        "resource_type": "aws_iam_policy",
        "resource_name": "config_policy",
        "resource_service": "iam",
        "resource_icon": "aws/Architecture-Service-Icons_07312025/Arch_Security-Identity-Compliance/48/Arch_AWS-Identity-and-Access-Management_48.svg",
        "name": "sra-securityhub-org-policy-config",
        "policy": null,
        "description": "Policy for Config"
      },
      "id": "aws_iam_policy.config_policy"
    },
    {
      "data": {
        "resource_type": "aws_iam_policy",
        "resource_name": "organizations_policy",
        "resource_service": "iam",
        "resource_icon": "aws/Architecture-Service-Icons_07312025/Arch_Security-Identity-Compliance/48/Arch_AWS-Identity-and-Access-Management_48.svg",
        "name": "sra-inspector-org-organizations-policy",
        "description": "IAM policy for Organizations",
        "policy": null
      },
      "id": "aws_iam_policy.organizations_policy"
    },
    {
      "data": {
        "resource_type": "aws_iam_policy",
        "resource_name": "securityhub_policy",
        "resource_service": "iam",
        "resource_icon": "aws/Architecture-Service-Icons_07312025/Arch_Security-Identity-Compliance/48/Arch_AWS-Identity-and-Access-Management_48.svg",
        "name": "sra-securityhub-org-policy-securityhub",
        "policy": null,
        "description": "Policy for SecurityHub"
      },
      "id": "aws_iam_policy.securityhub_policy"
    },
    {
      "data": {
        "resource_type": "aws_iam_policy",
        "resource_name": "securityhub_delegated_admin_policy",
        "resource_service": "iam",
        "resource_icon": "aws/Architecture-Service-Icons_07312025/Arch_Security-Identity-Compliance/48/Arch_AWS-Identity-and-Access-Management_48.svg",
        "count": 1,
        "name": "sra-securityhub-org-policy-securityhub-delegated-admin",
        "policy": "None[0].json",
        "description": "Policy for SecurityHub Delegated Admin"
      },
      "id": "aws_iam_policy.securityhub_delegated_admin_policy"
    },
    {
      "data": {
        "resource_type": "aws_iam_policy",
        "resource_name": "iam_policy",
        "resource_service": "iam",
        "resource_icon": "aws/Architecture-Service-Icons_07312025/Arch_Security-Identity-Compliance/48/Arch_AWS-Identity-and-Access-Management_48.svg",
        "name": "sra-inspector-org-iam-policy",
        "description": "IAM policy for IAM",
        "policy": null
      },
      "id": "aws_iam_policy.iam_policy"
    },
    {
      "data": {
        "resource_type": "aws_iam_role_policy_attachment",
        "resource_name": "config_attachment",
        "resource_service": "iam",
        "resource_icon": "aws/Architecture-Service-Icons_07312025/Arch_Security-Identity-Compliance/48/Arch_AWS-Identity-and-Access-Management_48.svg",
        "policy_arn": "${aws_iam_policy.config_policy.arn}",
        "role": "${aws_iam_role.configuration_role.name}"
      },
      "id": "aws_iam_role_policy_attachment.config_attachment"
    },
    {
      "data": {
        "resource_type": "aws_iam_role_policy_attachment",
        "resource_name": "organizations_attachment",
        "resource_service": "iam",
        "resource_icon": "aws/Architecture-Service-Icons_07312025/Arch_Security-Identity-Compliance/48/Arch_AWS-Identity-and-Access-Management_48.svg",
        "policy_arn": "${aws_iam_policy.organizations_policy.arn}",
        "role": "${aws_iam_role.inspector_configuration_role.name}"
      },
      "id": "aws_iam_role_policy_attachment.organizations_attachment"
    },
    {
      "data": {
        "resource_type": "aws_iam_role_policy_attachment",
        "resource_name": "securityhub_attachment",
        "resource_service": "iam",
        "resource_icon": "aws/Architecture-Service-Icons_07312025/Arch_Security-Identity-Compliance/48/Arch_AWS-Identity-and-Access-Management_48.svg",
        "policy_arn": "${aws_iam_policy.securityhub_policy.arn}",
        "role": "${aws_iam_role.configuration_role.name}"
      },
      "id": "aws_iam_role_policy_attachment.securityhub_attachment"
    },
    {
      "data": {
        "resource_type": "aws_iam_role_policy_attachment",
        "resource_name": "securityhub_delegated_admin_attachment",
        "resource_service": "iam",
        "resource_icon": "aws/Architecture-Service-Icons_07312025/Arch_Security-Identity-Compliance/48/Arch_AWS-Identity-and-Access-Management_48.svg",
        "count": 1,
        "policy_arn": "${aws_iam_policy.securityhub_delegated_admin_policy[0].arn}",
        "role": "${aws_iam_role.configuration_role.name}"
      },
      "id": "aws_iam_role_policy_attachment.securityhub_delegated_admin_attachment"
    },
    {
      "data": {
        "resource_type": "aws_iam_role_policy_attachment",
        "resource_name": "iam_attachment",
        "resource_service": "iam",
        "resource_icon": "aws/Architecture-Service-Icons_07312025/Arch_Security-Identity-Compliance/48/Arch_AWS-Identity-and-Access-Management_48.svg",
        "policy_arn": "${aws_iam_policy.iam_policy.arn}",
        "role": "${aws_iam_role.inspector_configuration_role.name}"
      },
      "id": "aws_iam_role_policy_attachment.iam_attachment"
    },
    {
      "data": {
        "resource_type": "aws_accessanalyzer_analyzer",
        "resource_name": "account_access_analyzer",
        "resource_service": "accessanalyzer",
        "resource_icon": "aws/Resource-Icons_07312025/Res_Networking-Content-Delivery/Res_Amazon-VPC_Network-Access-Analyzer_48.svg",
        "analyzer_name": "sra-account-access-analyzer-",
        "tags": {
          "sra-solution": "sra-iam-access-analyzer"
        },
        "type": "ACCOUNT"
      },
      "id": "aws_accessanalyzer_analyzer.account_access_analyzer"
    },
    {
      "data": {
        "resource_type": "aws_accessanalyzer_analyzer",
        "resource_name": "rOrganizationAccessAnalyzer",
        "resource_service": "accessanalyzer",
        "resource_icon": "aws/Resource-Icons_07312025/Res_Networking-Content-Delivery/Res_Amazon-VPC_Network-Access-Analyzer_48.svg",
        "analyzer_name": "sra-organization-access-analyzer",
        "tags": {
          "sra-solution": "sra-iam-access-analyzer"
        },
        "type": "ORGANIZATION"
      },
      "id": "aws_accessanalyzer_analyzer.rOrganizationAccessAnalyzer"
    },
    {
      "data": {
        "resource_type": "aws_iam_role",
        "resource_name": "disable_macie_role",
        "resource_service": "iam",
        "resource_icon": "aws/Architecture-Service-Icons_07312025/Arch_Security-Identity-Compliance/48/Arch_AWS-Identity-and-Access-Management_48.svg",
        "name": "sra-macie-org-disable",
        "assume_role_policy": "${jsonencode({\"Version\": \"2012-10-17\", \"Statement\": [{\"Effect\": \"Allow\", \"Principal\": {\"AWS\": \"${format(\"arn::iam::%s:root\", var.management_account_id)}\"}, \"Action\": \"sts:AssumeRole\", \"Condition\": {\"StringEquals\": {\"aws:PrincipalArn\": \"${format(\"arn::iam::%s:role/%s\", var.management_account_id, var.macie_org_lambda_role_name)}\"}}}]})}",
        "tags": {
          "sra-solution": "sra-macie-org"
        }
      },
      "id": "aws_iam_role.disable_macie_role"
    },
    {
      "data": {
        "resource_type": "aws_iam_policy",
        "resource_name": "disable_macie_policy",
        "resource_service": "iam",
        "resource_icon": "aws/Architecture-Service-Icons_07312025/Arch_Security-Identity-Compliance/48/Arch_AWS-Identity-and-Access-Management_48.svg",
        "name": "sra-macie-org-policy-disable",
        "policy": "${jsonencode({\"Version\": \"2012-10-17\", \"Statement\": [{\"Sid\": \"DisableMacie\", \"Effect\": \"Allow\", \"Action\": [\"macie2:DisableMacie\", \"macie2:GetAdministratorAccount\"], \"Resource\": \"*\"}]})}",
        "tags": {
          "sra-solution": "sra-macie-org"
        }
      },
      "id": "aws_iam_policy.disable_macie_policy"
    },
    {
      "data": {
        "resource_type": "aws_iam_policy_attachment",
        "resource_name": "disable_macie_role_attachment",
        "resource_service": "iam",
        "resource_icon": "aws/Architecture-Service-Icons_07312025/Arch_Security-Identity-Compliance/48/Arch_AWS-Identity-and-Access-Management_48.svg",
        "name": "disable_macie_role_attachment",
        "roles": [
          "${aws_iam_role.disable_macie_role.name}"
        ],
        "policy_arn": "${aws_iam_policy.disable_macie_policy.arn}"
      },
      "id": "aws_iam_policy_attachment.disable_macie_role_attachment"
    },
    {
      "data": {
        "resource_type": "aws_iam_role",
        "resource_name": "inspector_configuration_role",
        "resource_service": "iam",
        "resource_icon": "aws/Architecture-Service-Icons_07312025/Arch_Security-Identity-Compliance/48/Arch_AWS-Identity-and-Access-Management_48.svg",
        "name": "sra-inspector-configuration",
        "assume_role_policy": null,
        "tags": {
          "sra-solution": "sra-inspector-org"
        }
      },
      "id": "aws_iam_role.inspector_configuration_role"
    },
    {
      "data": {
        "resource_type": "aws_iam_policy",
        "resource_name": "inspector_policy",
        "resource_service": "iam",
        "resource_icon": "aws/Architecture-Service-Icons_07312025/Arch_Security-Identity-Compliance/48/Arch_AWS-Identity-and-Access-Management_48.svg",
        "name": "sra-inspector-org-inspector-policy",
        "description": "IAM policy for Inspector",
        "policy": null
      },
      "id": "aws_iam_policy.inspector_policy"
    },
    {
      "data": {
        "resource_type": "aws_iam_role_policy_attachment",
        "resource_name": "inspector_attachment",
        "resource_service": "iam",
        "resource_icon": "aws/Architecture-Service-Icons_07312025/Arch_Security-Identity-Compliance/48/Arch_AWS-Identity-and-Access-Management_48.svg",
        "policy_arn": "${aws_iam_policy.inspector_policy.arn}",
        "role": "${aws_iam_role.inspector_configuration_role.name}"
      },
      "id": "aws_iam_role_policy_attachment.inspector_attachment"
    },
    {
      "data": {
        "resource_type": "aws_iam_role",
        "resource_name": "iam_password_policy_lambda_role",
        "resource_service": "iam",
        "resource_icon": "aws/Architecture-Service-Icons_07312025/Arch_Security-Identity-Compliance/48/Arch_AWS-Identity-and-Access-Management_48.svg",
        "name": "sra-iam-password-policy-lambda",
        "assume_role_policy": null,
        "tags": {
          "sra-solution": "sra-iam-password-policy"
        }
      },
      "id": "aws_iam_role.iam_password_policy_lambda_role"
    },
    {
      "data": {
        "resource_type": "aws_iam_policy",
        "resource_name": "lambda_policy",
        "resource_service": "iam",
        "resource_icon": "aws/Architecture-Service-Icons_07312025/Arch_Security-Identity-Compliance/48/Arch_AWS-Identity-and-Access-Management_48.svg",
        "name": "sra-iam-password-policy",
        "description": "Policy for the IAM Password Policy Lambda function",
        "policy": null
      },
      "id": "aws_iam_policy.lambda_policy"
    },
    {
      "data": {
        "resource_type": "aws_iam_role_policy_attachment",
        "resource_name": "lambda_policy_attachment",
        "resource_service": "iam",
        "resource_icon": "aws/Architecture-Service-Icons_07312025/Arch_Security-Identity-Compliance/48/Arch_AWS-Identity-and-Access-Management_48.svg",
        "policy_arn": "${aws_iam_policy.lambda_policy.arn}",
        "role": "${aws_iam_role.iam_password_policy_lambda_role.name}"
      },
      "id": "aws_iam_role_policy_attachment.lambda_policy_attachment"
    },
    {
      "data": {
        "resource_type": "aws_cloudwatch_log_group",
        "resource_name": "lambda_log_group",
        "resource_service": "cloudwatch",
        "resource_icon": "aws/Architecture-Service-Icons_07312025/Arch_Management-Governance/48/Arch_Amazon-CloudWatch_48.svg",
        "count": 1,
        "name": "/aws/lambda/sra-iam-password-policy",
        "retention_in_days": 14,
        "kms_key_id": ""
      },
      "id": "aws_cloudwatch_log_group.lambda_log_group"
    },
    {
      "data": {
        "resource_type": "aws_lambda_function",
        "resource_name": "iam_password_policy_lambda_function",
        "resource_service": "lambda",
        "resource_icon": "aws/Architecture-Service-Icons_07312025/Arch_Compute/48/Arch_AWS-Lambda_48.svg",
        "function_name": "sra-iam-password-policy",
        "description": "SRA Update IAM password policy",
        "role": "${aws_iam_role.iam_password_policy_lambda_role.arn}",
        "handler": "app.lambda_handler",
        "memory_size": 512,
        "runtime": "python3.9",
        "timeout": 900,
        "source_code_hash": null,
        "filename": null,
        "architectures": [
          "arm64"
        ],
        "environment": [
          {
            "variables": {
              "LOG_LEVEL": "INFO"
            }
          }
        ],
        "tags": {
          "sra-solution": "sra-iam-password-policy"
        }
      },
      "id": "aws_lambda_function.iam_password_policy_lambda_function"
    }
  ],
  "edges": [
    {
      "id": "aws_cloudformation_stack_set_instance.sra_execution_role_stackset_instance-aws_cloudformation_stack_set.sra_execution_role_stackset-['stack_set_name']",
      "data": {
        "json_path": "stack_set_name",
        "raw_value": "${aws_cloudformation_stack_set.sra_execution_role_stackset.name}"
      },
      "source": "aws_cloudformation_stack_set_instance.sra_execution_role_stackset_instance",
      "target": "aws_cloudformation_stack_set.sra_execution_role_stackset"
    },
    {
      "id": "aws_lambda_function.management_account_parameters-aws_iam_role.management_account_parameters_lambda_role-['role']",
      "data": {
        "json_path": "role",
        "raw_value": "${aws_iam_role.management_account_parameters_lambda_role.arn}"
      },
      "source": "aws_lambda_function.management_account_parameters",
      "target": "aws_iam_role.management_account_parameters_lambda_role"
    },
    {
      "id": "aws_cloudwatch_log_group.management_account_parameters-aws_lambda_function.management_account_parameters-['name']",
      "data": {
        "json_path": "name",
        "raw_value": "/aws/lambda/${aws_lambda_function.management_account_parameters.function_name}"
      },
      "source": "aws_cloudwatch_log_group.management_account_parameters",
      "target": "aws_lambda_function.management_account_parameters"
    },
    {
      "id": "aws_iam_role_policy.cloudwatch_policy_attachment-aws_iam_role.management_account_parameters_lambda_role-['role']",
      "data": {
        "json_path": "role",
        "raw_value": "${aws_iam_role.management_account_parameters_lambda_role.id}"
      },
      "source": "aws_iam_role_policy.cloudwatch_policy_attachment",
      "target": "aws_iam_role.management_account_parameters_lambda_role"
    },
    {
      "id": "aws_iam_role_policy.management_account_parameters_lambda_ssm_policy_attachment-aws_iam_role.management_account_parameters_lambda_role-['role']",
      "data": {
        "json_path": "role",
        "raw_value": "${aws_iam_role.management_account_parameters_lambda_role.id}"
      },
      "source": "aws_iam_role_policy.management_account_parameters_lambda_ssm_policy_attachment",
      "target": "aws_iam_role.management_account_parameters_lambda_role"
    },
    {
      "id": "aws_lambda_invocation.lambda_invoke-aws_lambda_function.iam_password_policy_lambda_function-['input']",
      "data": {
        "json_path": "input",
        "raw_value": "${jsonencode({\"RequestType\": \"Create\", \"ResourceType\": \"Terraform\", \"ResourceProperties\": {\"ServiceToken\": \"${aws_lambda_function.iam_password_policy_lambda_function.arn}\", \"HARD_EXPIRY\": \"unknown\", \"MAX_PASSWORD_AGE\": \"unknown\", \"PASSWORD_REUSE_PREVENTION\": \"unknown\", \"MINIMUM_PASSWORD_LENGTH\": \"unknown\", \"REQUIRE_LOWERCASE_CHARACTERS\": \"unknown\", \"REQUIRE_NUMBERS\": \"unknown\", \"REQUIRE_SYMBOLS\": \"unknown\", \"REQUIRE_UPPERCASE_CHARACTERS\": \"unknown\", \"ALLOW_USERS_TO_CHANGE_PASSWORD\": \"unknown\"}})}"
      },
      "source": "aws_lambda_invocation.lambda_invoke",
      "target": "aws_lambda_function.iam_password_policy_lambda_function"
    },
    {
      "id": "aws_iam_role_policy_attachment.sra_execution_role_admin_policy-aws_iam_role.sra_execution_role-['role']",
      "data": {
        "json_path": "role",
        "raw_value": "${aws_iam_role.sra_execution_role.name}"
      },
      "source": "aws_iam_role_policy_attachment.sra_execution_role_admin_policy",
      "target": "aws_iam_role.sra_execution_role"
    },
    {
      "id": "aws_kms_alias.sra_secrets_key_alias-aws_kms_key.sra_secrets_key-['target_key_id']",
      "data": {
        "json_path": "target_key_id",
        "raw_value": "${aws_kms_key.sra_secrets_key.key_id}"
      },
      "source": "aws_kms_alias.sra_secrets_key_alias",
      "target": "aws_kms_key.sra_secrets_key"
    },
    {
      "id": "aws_s3_bucket_server_side_encryption_configuration.sra_state_bucket_see-aws_s3_bucket.sra_state_bucket-['bucket']",
      "data": {
        "json_path": "bucket",
        "raw_value": "${aws_s3_bucket.sra_state_bucket.id}"
      },
      "source": "aws_s3_bucket_server_side_encryption_configuration.sra_state_bucket_see",
      "target": "aws_s3_bucket.sra_state_bucket"
    },
    {
      "id": "aws_s3_bucket_versioning.sra_state_bucket_versioning-aws_s3_bucket.sra_state_bucket-['bucket']",
      "data": {
        "json_path": "bucket",
        "raw_value": "${aws_s3_bucket.sra_state_bucket.id}"
      },
      "source": "aws_s3_bucket_versioning.sra_state_bucket_versioning",
      "target": "aws_s3_bucket.sra_state_bucket"
    },
    {
      "id": "aws_s3_bucket_ownership_controls.sra_state_bucket_ownership_control-aws_s3_bucket.sra_state_bucket-['bucket']",
      "data": {
        "json_path": "bucket",
        "raw_value": "${aws_s3_bucket.sra_state_bucket.id}"
      },
      "source": "aws_s3_bucket_ownership_controls.sra_state_bucket_ownership_control",
      "target": "aws_s3_bucket.sra_state_bucket"
    },
    {
      "id": "aws_s3_bucket_public_access_block.sra_state_bucket_public_access_block-aws_s3_bucket.sra_state_bucket-['bucket']",
      "data": {
        "json_path": "bucket",
        "raw_value": "${aws_s3_bucket.sra_state_bucket.id}"
      },
      "source": "aws_s3_bucket_public_access_block.sra_state_bucket_public_access_block",
      "target": "aws_s3_bucket.sra_state_bucket"
    },
    {
      "id": "aws_iam_role_policy_attachment.config_attachment-aws_iam_policy.config_policy-['policy_arn']",
      "data": {
        "json_path": "policy_arn",
        "raw_value": "${aws_iam_policy.config_policy.arn}"
      },
      "source": "aws_iam_role_policy_attachment.config_attachment",
      "target": "aws_iam_policy.config_policy"
    },
    {
      "id": "aws_iam_role_policy_attachment.config_attachment-aws_iam_role.configuration_role-['role']",
      "data": {
        "json_path": "role",
        "raw_value": "${aws_iam_role.configuration_role.name}"
      },
      "source": "aws_iam_role_policy_attachment.config_attachment",
      "target": "aws_iam_role.configuration_role"
    },
    {
      "id": "aws_iam_role_policy_attachment.organizations_attachment-aws_iam_policy.organizations_policy-['policy_arn']",
      "data": {
        "json_path": "policy_arn",
        "raw_value": "${aws_iam_policy.organizations_policy.arn}"
      },
      "source": "aws_iam_role_policy_attachment.organizations_attachment",
      "target": "aws_iam_policy.organizations_policy"
    },
    {
      "id": "aws_iam_role_policy_attachment.organizations_attachment-aws_iam_role.inspector_configuration_role-['role']",
      "data": {
        "json_path": "role",
        "raw_value": "${aws_iam_role.inspector_configuration_role.name}"
      },
      "source": "aws_iam_role_policy_attachment.organizations_attachment",
      "target": "aws_iam_role.inspector_configuration_role"
    },
    {
      "id": "aws_iam_role_policy_attachment.securityhub_attachment-aws_iam_policy.securityhub_policy-['policy_arn']",
      "data": {
        "json_path": "policy_arn",
        "raw_value": "${aws_iam_policy.securityhub_policy.arn}"
      },
      "source": "aws_iam_role_policy_attachment.securityhub_attachment",
      "target": "aws_iam_policy.securityhub_policy"
    },
    {
      "id": "aws_iam_role_policy_attachment.securityhub_attachment-aws_iam_role.configuration_role-['role']",
      "data": {
        "json_path": "role",
        "raw_value": "${aws_iam_role.configuration_role.name}"
      },
      "source": "aws_iam_role_policy_attachment.securityhub_attachment",
      "target": "aws_iam_role.configuration_role"
    },
    {
      "id": "aws_iam_role_policy_attachment.securityhub_delegated_admin_attachment-aws_iam_policy.securityhub_delegated_admin_policy-['policy_arn']",
      "data": {
        "json_path": "policy_arn",
        "raw_value": "${aws_iam_policy.securityhub_delegated_admin_policy[0].arn}"
      },
      "source": "aws_iam_role_policy_attachment.securityhub_delegated_admin_attachment",
      "target": "aws_iam_policy.securityhub_delegated_admin_policy"
    },
    {
      "id": "aws_iam_role_policy_attachment.securityhub_delegated_admin_attachment-aws_iam_role.configuration_role-['role']",
      "data": {
        "json_path": "role",
        "raw_value": "${aws_iam_role.configuration_role.name}"
      },
      "source": "aws_iam_role_policy_attachment.securityhub_delegated_admin_attachment",
      "target": "aws_iam_role.configuration_role"
    },
    {
      "id": "aws_iam_role_policy_attachment.iam_attachment-aws_iam_policy.iam_policy-['policy_arn']",
      "data": {
        "json_path": "policy_arn",
        "raw_value": "${aws_iam_policy.iam_policy.arn}"
      },
      "source": "aws_iam_role_policy_attachment.iam_attachment",
      "target": "aws_iam_policy.iam_policy"
    },
    {
      "id": "aws_iam_role_policy_attachment.iam_attachment-aws_iam_role.inspector_configuration_role-['role']",
      "data": {
        "json_path": "role",
        "raw_value": "${aws_iam_role.inspector_configuration_role.name}"
      },
      "source": "aws_iam_role_policy_attachment.iam_attachment",
      "target": "aws_iam_role.inspector_configuration_role"
    },
    {
      "id": "aws_iam_policy_attachment.disable_macie_role_attachment-aws_iam_role.disable_macie_role-['roles', '0']",
      "data": {
        "json_path": "roles.0",
        "raw_value": "${aws_iam_role.disable_macie_role.name}"
      },
      "source": "aws_iam_policy_attachment.disable_macie_role_attachment",
      "target": "aws_iam_role.disable_macie_role"
    },
    {
      "id": "aws_iam_policy_attachment.disable_macie_role_attachment-aws_iam_policy.disable_macie_policy-['policy_arn']",
      "data": {
        "json_path": "policy_arn",
        "raw_value": "${aws_iam_policy.disable_macie_policy.arn}"
      },
      "source": "aws_iam_policy_attachment.disable_macie_role_attachment",
      "target": "aws_iam_policy.disable_macie_policy"
    },
    {
      "id": "aws_iam_role_policy_attachment.inspector_attachment-aws_iam_policy.inspector_policy-['policy_arn']",
      "data": {
        "json_path": "policy_arn",
        "raw_value": "${aws_iam_policy.inspector_policy.arn}"
      },
      "source": "aws_iam_role_policy_attachment.inspector_attachment",
      "target": "aws_iam_policy.inspector_policy"
    },
    {
      "id": "aws_iam_role_policy_attachment.inspector_attachment-aws_iam_role.inspector_configuration_role-['role']",
      "data": {
        "json_path": "role",
        "raw_value": "${aws_iam_role.inspector_configuration_role.name}"
      },
      "source": "aws_iam_role_policy_attachment.inspector_attachment",
      "target": "aws_iam_role.inspector_configuration_role"
    },
    {
      "id": "aws_iam_role_policy_attachment.lambda_policy_attachment-aws_iam_policy.lambda_policy-['policy_arn']",
      "data": {
        "json_path": "policy_arn",
        "raw_value": "${aws_iam_policy.lambda_policy.arn}"
      },
      "source": "aws_iam_role_policy_attachment.lambda_policy_attachment",
      "target": "aws_iam_policy.lambda_policy"
    },
    {
      "id": "aws_iam_role_policy_attachment.lambda_policy_attachment-aws_iam_role.iam_password_policy_lambda_role-['role']",
      "data": {
        "json_path": "role",
        "raw_value": "${aws_iam_role.iam_password_policy_lambda_role.name}"
      },
      "source": "aws_iam_role_policy_attachment.lambda_policy_attachment",
      "target": "aws_iam_role.iam_password_policy_lambda_role"
    },
    {
      "id": "aws_lambda_function.iam_password_policy_lambda_function-aws_iam_role.iam_password_policy_lambda_role-['role']",
      "data": {
        "json_path": "role",
        "raw_value": "${aws_iam_role.iam_password_policy_lambda_role.arn}"
      },
      "source": "aws_lambda_function.iam_password_policy_lambda_function",
      "target": "aws_iam_role.iam_password_policy_lambda_role"
    }
  ]
}